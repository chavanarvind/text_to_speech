# Print sample input columns
print("📊 Input sample columns:", df_all.columns.tolist())

# Print sample of prediction output
print("📌 Sample output rows with prediction:")
print(df_out[['CMPNT_MATL_NUM', 'Final_Prediction', 'Score', 'prediction_flag']].head())

# Save small sample CSV for logging
os.makedirs("logs", exist_ok=True)
sample_csv_path = os.path.join("logs", f"sample_predicted_{f.replace('.parquet', '.csv')}")
df_out[['CMPNT_MATL_NUM', 'Final_Prediction', 'Score', 'prediction_flag']].head(20).to_csv(sample_csv_path, index=False)
print(f"📝 Sample prediction CSV saved at: {sample_csv_path}")
