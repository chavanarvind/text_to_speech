invalid_subcat_mask = (
    df['AI_FINAL_SUBCATEGORY'].isna() |
    df['AI_FINAL_SUBCATEGORY'].astype(str).str.strip().isin(["", "nan", "NaN"])
)


invalid_cat_mask = (
    df['AI_FINAL_CATEGORY'].isna() |
    df['AI_FINAL_CATEGORY'].astype(str).str.strip().isin(["", "nan", "NaN"])
)
