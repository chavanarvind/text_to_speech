from azureml.core import Workspace, Dataset
import os
import shutil

# Workspace config
SUBSCRIPTION_ID = "a8d518a9-4587-4ba2-9a60-68b980c2f000"
RESOURCE_GROUP = "AZR-WDZ-DTO-AML-Development"
WORKSPACE_NAME = "AML-DTO-Marmot-dev"

# Load workspace
ws = Workspace(subscription_id=SUBSCRIPTION_ID,
               resource_group=RESOURCE_GROUP,
               workspace_name=WORKSPACE_NAME)

# Get dataset
raw_pred_dataset = Dataset.get_by_name(ws, "raw_predictions")

# Define download location
download_path = "./data/pred"
if os.path.exists(download_path):
    shutil.rmtree(download_path)  # Clean up if needed
os.makedirs(download_path, exist_ok=True)

# Download all files
raw_pred_dataset.download(target_path=download_path, overwrite=True)

print(f"âœ… Raw predictions downloaded to: {download_path}")
