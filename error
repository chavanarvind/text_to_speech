from azureml.core import Datastore

# ❌ Remove this
# default_ds = ws.get_default_datastore()

# ✅ Use your actual ADLS datastore name
default_ds = Datastore.get(ws, "xbomrefadlsg2")

from azureml.data import OutputFileDatasetConfig
from datetime import datetime

today = datetime.today().strftime("%d%m%Y")

final_output_to_adls = OutputFileDatasetConfig(
    name='final_predictions_to_adls',
    destination=(default_ds, f"hbom_category_prediction/hbom_category_prediction_{today}/")
)



Also ensure in step_5_run_inference.py you are writing like:

mapped_keys_dir = args.final_output_dir
os.makedirs(mapped_keys_dir, exist_ok=True)
merged_df.to_parquet(os.path.join(mapped_keys_dir, key_file), index=False)
