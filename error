erp, tru, erp_discarded, tru_discarded, run_params, tru_no_erp, tru_off_specs_no_common, bundles = ingest_data_and_prepare_examples(
    input_dir,
    erp_im_dataset_name,
    erp_em_dataset_name,
    tru_dataset_name,
    trade_names_dataset_name,
    run_params,
    output_dir
)

# âœ… Load known rejections here (available for both main and off-spec matching)
fortrea_folder = os.path.dirname(os.path.realpath(__file__))
fortrea_folder = os.path.abspath(os.path.join(fortrea_folder, os.pardir))
known_rejections_df = pd.read_csv(f'{fortrea_folder}/reference_tables/rejections_fortrea.csv')
add_key_prediction(known_rejections_df)
known_rejections = list(known_rejections_df['key_prediction'].unique())
