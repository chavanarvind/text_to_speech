mask_process = (
    (df.get('needs_category_model', False) | df.get('needs_subcategory_model', False)) &
    (df['CMPNT_MATL_DESC'].notna()) &
    (df['CMPNT_MATL_DESC'].astype(str).str.strip().ne(''))
)
