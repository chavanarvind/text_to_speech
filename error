# Save separate samples for mapped and predicted
sample_dir = os.path.join("outputs", "samples_by_source")
os.makedirs(sample_dir, exist_ok=True)

# Mapped rows
mapped_rows = final_df[final_df['prediction_flag'].str.contains("Mapped")]
mapped_rows.head(100).to_csv(os.path.join(sample_dir, "sample_mapped_rows.csv"), index=False)

# Predicted rows (inferred by model)
predicted_rows = final_df[final_df['prediction_flag'].isin(["High Confidence", "Low Confidence"])]
predicted_rows.head(100).to_csv(os.path.join(sample_dir, "sample_predicted_rows.csv"), index=False)
