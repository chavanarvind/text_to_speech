import json
from azureml.core import Workspace
from azureml.core.authentication import ServicePrincipalAuthentication

def get_workspace_from_config(env='dev'):
    if env == 'prod':
        config_file = 'prod_config.json'
    else:
        config_file = 'dev_config.json'

    config_path = f'../.azureml/{config_file}'

    with open(config_path) as f:
        config_json = json.load(f)

    ws = Workspace(
        subscription_id=config_json['subscription_id'],
        resource_group=config_json['resource_group'],
        workspace_name=config_json['workspace_name']
    )
    return ws

from azureml.core import Model

# Load workspace
ws = get_workspace_from_config(env='dev')  # or 'prod'

# Register model
Model.register(
    workspace=ws,
    model_path='./model_folder/model.pkl',
    model_name='my_logistic_model',
    tags={'project': 'your_project'},
    description='Logistic regression model for classification'
)

# Register vectorizer
Model.register(
    workspace=ws,
    model_path='./vectorizer_folder/vectorizer.pickle',
    model_name='my_vectorizer',
    tags={'project': 'your_project'},
    description='TF-IDF vectorizer for text preprocessing'
)
