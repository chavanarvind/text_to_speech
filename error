from azureml.core import Workspace, Datastore
import os
from datetime import datetime

# === Configs ===
SUBSCRIPTION_ID = "a8d518a9-4587-4ba2-9a60-68b980c2f000"
RESOURCE_GROUP = "AZR-WDZ-DTO-AML-Development"
WORKSPACE_NAME = "AML-DTO-Marmot-dev"
DATASTORE_NAME = "xbomrefadlsg2"

# === Paths ===
local_folder = "./data/final_merged_predictions_updated"
blob_output_path = f"hbom_category_prediction/hbom_category_prediction_{datetime.today().strftime('%d%m%Y')}_updated/"

# === Get workspace and datastore ===
ws = Workspace(subscription_id=SUBSCRIPTION_ID,
               resource_group=RESOURCE_GROUP,
               workspace_name=WORKSPACE_NAME)

datastore = Datastore.get(ws, DATASTORE_NAME)

# === Upload with upload() method (for Gen2) ===
datastore.upload(
    src_dir=local_folder,
    target_path=blob_output_path,
    overwrite=True,
    show_progress=True
)

print(f"âœ… Uploaded all files to: {blob_output_path}")
