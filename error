matched, unmatched = full_matching_routine(
    data_version, db_style, device,
    embeddings_save_dir, erp, model_type,
    sentence_transformer_dir, tru,
    use_azure_dataset, bundles, output_dir
)

#  Adjust Off Spec Matches that are in Rejection List
matched = handle_off_spec_rejections(
    matched,
    rejection_df,
    debug_cmpnt_num="665880",
    debug_child_nm="PC-0000249"  # Add debug tracing for this record
)

# Continue with unmatched tagging
unmatched['Matching Reason'] = 'Not match in any round'
