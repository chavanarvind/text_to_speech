import spacy
nlp = spacy.load("en_core_web_sm")


def get_rule_hint(text):
    if pd.isna(text):
        return None

    doc = nlp(text)
    lemmas = set(token.lemma_ for token in doc)

    # Final priority: API > Liquids and Creams > PKG > CHM
    if lemmas & {'api', 'active'}:
        return 'API'
    elif lemmas & {'cream', 'gel', 'emulsion', 'ointment'}:
        return 'Liquids and Creams'
    elif lemmas & {'bottle', 'cap', 'carton', 'label', 'cotton'}:
        return 'PKG'
    elif lemmas & {'excipient', 'binder', 'bind', 'filler', 'fill', 'lubricant', 'lubricate'}:
        return 'CHM'
    return None
