1️⃣ Data Preparation & Feature Engineering
Read all non-null, cleaned .parquet files.

Created derived features:

CMPNT_MATL_DESC_LEN (text length)

UNIT_GROUP, CMPNT_MATL_TYPE_CATEGORY

Replaced ambiguous class FNW or CHM with FNW_CHM

Mapped each record to a Coarse Category:

CHM, Liquids and Creams → CHM_GROUP

FNW, FNW_CHM → FNW_GROUP

API → RARE

PKG → PKG

2️⃣ Feature Transformation
Text: TF-IDF vectorization (1–2 grams, 8192 features)

Numeric: Standardized text length

Categorical: Ordinal encoding for unit type & material type

3️⃣ Stage 1 – Coarse Classifier
Trained an SGDClassifier on Coarse Category

Early stopping based on validation log loss

Used class weighting to handle imbalance

4️⃣ Stage 2 – Fine-Grained Classifiers
For each coarse group (e.g., CHM_GROUP), trained a dedicated SGDClassifier on original labels (Final Category)

Used same preprocessing pipeline

Saved best model for each subgroup

5️⃣ Inference Flow
Predict Coarse Category using Stage 1 model

Route to corresponding fine model (if needed)

Predict final label (Final Category)

Key Observations from Final Classification Report
Category	Precision	Recall	F1-score	Support	Observation
API	1.000	0.007	0.013	14,071	❌ Severe overfitting, almost no recall
CHM	0.712	0.888	0.790	181,377	✅ Strong, consistent performance
FNW	0.989	0.060	0.113	175,177	⚠️ Very high precision, very low recall
FNW_CHM	0.000	0.000	0.000	8,772	❌ Completely unrecognized
Liquids and Creams	0.878	0.137	0.237	2,572	⚠️ Decent precision, poor recall
PKG	0.555	0.991	0.711	183,949	✅ Excellent recall, moderate precision
