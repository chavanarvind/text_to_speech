df['category_matching_reason'] = df.apply(
    lambda row: row['AI_MATCHING_REASON_FINAL_CATEGORY'] if pd.notna(row['AI_MATCHING_REASON_FINAL_CATEGORY']) else (
        'direct_mapping' if row['Mapped_File_Category Filled'] else 'unmapped'
    ), axis=1
)

df['category_matching_reason'] = df['AI_MATCHING_REASON_FINAL_CATEGORY'].where(
    df['AI_MATCHING_REASON_FINAL_CATEGORY'].notna(),
    df['Mapped_File_Category Filled'].map({True: 'direct_mapping', False: 'unmapped'})
)
