# --- Input path and max workers ---
input_path = './data/target_map_parquet_files'
max_workers = 4  # ðŸ”§ Set your desired number of threads here

all_files = glob.glob(os.path.join(input_path, '*.parquet'))

with ThreadPoolExecutor(max_workers=max_workers) as executor:
    for file in all_files:
        executor.submit(text_clean_step, file)
