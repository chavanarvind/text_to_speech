print("📌 Mapped counts:")
print(f"  🔹 Stage 1 (by category only): {len(stage1_df)}")
print(f"  🔹 Stage 2 (by material type only): {len(stage2_df)}")
print(f"  🔹 Total mapped rows combined: {len(mapped_df)}")

# Show a few rows for confirmation
if len(mapped_df) > 0:
    print("✅ Sample of mapped rows:")
    print(mapped_df[['CMPNT_MATL_NUM', 'Final Category', 'Final Subcategory', 'matching_reason']].head())
else:
    print("❗No mapping found for file:", os.path.basename(file_path))
