# Diagnostic: Check if any tracked ERP_PART_IDs are about to be dropped due to missing values
print("Pre-Filter Diagnostic â€” ERP IM")

print("Rows where ERP_PART_ID is in cmp_check_list:")
print(erp_im[erp_im[ERP_PART_ID].isin(cmp_check_list)])

print("\nRows where ERP_PART_ID is in cmp_check_list AND ERP_PART_DESC is missing:")
print(erp_im[erp_im[ERP_PART_ID].isin(cmp_check_list) & erp_im[ERP_PART_DESC].isna()])

print("\nRows where ERP_PART_ID is missing (NaN):")
print(erp_im[erp_im[ERP_PART_ID].isna()])

# Optional: Data types
print("\nERP_PART_ID dtype:", erp_im[ERP_PART_ID].dtype)
print("Unique values (first few):", erp_im[ERP_PART_ID].dropna().unique()[:5])
