def load_data(parquet_dir, mapping_csv_dir):
    # List all .parquet files in the input directory
    parquet_files = [f for f in os.listdir(parquet_dir) if f.endswith(".parquet")]
    if not parquet_files:
        raise FileNotFoundError(f"No parquet files found in: {parquet_dir}")

    # Process only the first parquet file
    first_file = os.path.join(parquet_dir, parquet_files[0])
    print(f"[INFO] Processing only: {first_file}")

    df = pd.read_parquet(first_file, columns=[
        "CMPNT_MATL_NUM", "CMPNT_MATL_DESC", "CMPNT_MATL_TYPE_CD",
        "CMPNT_CAT_CD_DESC", "CMPNT_UOM_CD"
    ])
    df = df[df['CMPNT_MATL_DESC'].notna()]
    df = df.drop_duplicates(subset=["CMPNT_MATL_NUM"])

    # Load the first CSV file from mapping folder
    csv_files = [f for f in os.listdir(mapping_csv_dir) if f.endswith(".csv")]
    if not csv_files:
        raise FileNotFoundError(f"No CSV found in mapping dir: {mapping_csv_dir}")
    
    csv_path = os.path.join(mapping_csv_dir, csv_files[0])
    print(f"[INFO] Using mapping CSV: {csv_path}")
    mapping_df = pd.read_csv(csv_path)

    return df, mapping_df
