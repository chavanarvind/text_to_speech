import polars as pl
import glob
import os

input_path = './data/target_map_parquet_files'
output_path = './data/csv_outputs'
os.makedirs(output_path, exist_ok=True)

files = glob.glob(os.path.join(input_path, '*.parquet'))

for f in files[:5]:
    df = pl.read_parquet(f)
    print(f"{os.path.basename(f)} âž¤ Columns: {df.columns}")

    # Save as CSV (comma-separated)
    csv_filename = os.path.splitext(os.path.basename(f))[0] + '.csv'
    df.write_csv(os.path.join(output_path, csv_filename))
