from azureml.core import Workspace, Datastore, Dataset
from azureml.data.datapath import DataPath

# Use hardcoded workspace config (same as your pipeline)
ws = Workspace(
    subscription_id="a8d518a9-4587-4ba2-9a60-68b980c2f000",
    resource_group="AZR-WDZ-DTO-AML-Development",
    workspace_name="AML-DTO-Marmot-dev"
)

ds = Datastore.get(ws, "xbomrefadlsg2")

dataset = Dataset.File.from_files(DataPath(ds, "bom-xref/hbom_category_prediction_inference_per_file/hbom_category_prediction_14062025/*.parquet"))

print(dataset.to_path())
