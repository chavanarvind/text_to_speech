input_path = './data/target_map_parquet_files'
files = glob.glob(os.path.join(input_path, '*.parquet'))

# Use all available cores or limit manually (e.g., processes=4)
with Pool(processes=cpu_count()) as pool:
    pool.map(process_one_file, files)
