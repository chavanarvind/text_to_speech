df_sampled = (
    df.groupby('Final Category', group_keys=False)
    .apply(lambda g: g.sample(
        frac=category_frac_map.get(g.name, 0.1),
        random_state=42
    ), include_groups=False)
    .reset_index(drop=True)
)
