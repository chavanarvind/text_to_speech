# ðŸš¨ Validate mapped-only rows have Final Category
missing_final_cat = (
    mapped_only_df['Final Category'].isna() |
    mapped_only_df['Final Category'].astype(str).str.strip().eq("")
)

if missing_final_cat.any():
    raise ValueError(f"[ERROR] {missing_final_cat.sum()} rows are marked as needs_model=False but missing Final Category.")
