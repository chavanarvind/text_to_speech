def upload_to_blob_storage(local_path):
    parsed_url = urlparse(SAS_CONTAINER_URL)
    account_url = f"{parsed_url.scheme}://{parsed_url.netloc}"
    container_name = parsed_url.path.strip("/")
    sas_token = parsed_url.query

    # Avoid slashes in blob name â€” use flat filename
    blob_filename = f"video-uploads_{sanitize_filename(os.path.basename(local_path))}"
    blob_url_path = f"{account_url}/{container_name}/{blob_filename}"

    # Upload blob
    blob_service_client = BlobServiceClient(account_url=account_url, credential=sas_token)
    container_client = blob_service_client.get_container_client(container_name)

    with open(local_path, "rb") as data:
        try:
            container_client.upload_blob(name=blob_filename, data=data, overwrite=True)
        except Exception as e:
            print(f"[ERROR] Upload failed: {e}")
            raise

    # Return full blob URL with SAS
    blob_url = f"{blob_url_path}?{sas_token}"
    return blob_url
