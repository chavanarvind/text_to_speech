inference_output_dir = DataPath(ds, "hbom_category_prediction/hbom_category_prediction_{}/".format(today))
key_output_dir = DataPath(ds, "step1a_key_output_temp/")
bom-xref/hbom_category_prediction_inference_per_file/hbom_category_prediction_14062025/
from azureml.core import Dataset

inference_dataset = Dataset.File.from_files(DataPath(ds, f"hbom_category_prediction/hbom_category_prediction_{today}/"))
key_dataset = Dataset.File.from_files(DataPath(ds, "step1a_key_output_temp/"))

inference_input = inference_dataset.as_named_input('inference_output_dir').as_mount()
key_input = key_dataset.as_named_input('key_output_dir').as_mount()

finalize_step = PythonScriptStep(
    name="Step 6 - Finalize Output Per File",
    script_name="step_6_finalize_output_optimized.py",
    source_directory="scripts",
    inputs=[inference_input, key_input],
    arguments=[
        "--inference_output_dir", inference_input,
        "--key_output_dir", key_input,
        "--final_output_dir", final_output_dir
    ],
    outputs=[final_output_dir],
    runconfig=run_config,
    compute_target=compute_name,
    allow_reuse=False
)
