def ensure_ai_columns(df):
    ai_columns = {
        'AI_FINAL_CATEGORY': "string",
        'AI_FINAL_CATEGORY_CONFIDENCE': "Float64",
        'AI_MATCHING_REASON_FINAL_CATEGORY': "string",
        'AI_FINAL_SUBCATEGORY': "string",
        'AI_FINAL_SUBCATEGORY_CONFIDENCE': "Float64",
        'AI_MATCHING_REASON_FINAL_SUBCATEGORY': "string"
    }

    for col, dtype in ai_columns.items():
        if col not in df.columns:
            # Create new column with pd.NA and correct dtype
            df[col] = pd.Series([pd.NA] * len(df), dtype=dtype)
        else:
            # Coerce existing column to correct dtype and clean placeholder values
            df[col] = df[col].astype(dtype).replace(
                ["None", "none", "nan", "NaN", ""], pd.NA
            )

    return df
