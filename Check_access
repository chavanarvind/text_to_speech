import os
import requests

# Path to your virtual environment's pyzbar folder
env_pyzbar_path = r"C:\Users\AChava05\OneDrive - Kenvue\AChava05\video_analysis\qr_env\Lib\site-packages\pyzbar"
os.makedirs(env_pyzbar_path, exist_ok=True)

# Correct download URLs (from NaturalHistoryMuseum/barcode-reader-dlls release tag 0.1)
dll_links = {
    "libzbar-64.dll": "https://github.com/NaturalHistoryMuseum/barcode-reader-dlls/releases/download/0.1/libzbar-64.dll",
    "libiconv.dll": "https://github.com/NaturalHistoryMuseum/barcode-reader-dlls/releases/download/0.1/libiconv.dll"
}

for name, url in dll_links.items():
    print(f"‚¨áÔ∏è Downloading {name} from {url}...")
    resp = requests.get(url)
    if resp.status_code == 200:
        file_path = os.path.join(env_pyzbar_path, name)
        with open(file_path, "wb") as f:
            f.write(resp.content)
        print(f"‚úÖ {name} saved to {file_path}")
    else:
        print(f"‚ùå Failed to fetch {name}, status code: {resp.status_code}")

print("\nüëç DLL download complete. Please restart your terminal/IDE and test again.")
