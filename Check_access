Failure while loading azureml_run_type_providers. Failed to load entrypoint azureml.scriptrun = azureml.core.script_run:ScriptRun._from_run_dto with exception (packaging 23.2 (/opt/conda/envs/ptca/lib/python3.8/site-packages), Requirement.parse('packaging<=23.0,>=20.0')).
Getting Data from Azure Workspace
####################
Data Ingested:  a703a43e-b105-4924-af7c-85b9fefdba16
Columns: 
SRC_SYS_CD
MATL_NUM
NEW_MATCH_MATL_NUM
BOM_USG_CD
BOM_CAT_CD
BOM_NUM
ALT_BOM_NUM
BOM_UOM_CD
PLNT_CD
PREV_LVL_MATL_NUM
PREV_LVL_BOM_NUM
PREV_LVL_ALT_BOM_NUM
PREV_LVL_BOM_UOM_CD
PREV_LVL_PLNT_CD
SUB_MATL_NUM
SUB_BOM_NUM
SUB_ALT_BOM_NUM
SUB_BOM_UOM_CD
SUB_PLNT_CD
CMPNT_MATL_NUM
BOM_LVL_NBR
BOM_LVL_NBR_DTLS
MATL_TYPE_CD
MATL_SHRT_DESC
MATL_UOM_CD
CMPNT_MATL_DESC
CMPNT_MATL_TYPE_CD
CMPNT_UOM_CD
BOM_BASE_QTY
FG_CMPNT_QTY
CMPNT_REQ_QTY
CMPNT_USG_FACT_MEAS
FG_CMPNT_USG_FACT_MEAS
CNV_FG_CMPNT_QTY
CNV_CMPNT_RQST_QTY
CNV_CMPNT_USG_FACT_QTY
CNV_FG_CMPNT_USG_FACT_QTY
CNV_BASE_UOM_CD
CMPNT_SCRAP_QTY
OPR_CMPNT_SCRAP_QTY
FX_QTY_IND
BOM_ITM_BULK_IND
ITM_VLD_TO_FLAG
BOM_ITM_CHG_NUM
BOM_ITM_NUM
BOM_FLOW_CD
BOM_FLOW_CD_FLTR
BOM_DEL_IND
LOGL_KEY_COMB_COL_NM
LOGL_KEY_COMB_COL_VAL
DAI_BTCH_ID
####################
Data Ingested:  cbaae20b-1419-41c2-b97e-7d53f2bf2265
Columns: 
SRC_SYS_CD
MATL_NUM
PADDED_MATL_NUM
BOM_USG_CD
BOM_CAT_CD
BOM_NUM
ALT_BOM_NUM
PLNT_CD
SUB_MATL_NUM
CMPNT_MATL_NUM
CMPNT_BOM_CAT_CD
CMPNT_BOM_NUM
CMPNT_ALT_BOM_NUM
BOM_LVL_NBR
MATL_TYPE_CD
MATL_SHRT_DESC
MATL_UOM_CD
CMPNT_MATL_DESC
CMPNT_MATL_TYPE_CD
CMPNT_UOM_CD
BOM_BASE_QTY
CMPNT_REQ_QTY
CMPNT_USG_FACT_MEAS
FG_CMPNT_USG_FACT_MEAS
CMPNT_SCRAP_QTY
OPR_CMPNT_SCRAP_QTY
FX_QTY_IND
BOM_ITM_BULK_IND
BOM_ITM_CHG_NUM
BOM_ITM_NUM
BOM_DEL_IND
BOM_FLOW_CD
DPB_IND
LOGL_KEY_COMB_COL_NM
LOGL_KEY_COMB_COL_VAL
DAI_BTCH_ID
Initial ERP_PART_ID Presence Check:
In ERP IM: {'02109429', '02111779', '02109345', '02109344', '02112146'}
In ERP EM: set()
####################
Data Ingested:  367bffc5-90ee-45f2-8735-20e2d6e26c69
Columns: 
ERP_PART_NUM
ERP_DESC
RGN_CD
RGN2_CD
ERPRegion
MATL_STS_CD
FG_NM
FG_SPEC_NM
FG_ST_CD
FD_NM
FD_RVSN_NBR
FD_TITLE_DESC
FD_ST_CD
FD_MFG_LOC_TXT
CHILD_NM
CHILD_RVSN_NBR
CHILD_TITLE_DESC
RM_ST_CD
SEQ_NUM
QTY_VAL
WW_VAL
UOM_TXT
USG_CD
TEMPL_TYPE_CD
CHILD_TYPE_CD
SPEC_FLOW_CD
ERP_CD
LOGL_KEY_COMB_COL_NM
LOGL_KEY_COMB_COL_VAL
DAI_BTCH_ID
####################
Data Ingested:  f46e7319-a010-420c-84e1-52b889227711
Columns: 
ERP_PART_NUM
TRD_NM
CHILD_NM
RM_TITLE_DESC
MATL_STS_CD
DAI_BTCH_ID
LOGL_KEY_COMB_COL_NM
LOGL_KEY_COMB_COL_VAL
Tru data size (969020, 30) tru.columns: Index(['ERP_PART_NUM', 'ERP_DESC', 'RGN_CD', 'RGN2_CD', 'ERPRegion',
       'MATL_STS_CD', 'FG_NM', 'FG_SPEC_NM', 'FG_ST_CD', 'FD_NM',
       'FD_RVSN_NBR', 'FD_TITLE_DESC', 'FD_ST_CD', 'FD_MFG_LOC_TXT',
       'CHILD_NM', 'CHILD_RVSN_NBR', 'CHILD_TITLE_DESC', 'RM_ST_CD', 'SEQ_NUM',
       'QTY_VAL', 'WW_VAL', 'UOM_TXT', 'USG_CD', 'TEMPL_TYPE_CD',
       'CHILD_TYPE_CD', 'SPEC_FLOW_CD', 'ERP_CD', 'LOGL_KEY_COMB_COL_NM',
       'LOGL_KEY_COMB_COL_VAL', 'DAI_BTCH_ID'],
      dtype='object')
ERP EM  data size (969020, 30) erp_em.columns: Index(['SRC_SYS_CD', 'MATL_NUM', 'PADDED_MATL_NUM', 'BOM_USG_CD', 'BOM_CAT_CD',
       'BOM_NUM', 'ALT_BOM_NUM', 'PLNT_CD', 'SUB_MATL_NUM', 'CMPNT_MATL_NUM',
       'CMPNT_BOM_CAT_CD', 'CMPNT_BOM_NUM', 'CMPNT_ALT_BOM_NUM', 'BOM_LVL_NBR',
       'MATL_TYPE_CD', 'MATL_SHRT_DESC', 'MATL_UOM_CD', 'CMPNT_MATL_DESC',
       'CMPNT_MATL_TYPE_CD', 'CMPNT_UOM_CD', 'BOM_BASE_QTY', 'CMPNT_REQ_QTY',
       'CMPNT_USG_FACT_MEAS', 'FG_CMPNT_USG_FACT_MEAS', 'CMPNT_SCRAP_QTY',
       'OPR_CMPNT_SCRAP_QTY', 'FX_QTY_IND', 'BOM_ITM_BULK_IND',
       'BOM_ITM_CHG_NUM', 'BOM_ITM_NUM', 'BOM_DEL_IND', 'BOM_FLOW_CD',
       'DPB_IND', 'LOGL_KEY_COMB_COL_NM', 'LOGL_KEY_COMB_COL_VAL',
       'DAI_BTCH_ID'],
      dtype='object')
ERP IM data size (969020, 30) erp_im.columns: Index(['SRC_SYS_CD', 'MATL_NUM', 'NEW_MATCH_MATL_NUM', 'BOM_USG_CD',
       'BOM_CAT_CD', 'BOM_NUM', 'ALT_BOM_NUM', 'BOM_UOM_CD', 'PLNT_CD',
       'PREV_LVL_MATL_NUM', 'PREV_LVL_BOM_NUM', 'PREV_LVL_ALT_BOM_NUM',
       'PREV_LVL_BOM_UOM_CD', 'PREV_LVL_PLNT_CD', 'SUB_MATL_NUM',
       'SUB_BOM_NUM', 'SUB_ALT_BOM_NUM', 'SUB_BOM_UOM_CD', 'SUB_PLNT_CD',
       'CMPNT_MATL_NUM', 'BOM_LVL_NBR', 'BOM_LVL_NBR_DTLS', 'MATL_TYPE_CD',
       'MATL_SHRT_DESC', 'MATL_UOM_CD', 'CMPNT_MATL_DESC',
       'CMPNT_MATL_TYPE_CD', 'CMPNT_UOM_CD', 'BOM_BASE_QTY', 'FG_CMPNT_QTY',
       'CMPNT_REQ_QTY', 'CMPNT_USG_FACT_MEAS', 'FG_CMPNT_USG_FACT_MEAS',
       'CNV_FG_CMPNT_QTY', 'CNV_CMPNT_RQST_QTY', 'CNV_CMPNT_USG_FACT_QTY',
       'CNV_FG_CMPNT_USG_FACT_QTY', 'CNV_BASE_UOM_CD', 'CMPNT_SCRAP_QTY',
       'OPR_CMPNT_SCRAP_QTY', 'FX_QTY_IND', 'BOM_ITM_BULK_IND',
       'ITM_VLD_TO_FLAG', 'BOM_ITM_CHG_NUM', 'BOM_ITM_NUM', 'BOM_FLOW_CD',
       'BOM_FLOW_CD_FLTR', 'BOM_DEL_IND', 'LOGL_KEY_COMB_COL_NM',
       'LOGL_KEY_COMB_COL_VAL', 'DAI_BTCH_ID'],
      dtype='object')
erp_im['NEW_MATCH_MATL_NUM'].str.startswith('0').sum()
401119
erp_im['MATL_NUM'].str.startswith('0').sum()
744928
erp_em['Padded_MATL_NUM'].str.startswith('0').sum()
33712
Swapping Columns in EM
Swapping Columns in IM

[STEP 2] After NULL Filter — Tracked CMPNT_MATL_NUM presence
|   CMPNT_MATL_NUM | CMPNT_MATL_DESC              |
|-----------------:|:-----------------------------|
|         02109429 | CASE SUDAFED SIN PAIN 144X10 |
|         02109345 | CASE REHIDRAT VALUE PACK     |
|         02112146 | SHRINK FILM 300MX50UM OTC    |
|         02111779 | SHRINKFILM 280MM             |
|         02111779 | SHRINKFILM 280MM             |
|         02109345 | CASE REHIDRAT VALUE PACK     |
|         02112146 | SHRINK FILM 300MX50UM OTC    |
|         02111779 | SHRINKFILM 280MM             |
|         02111779 | SHRINKFILM 280MM             |
|         02109344 | CASE REHIDRAT MP 12S         |
|         02111779 | SHRINKFILM 280MM             |
|         02109344 | CASE REHIDRAT MP 12S         |
|         02111779 | SHRINKFILM 280MM             |
|         02111779 | SHRINKFILM 280MM             |
|         02109344 | CASE REHIDRAT MP 12S         |
|         02109345 | CASE REHIDRAT VALUE PACK     |
|         02112146 | SHRINK FILM 300MX50UM OTC    |
|         02109429 | CASE SUDAFED SIN PAIN 144X10 |
|         02109344 | CASE REHIDRAT MP 12S         |
|         02112146 | SHRINK FILM 300MX50UM OTC    |
|         02109345 | CASE REHIDRAT VALUE PACK     |
|         02111779 | SHRINKFILM 280MM             |
|         02111779 | SHRINKFILM 280MM             |
After column renaming / ID swap:
ERP IM - ERP_PART_IDs still present: {'02109429', '02111779', '02109345', '02109344', '02112146'}
ERP EM - ERP_PART_IDs still present: set()
drop zero from ERP IM - ERP_PART_IDs: set()
drop zero from ERP IM with updated list: {'2109429', '2111779', '2109345', '2112146', '2109344'}
                                                            
############################################################
Initial Data Input Diagnosis
############################################################
Number of erp im duplicate rows 338957
Number of erp em duplicate rows 83
Number of tru duplicate rows 162255
erp im records 745000
erp im null text 0
erp em records 33712
erp em null text 33712
tru records 969020
tru null text 0
Unique codes in erp IM data 16292
Unique codes in erp EM data 1557
Unique codes in tru data 38903
Unique CHILD_NMs 67927
############################################################
                                                            
Pre-Filter Diagnostic — ERP IM
Rows where ERP_PART_ID is in cmp_check_list:
Empty DataFrame
Columns: [SRC_SYS_CD, MATL_NUM, MATL_NUM_original, BOM_USG_CD, BOM_CAT_CD, BOM_NUM, ALT_BOM_NUM, BOM_UOM_CD, PLNT_CD, PREV_LVL_MATL_NUM, PREV_LVL_BOM_NUM, PREV_LVL_ALT_BOM_NUM, PREV_LVL_BOM_UOM_CD, PREV_LVL_PLNT_CD, SUB_MATL_NUM, SUB_BOM_NUM, SUB_ALT_BOM_NUM, SUB_BOM_UOM_CD, SUB_PLNT_CD, CMPNT_MATL_NUM, BOM_LVL_NBR, BOM_LVL_NBR_DTLS, MATL_TYPE_CD, MATL_SHRT_DESC, MATL_UOM_CD, CMPNT_MATL_DESC, CMPNT_MATL_TYPE_CD, CMPNT_UOM_CD, BOM_BASE_QTY, FG_CMPNT_QTY, CMPNT_REQ_QTY, CMPNT_USG_FACT_MEAS, FG_CMPNT_USG_FACT_MEAS, CNV_FG_CMPNT_QTY, CNV_CMPNT_RQST_QTY, CNV_CMPNT_USG_FACT_QTY, CNV_FG_CMPNT_USG_FACT_QTY, CNV_BASE_UOM_CD, CMPNT_SCRAP_QTY, OPR_CMPNT_SCRAP_QTY, FX_QTY_IND, BOM_ITM_BULK_IND, ITM_VLD_TO_FLAG, BOM_ITM_CHG_NUM, BOM_ITM_NUM, BOM_FLOW_CD, BOM_FLOW_CD_FLTR, BOM_DEL_IND, LOGL_KEY_COMB_COL_NM, LOGL_KEY_COMB_COL_VAL, DAI_BTCH_ID, CMPNT_MATL_NUM_original]
Index: []

Rows where ERP_PART_ID is in cmp_check_list AND ERP_PART_DESC is missing:
Empty DataFrame
Columns: [SRC_SYS_CD, MATL_NUM, MATL_NUM_original, BOM_USG_CD, BOM_CAT_CD, BOM_NUM, ALT_BOM_NUM, BOM_UOM_CD, PLNT_CD, PREV_LVL_MATL_NUM, PREV_LVL_BOM_NUM, PREV_LVL_ALT_BOM_NUM, PREV_LVL_BOM_UOM_CD, PREV_LVL_PLNT_CD, SUB_MATL_NUM, SUB_BOM_NUM, SUB_ALT_BOM_NUM, SUB_BOM_UOM_CD, SUB_PLNT_CD, CMPNT_MATL_NUM, BOM_LVL_NBR, BOM_LVL_NBR_DTLS, MATL_TYPE_CD, MATL_SHRT_DESC, MATL_UOM_CD, CMPNT_MATL_DESC, CMPNT_MATL_TYPE_CD, CMPNT_UOM_CD, BOM_BASE_QTY, FG_CMPNT_QTY, CMPNT_REQ_QTY, CMPNT_USG_FACT_MEAS, FG_CMPNT_USG_FACT_MEAS, CNV_FG_CMPNT_QTY, CNV_CMPNT_RQST_QTY, CNV_CMPNT_USG_FACT_QTY, CNV_FG_CMPNT_USG_FACT_QTY, CNV_BASE_UOM_CD, CMPNT_SCRAP_QTY, OPR_CMPNT_SCRAP_QTY, FX_QTY_IND, BOM_ITM_BULK_IND, ITM_VLD_TO_FLAG, BOM_ITM_CHG_NUM, BOM_ITM_NUM, BOM_FLOW_CD, BOM_FLOW_CD_FLTR, BOM_DEL_IND, LOGL_KEY_COMB_COL_NM, LOGL_KEY_COMB_COL_VAL, DAI_BTCH_ID, CMPNT_MATL_NUM_original]
Index: []

Rows where ERP_PART_ID is missing (NaN):
Empty DataFrame
Columns: [SRC_SYS_CD, MATL_NUM, MATL_NUM_original, BOM_USG_CD, BOM_CAT_CD, BOM_NUM, ALT_BOM_NUM, BOM_UOM_CD, PLNT_CD, PREV_LVL_MATL_NUM, PREV_LVL_BOM_NUM, PREV_LVL_ALT_BOM_NUM, PREV_LVL_BOM_UOM_CD, PREV_LVL_PLNT_CD, SUB_MATL_NUM, SUB_BOM_NUM, SUB_ALT_BOM_NUM, SUB_BOM_UOM_CD, SUB_PLNT_CD, CMPNT_MATL_NUM, BOM_LVL_NBR, BOM_LVL_NBR_DTLS, MATL_TYPE_CD, MATL_SHRT_DESC, MATL_UOM_CD, CMPNT_MATL_DESC, CMPNT_MATL_TYPE_CD, CMPNT_UOM_CD, BOM_BASE_QTY, FG_CMPNT_QTY, CMPNT_REQ_QTY, CMPNT_USG_FACT_MEAS, FG_CMPNT_USG_FACT_MEAS, CNV_FG_CMPNT_QTY, CNV_CMPNT_RQST_QTY, CNV_CMPNT_USG_FACT_QTY, CNV_FG_CMPNT_USG_FACT_QTY, CNV_BASE_UOM_CD, CMPNT_SCRAP_QTY, OPR_CMPNT_SCRAP_QTY, FX_QTY_IND, BOM_ITM_BULK_IND, ITM_VLD_TO_FLAG, BOM_ITM_CHG_NUM, BOM_ITM_NUM, BOM_FLOW_CD, BOM_FLOW_CD_FLTR, BOM_DEL_IND, LOGL_KEY_COMB_COL_NM, LOGL_KEY_COMB_COL_VAL, DAI_BTCH_ID, CMPNT_MATL_NUM_original]
Index: []
After NULL ERP_PART_DESC filter:
drop zero from ERP IM - ERP_PART_IDs: set()
drop zero from ERP IM with updated list: {'2109429', '2111779', '2109345', '2112146', '153931', '2109344'}
ERP IM - ERP_PART_IDs still present: set()
ERP EM - ERP_PART_IDs still present: set()
After HALB filter in ERP IM:
HALB - Remaining ERP_PART_IDs: {'2109429', '2111779', '2109345', '2112146', '153931', '2109344'}
Null value in  RM Specs 0
tru tru spec id null:  806765
Unique RM Specs associated to null descriptions 0
Merging ERP datasets
                    column   dtype
0               SRC_SYS_CD  object
1                 MATL_NUM  object
2        MATL_NUM_original  object
3           MATL_SHRT_DESC  object
4                  PLNT_CD  object
5       CMPNT_MATL_TYPE_CD  object
6           CMPNT_MATL_NUM  object
7  CMPNT_MATL_NUM_original  object
8          CMPNT_MATL_DESC  object
9                  key_erp  object

[STEP 6] Tracked CMPNT_MATL_NUM check before ERP–TRU match
erp data
  SRC_SYS_CD            MATL_NUM   MATL_NUM_original   
0        BPI  000000000090093303            90093303  \
1        MVX  000000000090374401            90374401   
2        CAP  000000000079634415  000000000079634415   
3        BPI  000000000004675503             4675503   
4        CLA  000000000000070125  000000000000070125   
5        CLA  000000000000070125  000000000000070125   
6        BPI  000000000090156402            90156402   
7        BPI  000000000005419729             5419729   
8        BPI  000000000006694108             6694108   
9        MVX  000000000005669107             5669107   

                       MATL_SHRT_DESC PLNT_CD CMPNT_MATL_TYPE_CD   
0       LPM D.SCH.250 VANILLA UNIVERS    IT01                  A  \
1        NICORETTE LOZ 2MG CF 80ST GB     HBG                 91   
2  J TTT Baby Wash 400ml AN (BMR)_DMN    210A                ROH   
3             list 1000 t.care spagna    IT01                  A   
4        BABAB CLUB PACK ASST 18X280S    BR12                ROH   
5        BABAB CLUB PACK ASST 18X280S    BR12               PACK   
6                SH 500 CAMOM.UK EDLP    IT01                  A   
7                  list 500 t.care uk    IT01                  A   
8                 ogx bals.385 aom uk    IT01                  A   
9       NICORETTE MICROTAB 2MG 100 CH     HBG                 72   

  CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
0         187010                  187010  \
1         444366                  444366   
2        5014045      000000000005014045   
3         610520                  610520   
4         113585      000000000000113585   
5         130179      000000000000130179   
6         607000                  607000   
7         645380                  645380   
8         110730                  110730   
9         945124                  945124   

                         CMPNT_MATL_DESC                              key_erp  
0         SOD.HYDROXIDE LIQUID 32%-TANIC   000000000090093303_187010_IT01_BPI  
1                         MANNITOL 150SD    000000000090374401_444366_HBG_MVX  
2   SP VERSATHIX MBAL-LQ-(SG) IBC(Croda)  000000000079634415_5014045_210A_CAP  
3                            THYMOL NF G   000000000004675503_610520_IT01_BPI  
4   TUBETE PAP TUBOLEVE ESP 15MM - 425MM   000000000000070125_113585_BR12_CLA  
5  FILME  STRETCH  POLIETIL PRE-ESTICADO   000000000000070125_130179_BR12_CLA  
6                     CITRIC ACID USP BB   000000000090156402_607000_IT01_BPI  
7                       ELETTRACHEM ASP5   000000000005419729_645380_IT01_BPI  
8                             D&C RED 40   000000000006694108_110730_IT01_BPI  
9                      BULKPÅSE MICROTAB    000000000005669107_945124_HBG_MVX  
 Tracked components still in ERP: set()
 Tracked components still in ERP_LIST1: {'2109429', '2111779', '2109345', '2112146', '153931', '2109344'}
 Their parent materials in TRU: set()
 Their parent materials in TRU_LIST1: set()
 Tracked components still in ERP_final: set()
 Tracked components still in ERP_LIST1_final: {'2109429', '2111779', '2109345', '2112146', '153931', '2109344'}

[Off-Spec Classification] BEFORE
ERP total rows: 438131
TRU total rows: 387951
Is 153931 in ERP_PART_IDs?  True
Is PC-0005147 in TRU_SPEC_IDs?  True
[DEBUG] Processing 438131 rows
[DEBUG] Sample row: ID=187010, DESC=SOD.HYDROXIDE LIQUID 32%-TANIC
ok
ok
ok
[DEBUG] Processing 387951 rows
[DEBUG] Sample row: ID=CG-086430, DESC=FG433013362/ Sticker/ Listerine/ Cool Mint/ 750ml/ Philippines  CRR322200
ok
ok
ok
[DEBUG] Processing 418814 rows
[DEBUG] Sample row: ID=PC-0014496, DESC=TUBE - 100 ml - 40 x 125 mm - Round - Beige Sleeve - Transparent Cap (Multilayer)
ok
ok
ok

[Off-Spec Classification] AFTER
ERP: 153931 flagged as off-spec? [ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True]
TRU: PC-0005147 flagged as off-spec? [ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True]
Total ERP off-spec records: 85543
Total TRU off-spec records: 33234
Total TRU off-spec records: 33234
tru_off_specs_no_common: PC-0005147 flagged as off-spec? [ True  True  True  True  True]
 erp_discarded components still in ERP_final: set()
 erp_discarded components still in ERP_LIST1_final: {'2109429', '2111779', '2109345', '2112146', '153931', '2109344'}
Unique RM Specs after discarding off specs 44271
85543 rows discarded from ERP as they are irrelevant materials
33234 rows discarded from TRU as they are irrelevant materials
############################################################
Common number of codes in both sources:  17572
Ingest Data took 235.39025568962097 seconds
------------------------------------------------------------

[DEBUG] TRU:Check if PC-008694 is present in data ingestion step
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
152523  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
152523  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
152523  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
152523  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
152523  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
152523  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru  
152523           NaN         NaN  000000000510006535_PC-008694  

🟢 AFTER ingest_data_and_prepare_examples
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
152523  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
152523  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
152523  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
152523  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
152523  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
152523  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru  
152523           NaN         NaN  000000000510006535_PC-008694  
Format raw material took 1.7443418502807617 seconds

[DEBUG] After format_raw_material_id - TRU
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
152523  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
152523  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
152523  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
152523  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
152523  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
152523  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru CHILD_NM_proc  
152523           NaN         NaN  000000000510006535_PC-008694     pc-008694  

 AFTER format_raw_material_id
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
152523  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
152523  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
152523  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
152523  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
152523  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
152523  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru CHILD_NM_proc  
152523           NaN         NaN  000000000510006535_PC-008694     pc-008694  
erp part desc nulls 0
tru spec desc nulls:  0
processing erp
processing tru
Process text description took 62.139235734939575 seconds
processing tru trade names
Process text description took 73.56462621688843 seconds

 AFTER preprocessed_text_description
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
152523  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
152523  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
152523  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
152523  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
152523  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
152523  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru CHILD_NM_proc   
152523           NaN         NaN  000000000510006535_PC-008694     pc-008694  \

                                  processed_desc_tru   
152523  shipper 376 x 281 x 84 mm rsc 32 ect flute c  \

       processed_desc_tru_trade_names  
152523                            NaN  

 AFTER create_features (tru)
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
152523  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
152523  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
152523  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
152523  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
152523  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
152523  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru CHILD_NM_proc   
152523           NaN         NaN  000000000510006535_PC-008694     pc-008694  \

                                  processed_desc_tru   
152523  shipper 376 x 281 x 84 mm rsc 32 ect flute c  \

       processed_desc_tru_trade_names extracted_rm_tru extra_info_tru   
152523                            NaN              NaN            NaN  \

        text_for_matching_tru  perc_alpha_char_tru  
152523  shipper rsc ect flute                  1.0  

🟢 AFTER create_features (tru_trade_names)
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
152523  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
152523  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
152523  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
152523  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
152523  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
152523  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru CHILD_NM_proc   
152523           NaN         NaN  000000000510006535_PC-008694     pc-008694  \

                                  processed_desc_tru   
152523  shipper 376 x 281 x 84 mm rsc 32 ect flute c  \

       processed_desc_tru_trade_names extracted_rm_tru extra_info_tru   
152523                            NaN              NaN            NaN  \

        text_for_matching_tru  perc_alpha_char_tru   
152523  shipper rsc ect flute                  1.0  \

       extracted_rm_tru_trade_names text_for_matching_tru_trade_names   
152523                          NaN                                    \

        perc_alpha_char_tru_trade_names  
152523                              0.0  
Create features took 105.02428317070007 seconds
files in mounted dir: /mnt/azureml/cr/j/096f41553b5e4f2eb20d9bf26acf3193/cap/data-capability/wd/INPUT_transformer_model
folder_with_model: /mnt/azureml/cr/j/096f41553b5e4f2eb20d9bf26acf3193/cap/data-capability/wd/INPUT_transformer_model/fine_tuned_roberta
erp records without embedding:  0
tru records without embedding:  0

✅ STEP 5a: Checking TRU before merge with unique_combinations
         CHILD_NM             mat_num
152523  PC-008694  000000000510006535

✅ STEP 5b: Checking ERP for TRU_MAT_NUM (padded & unpadded)
                  MATL_NUM SRC_SYS_CD        PLNT_CD
326925  000000000510006535       KDLE  External_KDLE
328061  000000000510006535       KDLE  External_KDLE
332874  000000000510006535       KDLE  External_KDLE
333232  000000000510006535       KDLE  External_KDLE
334216  000000000510006535       KDLE  External_KDLE
334406  000000000510006535       KDLE  External_KDLE
337532  000000000510006535       KDLE  External_KDLE
339720  000000000510006535       KDLE  External_KDLE
341538  000000000510006535       KDLE  External_KDLE
343352  000000000510006535       KDLE  External_KDLE
343900  000000000510006535       KDLE  External_KDLE
344564  000000000510006535       KDLE  External_KDLE
344762  000000000510006535       KDLE  External_KDLE
346236  000000000510006535       KDLE  External_KDLE
346237  000000000510006535       KDLE  External_KDLE
347207  000000000510006535       KDLE  External_KDLE
348727  000000000510006535       KDLE  External_KDLE
350489  000000000510006535       KDLE  External_KDLE
351503  000000000510006535       KDLE  External_KDLE
✅ Found TRU_MAT_NUM in ERP

✅ DEBUG 1b: ERP columns at this point:
['SRC_SYS_CD', 'MATL_NUM', 'MATL_NUM_original', 'MATL_SHRT_DESC', 'PLNT_CD', 'CMPNT_MATL_TYPE_CD', 'CMPNT_MATL_NUM', 'CMPNT_MATL_NUM_original', 'CMPNT_MATL_DESC', 'key_erp', 'is_off_spec_erp', 'CMPNT_MATL_NUM_proc', 'processed_desc_erp', 'extracted_rm_erp', 'text_for_matching_erp', 'perc_alpha_char_erp', 'embedding_erp']
ununique_combinations contain erp or not

 DEBUG 2: After tru.merge(unique_combinations)
         CHILD_NM   CHILD_NM SRC_SYS_CD        PLNT_CD             mat_num
316059  PC-008694  PC-008694       KDLE  External_KDLE  000000000510006535

 AFTER tru.merge(unique_combinations)
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
316059  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
316059  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
316059  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
316059  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
316059  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
316059  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL                       key_tru CHILD_NM_proc   
316059           NaN         NaN  000000000510006535_PC-008694     pc-008694  \

                                  processed_desc_tru   
316059  shipper 376 x 281 x 84 mm rsc 32 ect flute c  \

       processed_desc_tru_trade_names extracted_rm_tru extra_info_tru   
316059                            NaN              NaN            NaN  \

        text_for_matching_tru  perc_alpha_char_tru   
316059  shipper rsc ect flute                  1.0  \

       extracted_rm_tru_trade_names text_for_matching_tru_trade_names   
316059                          NaN                                    \

        perc_alpha_char_tru_trade_names   
316059                              0.0  \

                                            embedding_tru SRC_SYS_CD   
316059  [0.042153895, 0.022906022, -0.0073228977, 0.04...       KDLE  \

              PLNT_CD            MATL_NUM MATL_NUM_original_tru_ref  
316059  External_KDLE  000000000510006535                 510006535  
------------------------------------------------------------
MATCH ROUND 1: ERP Part vs RM Spec
1: ERP Part vs RM Spec round matched: 1506 (0.45 seconds)
df_erp_to_match cases:  351082
df_tru_to_match cases:  356145
------------------------------------------------------------
MATCH ROUND 2: ERP Part vs RM Title
cross_hound/matcher.py:179: UserWarning: This pattern is interpreted as a regular expression, and has match groups. To actually get the groups, use str.extract.
  results = (s
cross_hound/matcher.py:179: UserWarning: This pattern is interpreted as a regular expression, and has match groups. To actually get the groups, use str.extract.
  results = (s
****** Adding 27703 more matches based on SPEC_FLOW_CD
2: ERP Part vs RM Title round matched: 75043 (569.25 seconds)
df_erp_to_match cases:  304343
df_tru_to_match cases:  284112
------------------------------------------------------------
MATCH ROUND 3: ERP Desc vs RM Spec
****** Adding 1 more matches based on SPEC_FLOW_CD
3: ERP Desc vs RM Spec round matched: 3036 (2183.3 seconds)
df_erp_to_match cases:  301307
df_tru_to_match cases:  281077
Amount of current matches:  75043
363 duplicates found in matches
------------------------------------------------------------

=== MATCH ROUND 4: Human Feedback ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in Human Feedback
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in Human Feedback
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in Human Feedback
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
****** Adding 110 more matches based on SPEC_FLOW_CD
4: Human Feedback round matched: 8139 (1.15 seconds)
df_erp_to_match cases:  293666
df_tru_to_match cases:  273539
Amount of current matches:  8139
------------------------------------------------------------
reading xmatches_EPR_priority_confidence file from folder 
mapping using ERP PART ID
    source      CMPNT_MATL_NUM                           CMPNT_MATL_DESC   
0      1S4  000000000000153931            2 1/2" LDPE Carton Bundle Wrap  \
1      1S4             900120K         ALUMINIUM SACHET FRENADOL COMPLEX   
2      1S4             900088N                  LEAFLET FRENADOL COMPLEX   
3      1S4             900105K        ALUMINIUM TUBE TITANOREINE 20G (F)   
4      1S4             900031L              FOLDING BOX FRENADOL COMPLEX   
..     ...                 ...                                       ...   
886    NaN          1.8123E+11               Pocket Mist Actuator Common   
887    NaN          1.8123E+11          Mint Cover_Cool Mint(PocketMist)   
888    NaN          1.8123E+11             Trigger_Cool Mint(PocketMist)   
889    NaN          1.8123E+11         Natural Collar Common(PocketMist)   
890    NaN          1.8123E+11  Spray Pump Assembly Common (Pocket Mist)   

       CHILD_NM                                   CHILD_TITLE_DESC   
0    PC-0005147      Guelph, 2.5" LDPE Carton Bundle Wrap - 153931  \
1    PC-0000336        Aluminium Foil - 110x57 mm- 85 g/m² - 65 µm   
2    PC-0000855     Leaflet - 315x170 mm - Reels - 50 GSM - Single   
3    PC-0000886  TUBE - Aluminium tube - 20ml - Internal and ex...   
4    PC-0000830  Folding Carton - 59.5 x 59.5  x 111.5 mm - A10...   
..          ...                                                ...   
886   PC-057563                                                NaN   
887  PC-0005780                                                NaN   
888  PC-0005784                                                NaN   
889  PC-0005827                                                NaN   
890   PC-058374                                                NaN   

    text_for_matching_erp  
0                     NaN  
1                     NaN  
2                     NaN  
3                     NaN  
4                     NaN  
..                    ...  
886                   NaN  
887                   NaN  
888                   NaN  
889                   NaN  
890                   NaN  

[891 rows x 6 columns]
 in nlp list ref phase 1
                   mat_num      mat_num_padded    mat_num_original RGN_CD   
316059  000000000510006535  000000000510006535  000000000510006535    NaN  \

             FG_NM                                         FG_SPEC_NM FD_NM   
316059  FG-0048803  510006535 Desitin Maximum Strength Paste 40% Z...  None  \

         CHILD_NM CHILD_NM_original   
316059  PC-008694         PC-008694  \

                                         CHILD_TITLE_DESC spec_type_inferred   
316059  Shipper - 376  x 281 x 84 mm - RSC - 32 ECT Fl...                 PC  \

               TEMPL_TYPE_CD        CHILD_TYPE_CD   
316059  Corrugated / Shipper  Packaging Component  \

                           ERP_DESC                         SPEC_FLOW_CD   
316059  DESITIN MS OINTMENT JAR 16Z  FG-0048803 > DC-0079931 > PC-008694  \

       TRD_NM_CONCAT TRD_NM_FULL   
316059           NaN         NaN  \

                                                key_tru CHILD_NM_proc   
316059  000000000510006535_PC-008694_External_KDLE_KDLE     pc-008694  \

                                  processed_desc_tru   
316059  shipper 376 x 281 x 84 mm rsc 32 ect flute c  \

       processed_desc_tru_trade_names extracted_rm_tru extra_info_tru   
316059                            NaN              NaN            NaN  \

        text_for_matching_tru  perc_alpha_char_tru   
316059  shipper rsc ect flute                  1.0  \

       extracted_rm_tru_trade_names text_for_matching_tru_trade_names   
316059                          NaN                                    \

        perc_alpha_char_tru_trade_names SRC_SYS_CD        PLNT_CD   
316059                              0.0       KDLE  External_KDLE  \

                  MATL_NUM MATL_NUM_original_tru_ref  
316059  000000000510006535                 510006535  
mapping using TRU_SPEC_ID
     source      CMPNT_MATL_NUM                           CMPNT_MATL_DESC   
0       1S4  000000000000153931            2 1/2" LDPE Carton Bundle Wrap  \
1       1S4             900120K         ALUMINIUM SACHET FRENADOL COMPLEX   
2       1S4             900088N                  LEAFLET FRENADOL COMPLEX   
3       1S4             900105K        ALUMINIUM TUBE TITANOREINE 20G (F)   
4       1S4             900031L              FOLDING BOX FRENADOL COMPLEX   
...     ...                 ...                                       ...   
1216    NaN          1.8123E+11         Natural Collar Common(PocketMist)   
1217    NaN          1.8123E+11  Spray Pump Assembly Common (Pocket Mist)   
1218    NaN          1.8123E+11  Spray Pump Assembly Common (Pocket Mist)   
1219    NaN          1.8123E+11  Spray Pump Assembly Common (Pocket Mist)   
1220    NaN          1.8123E+11  Spray Pump Assembly Common (Pocket Mist)   

        CHILD_NM                                   CHILD_TITLE_DESC   
0     PC-0005147      Guelph, 2.5" LDPE Carton Bundle Wrap - 153931  \
1     PC-0000336        Aluminium Foil - 110x57 mm- 85 g/m² - 65 µm   
2     PC-0000855     Leaflet - 315x170 mm - Reels - 50 GSM - Single   
3     PC-0000886  TUBE - Aluminium tube - 20ml - Internal and ex...   
4     PC-0000830  Folding Carton - 59.5 x 59.5  x 111.5 mm - A10...   
...          ...                                                ...   
1216  PC-0005827                                                NaN   
1217   PC-058374                                                NaN   
1218   PC-058374                                                NaN   
1219   PC-058374                                                NaN   
1220   PC-058374                                                NaN   

     text_for_matching_erp                     text_for_matching_tru  
0                      NaN                                       NaN  
1                      NaN                                       NaN  
2                      NaN                  leaflet reels gsm single  
3                      NaN                                       NaN  
4                      NaN                         folding carton gc  
...                    ...                                       ...  
1216                   NaN                                    collar  
1217                   NaN  spray pump assembly pocket mist products  
1218                   NaN             pump assembly pocket products  
1219                   NaN        pump assembly pocket mist products  
1220                   NaN              spray pump assembly products  

[1221 rows x 7 columns]
xmatches_NLP_list_ERP_with_text s1           CMPNT_MATL_NUM    CHILD_NM text_for_matching_erp   
0     000000000000153931  PC-0005147                   NaN  \
1                900120K  PC-0000336                   NaN   
2                900088N  PC-0000855                   NaN   
3                900105K  PC-0000886                   NaN   
4                900031L  PC-0000830                   NaN   
...                  ...         ...                   ...   
1216          1.8123E+11  PC-0005827                   NaN   
1217          1.8123E+11   PC-058374                   NaN   
1218          1.8123E+11   PC-058374                   NaN   
1219          1.8123E+11   PC-058374                   NaN   
1220          1.8123E+11   PC-058374                   NaN   

                         text_for_matching_tru  
0                                          NaN  
1                                          NaN  
2                     leaflet reels gsm single  
3                                          NaN  
4                            folding carton gc  
...                                        ...  
1216                                    collar  
1217  spray pump assembly pocket mist products  
1218             pump assembly pocket products  
1219        pump assembly pocket mist products  
1220              spray pump assembly products  

[1221 rows x 4 columns]
xmatches_NLP_list_ERP_with_text s2           CMPNT_MATL_NUM    CHILD_NM                   text_for_matching_erp   
0     000000000000153931  PC-0005147                                     NaN  \
1                900120K  PC-0000336                                     NaN   
2                900088N  PC-0000855                                     NaN   
3                900105K  PC-0000886                                     NaN   
4                900031L  PC-0000830                                     NaN   
...                  ...         ...                                     ...   
1197            30050521  PC-0011517                                     NaN   
1198              420385  PC-0003190  tube neut ultra sheer spf 70 dry touch   
1199              420358  PC-0003190       tube neut ultra sheer face spf 55   
1200            30050905  PC-0003475                                     NaN   
1201         73030048175   PC-013029       listerine essential care orig gel   

         text_for_matching_tru  
0                          NaN  
1                          NaN  
2     leaflet reels gsm single  
3                          NaN  
4            folding carton gc  
...                        ...  
1197                       NaN  
1198                       NaN  
1199                       NaN  
1200                       NaN  
1201                       NaN  

[1190 rows x 4 columns]

=== MATCH ROUND 5: matches_NLP_list_ERP suggested X-match ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in matches_NLP_list_ERP suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== DEBUG: Filtering for CMPNT_MATL_NUM: 30055433 and CHILD_NM: PC-008694

--- ERP + REF MERGE RESULT ---
     SRC_SYS_CD            MATL_NUM MATL_NUM_original MATL_SHRT_DESC   
6292       KDLE  000000000510006535         510006535        unknown  \

            PLNT_CD CMPNT_MATL_TYPE_CD CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
6292  External_KDLE               None       30055433                30055433  \

                    CMPNT_MATL_DESC     text_for_matching_erp   
6292  SHPR,16OZ,DESTN MAX STRNG DRP  shpr destn max strng drp  \

     extracted_rm_erp  perc_alpha_char_erp   
6292              NaN                  1.0  \

                                             key_erp   CHILD_NM  
6292  000000000510006535_30055433_External_KDLE_KDLE  PC-008694  

--- TRU ORIGINAL ---
Empty DataFrame
Columns: [mat_num, mat_num_padded, mat_num_original, RGN_CD, FG_NM, FG_SPEC_NM, FD_NM, CHILD_NM, CHILD_NM_original, CHILD_TITLE_DESC, spec_type_inferred, TEMPL_TYPE_CD, CHILD_TYPE_CD, ERP_DESC, SPEC_FLOW_CD, TRD_NM_CONCAT, TRD_NM_FULL, key_tru, CHILD_NM_proc, processed_desc_tru, processed_desc_tru_trade_names, extracted_rm_tru, extra_info_tru, text_for_matching_tru, perc_alpha_char_tru, extracted_rm_tru_trade_names, text_for_matching_tru_trade_names, perc_alpha_char_tru_trade_names, SRC_SYS_CD, PLNT_CD, MATL_NUM, MATL_NUM_original_tru_ref]
Index: []

✅ Checking key alignments and datatypes

⚠️ ERP or TRU debug data is empty.

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in matches_NLP_list_ERP suggested X-match
     CMPNT_MATL_NUM            MATL_NUM SRC_SYS_CD        PLNT_CD
6292       30055433  000000000510006535       KDLE  External_KDLE
Checking TRU for PC-008694 before ERP+TRU merge in matches_NLP_list_ERP suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
****** Adding 234 more matches based on SPEC_FLOW_CD
5: matches_NLP_list_ERP suggested X-match round matched: 4041 (1.17 seconds)
df_erp_to_match cases:  289775
df_tru_to_match cases:  269540
Amount of current matches:  4041
     SRC_SYS_CD            MATL_NUM   MATL_NUM_original   
0           CAP  000000000079638129  000000000079638129  \
1           CAP  000000000079638089  000000000079638089   
2           CAP  000000000079644467  000000000079644467   
3           CAP  000000000079643946  000000000079643946   
4           CAP  000000000079633058  000000000079633058   
...         ...                 ...                 ...   
7376        BPC  000000000005985402             5985402   
7377        BPC  000000000005985402             5985402   
7380        CAP  000000000079632185  000000000079632185   
7381        CAP  000000000079632254  000000000079632254   
7388       VPAK  000000000681127505           681127505   

                              MATL_SHRT_DESC        PLNT_CD   
0         Listerine Coolmint 250ml CN GD0324           1000  \
1          Listerine Freshburst 250ml GD0324           1000   
2      Listerine Professional GUM CARE 250ml           1000   
3              Listerine Gum Care 250ml 2024           1000   
4       Listerine Coolmint 250ml HK 2018_DMN           1000   
...                                      ...            ...   
7376                JH 24HM SOFT BODY CR 300           EG04   
7377                JH 24HM SOFT BODY CR 300           EG04   
7380  Listerine CoolMint 750ml (MK) TH 23GD+           240A   
7381       Listerine CoolMint 750ml VN 23GD+           240A   
7388                                 unknown  External_VPAK   

     CMPNT_MATL_TYPE_CD CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
0                  PACK        6141435      000000000006141435  \
1                  PACK        6141435      000000000006141435   
2                  PACK        6141435      000000000006141435   
3                  PACK        6141435      000000000006141435   
4                  PACK        6141435      000000000006141435   
...                 ...            ...                     ...   
7376                  P     PMC0901298              PMC0901298   
7377                  P     PMC0901316              PMC0901316   
7380               PACK        6142503      000000000006142503   
7381               PACK        6142503      000000000006142503   
7388               None         696127                  696127   

                            CMPNT_MATL_DESC      text_for_matching_erp   
0     PET SS for Listerine Product-250ml GD      pet ss for product gd  \
1     PET SS for Listerine Product-250ml GD      pet ss for product gd   
2     PET SS for Listerine Product-250ml GD      pet ss for product gd   
3     PET SS for Listerine Product-250ml GD      pet ss for product gd   
4     PET SS for Listerine Product-250ml GD      pet ss for product gd   
...                                     ...                        ...   
7376         Label side F. soft cream 300 m           label side cream   
7377         Label side B. soft cream 300 m           label side cream   
7380  6132355 SHD Listerine CM 750ml TH GD+                  shd cm gd   
7381  6132355 SHD Listerine CM 750ml TH GD+               shd cm th gd   
7388        SHPR NEUT ULTRA GEL CLNSR 5.8oz  shpr neut ultra gel clnsr   

     extracted_rm_erp  perc_alpha_char_erp   
0                 NaN                  1.0  \
1                 NaN                  1.0   
2                 NaN                  1.0   
3                 NaN                  1.0   
4                 NaN                  1.0   
...               ...                  ...   
7376              NaN                  1.0   
7377              NaN                  1.0   
7380              NaN                  1.0   
7381              NaN                  1.0   
7388              NaN                  1.0   

                                           key_erp    CHILD_NM RGN_CD   
0              000000000079638129_6141435_1000_CAP  PC-0018083   APAC  \
1              000000000079638089_6141435_1000_CAP  PC-0018083   APAC   
2              000000000079644467_6141435_1000_CAP  PC-0018083   APAC   
3              000000000079643946_6141435_1000_CAP  PC-0018083   APAC   
4              000000000079633058_6141435_1000_CAP  PC-0018083   APAC   
...                                            ...         ...    ...   
7376        000000000005985402_PMC0901298_EG04_BPC  DC-0074081   EMEA   
7377        000000000005985402_PMC0901316_EG04_BPC  DC-0074081   EMEA   
7380           000000000079632185_6142503_240A_CAP  PC-0010002   APAC   
7381           000000000079632254_6142503_240A_CAP  PC-0010002   APAC   
7388  000000000681127505_696127_External_VPAK_VPAK  DC-0022654    NaN   

                 mat_num MATL_NUM_original_tru_ref      mat_num_padded   
0     000000000079638129        000000000079638129  000000000079638129  \
1     000000000079638089        000000000079638089  000000000079638089   
2     000000000079644467        000000000079644467  000000000079644467   
3     000000000079643946        000000000079643946  000000000079643946   
4     000000000079633058        000000000079633058  000000000079633058   
...                  ...                       ...                 ...   
7376  000000000005985402                   5985402  000000000005985402   
7377  000000000005985402                   5985402  000000000005985402   
7380  000000000079632185        000000000079632185  000000000079632185   
7381  000000000079632254        000000000079632254  000000000079632254   
7388  000000000681127505                 681127505  000000000681127505   

        mat_num_original       FG_NM   
0     000000000079638129  FG-0052676  \
1     000000000079638089  FG-0052545   
2     000000000079644467  FG-0057068   
3     000000000079643946  FG-0055358   
4     000000000079633058  FG-0052437   
...                  ...         ...   
7376  000000000005985402  FG-0019126   
7377  000000000005985402  FG-0019126   
7380  000000000079632185  FG-0042313   
7381  000000000079632254  FG-0041952   
7388  000000000681127505  FG-0031673   

                                             FG_SPEC_NM FD_NM   
0     Listerine / Listerine Cool Mint Mouthwash / 25...  None  \
1     Listerine/Listerine Freshburst Mouthwash /250m...  None   
2     Listerine/Listerine Professional Gum Care /250...  None   
3     Listerine/Listerine Gum Care Mouthwash/250ml/C...  None   
4     Listerine / Listerine Cool Mint Mouthwash / 25...  None   
...                                                 ...   ...   
7376  5985402 Johnsons 24hour Moisture soft cream 30...  None   
7377  5985402 Johnsons 24hour Moisture soft cream 30...  None   
7380  Listerine/Listerine Cool Mint/750ml/EN/TH/7963...  None   
7381  Listerine/Listerine Cool Mint/750ml/EN/VN/7963...  None   
7388  681127505-Neutrogena Ultra Gentle Daily Cleans...  None   

     CHILD_NM_original                                   CHILD_TITLE_DESC   
0           PC-0018083       Listerine 250ml PCR PET Cap seal-57.0x0.04mm  \
1           PC-0018083       Listerine 250ml PCR PET Cap seal-57.0x0.04mm   
2           PC-0018083       Listerine 250ml PCR PET Cap seal-57.0x0.04mm   
3           PC-0018083       Listerine 250ml PCR PET Cap seal-57.0x0.04mm   
4           PC-0018083       Listerine 250ml PCR PET Cap seal-57.0x0.04mm   
...                ...                                                ...   
7376        DC-0074081  Johnsons 24hour Moisture soft cream 300 gm_Lab...   
7377        DC-0074081  Johnsons 24hour Moisture soft cream 300 gm_Lab...   
7380        PC-0010002  SHOULDER LABEL - Listerine - 750mL - 84 x 28 m...   
7381        PC-0010002  SHOULDER LABEL - Listerine - 750mL - 84 x 28 m...   
7388        DC-0022654  "30045932 Generic Shipper Neutrogena 9"" x 6-1...   

     spec_type_inferred                     TEMPL_TYPE_CD   
0                    PC  Film / Laminates / Pouch and Bag  \
1                    PC  Film / Laminates / Pouch and Bag   
2                    PC  Film / Laminates / Pouch and Bag   
3                    PC  Film / Laminates / Pouch and Bag   
4                    PC  Film / Laminates / Pouch and Bag   
...                 ...                               ...   
7376                 DC                              None   
7377                 DC                              None   
7380                 PC      Labels / Leaflets / Booklets   
7381                 PC      Labels / Leaflets / Booklets   
7388                 DC                              None   

            CHILD_TYPE_CD                                  ERP_DESC   
0     Packaging Component        Listerine Coolmint 250ml CN GD0324  \
1     Packaging Component         Listerine Freshburst 250ml GD0324   
2     Packaging Component     Listerine Professional GUM CARE 250ml   
3     Packaging Component             Listerine Gum Care 250ml 2024   
4     Packaging Component      Listerine Coolmint 250ml HK 2018_DMN   
...                   ...                                       ...   
7376  Decorated Component            JH 24HM SOFT BODY CR 300 AR/EN   
7377  Decorated Component            JH 24HM SOFT BODY CR 300 AR/EN   
7380  Packaging Component    Listerine CoolMint 750ml (MK) TH 23GD+   
7381  Packaging Component         Listerine CoolMint 750ml VN 23GD+   
7388  Decorated Component  NTG ULTRA GENTLE DAILY CLNSR FF 5.8 FLOZ   

                             text_for_matching_tru   
0                                 pcr pet cap seal  \
1                                 pcr pet cap seal   
2                                 pcr pet cap seal   
3                                 pcr pet cap seal   
4                                 pcr pet cap seal   
...                                            ...   
7376  johnsons hour moisture cream gm label bundle   
7377  johnsons hour moisture cream gm label bundle   
7380                   shoulder label pp white mcc   
7381                   shoulder label pp white mcc   
7388         generic shipper neutrogena usa canada   

     text_for_matching_tru_trade_names extracted_rm_tru  perc_alpha_char_tru   
0                                                   NaN                  1.0  \
1                                                   NaN                  1.0   
2                                                   NaN                  1.0   
3                                                   NaN                  1.0   
4                                                   NaN                  1.0   
...                                ...              ...                  ...   
7376                                                NaN                  1.0   
7377                                                NaN                  1.0   
7380                                                NaN                  1.0   
7381                                                NaN                  1.0   
7388                                                NaN                  1.0   

                                               key_tru   
0               000000000079638129_PC-0018083_1000_CAP  \
1               000000000079638089_PC-0018083_1000_CAP   
2               000000000079644467_PC-0018083_1000_CAP   
3               000000000079643946_PC-0018083_1000_CAP   
4               000000000079633058_PC-0018083_1000_CAP   
...                                                ...   
7376            000000000005985402_DC-0074081_EG04_BPC   
7377            000000000005985402_DC-0074081_EG04_BPC   
7380            000000000079632185_PC-0010002_240A_CAP   
7381            000000000079632254_PC-0010002_240A_CAP   
7388  000000000681127505_DC-0022654_External_VPAK_VPAK   

                              SPEC_FLOW_CD TRD_NM_CONCAT TRD_NM_FULL   
0     FG-0052676 > DC-0078777 > PC-0018083           NaN         NaN  \
1     FG-0052545 > DC-0078777 > PC-0018083           NaN         NaN   
2     FG-0057068 > DC-0078777 > PC-0018083           NaN         NaN   
3     FG-0055358 > DC-0078777 > PC-0018083           NaN         NaN   
4     FG-0052437 > DC-0078777 > PC-0018083           NaN         NaN   
...                                    ...           ...         ...   
7376   FG-0019126 > DC-0074081 > PC-043036           NaN         NaN   
7377   FG-0019126 > DC-0074081 > PC-043036           NaN         NaN   
7380  FG-0042313 > DC-0063578 > PC-0010002           NaN         NaN   
7381                 FG-0041952>PC-0010002           NaN         NaN   
7388  FG-0031673 > DC-0022654 > PC-0005393           NaN         NaN   

      matching_score    unified_mat_code  is_matched   
0                  1  000000000079638129        True  \
1                  1  000000000079638089        True   
2                  1  000000000079644467        True   
3                  1  000000000079643946        True   
4                  1  000000000079633058        True   
...              ...                 ...         ...   
7376               1             5985402        True   
7377               1             5985402        True   
7380               1  000000000079632185        True   
7381               1  000000000079632254        True   
7388               1           681127505        True   

                             Matching Reason confidence   
0     matches_NLP_list_ERP suggested X-match       high  \
1     matches_NLP_list_ERP suggested X-match       high   
2     matches_NLP_list_ERP suggested X-match       high   
3     matches_NLP_list_ERP suggested X-match       high   
4     matches_NLP_list_ERP suggested X-match       high   
...                                      ...        ...   
7376     PC and DC mentioned in SPEC_FLOW_CD       high   
7377     PC and DC mentioned in SPEC_FLOW_CD       high   
7380     PC and DC mentioned in SPEC_FLOW_CD       high   
7381     PC and DC mentioned in SPEC_FLOW_CD       high   
7388     PC and DC mentioned in SPEC_FLOW_CD       high   

                                    match_round  
0     5: matches_NLP_list_ERP suggested X-match  
1     5: matches_NLP_list_ERP suggested X-match  
2     5: matches_NLP_list_ERP suggested X-match  
3     5: matches_NLP_list_ERP suggested X-match  
4     5: matches_NLP_list_ERP suggested X-match  
...                                         ...  
7376  5: matches_NLP_list_ERP suggested X-match  
7377  5: matches_NLP_list_ERP suggested X-match  
7380  5: matches_NLP_list_ERP suggested X-match  
7381  5: matches_NLP_list_ERP suggested X-match  
7388  5: matches_NLP_list_ERP suggested X-match  

[4041 rows x 42 columns]
------------------------------------------------------------

=== MATCH ROUND 6: Pair found in Pendulum ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in Pair found in Pendulum
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in Pair found in Pendulum
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in Pair found in Pendulum
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
****** Adding 1134 more matches based on SPEC_FLOW_CD
6: Pair found in Pendulum round matched: 146823 (2.69 seconds)
df_erp_to_match cases:  148546
df_tru_to_match cases:  127817
Amount of current matches:  146823
------------------------------------------------------------

=== MATCH ROUND 7: Fortrea suggested X-match ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in Fortrea suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in Fortrea suggested X-match
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in Fortrea suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
****** Adding 217 more matches based on SPEC_FLOW_CD
7: Fortrea suggested X-match round matched: 7614 (0.65 seconds)
df_erp_to_match cases:  141320
df_tru_to_match cases:  120384
Amount of current matches:  7614
------------------------------------------------------------

=== MATCH ROUND 8: Fortrea Pendulum Validated ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in Fortrea Pendulum Validated
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in Fortrea Pendulum Validated
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in Fortrea Pendulum Validated
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
****** Adding 2 more matches based on SPEC_FLOW_CD
8: Fortrea Pendulum Validated round matched: 18 (0.54 seconds)
df_erp_to_match cases:  141303
df_tru_to_match cases:  120366
Amount of current matches:  18
------------------------------------------------------------
                           text_for_matching_erp CMPNT_MATL_NUM
0                     sod hydroxide liquid tanic         187010
1                                 mannitol 150sd         444366
2              sp versathix mbal lq sg ibc croda        5014045
3                                         thymol         610520
4                        tubete pap tuboleve esp         113585
...                                          ...            ...
352564           remypro n80 irradiated material         134911
352571       shrink film 12 clysar hpgf 45 gauge          64000
352573  label ntgcos moistsmth colrstk 160sd shd   358030031140
352580            ctn bactidol hlem 6x16l v2 phl         131289
352582              folding box motilium 20 tabs        4602756

[58286 rows x 2 columns]

=== MATCH ROUND 9: Pomezia suggested X-match ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in Pomezia suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in Pomezia suggested X-match
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in Pomezia suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
9: Pomezia suggested X-match round matched: 2114 (0.43 seconds)
df_erp_to_match cases:  139189
df_tru_to_match cases:  118252
Amount of current matches:  2114
     SRC_SYS_CD            MATL_NUM MATL_NUM_original   
0           BPI  000000000009433001           9433001  \
1           BPI  000000000009432306           9432306   
2           BPI  000000000009434207           9434207   
3           BPI  000000000009432004           9432004   
4           BPI  000000000009434208           9434208   
...         ...                 ...               ...   
3088        BPI  000000000090587700          90587700   
3095        BPI  000000000090587800          90587800   
3097        BPI  000000000090587100          90587100   
3145        GR1  000000000009419301           9419301   
3209        BPI  000000000090585000          90585000   

                      MATL_SHRT_DESC PLNT_CD CMPNT_MATL_TYPE_CD   
0                         *sh 100 uk    IT01                  A  \
1                      SH 750 ITALIA    IT01                  A   
2                  sh 300 grecia/blk    IT01                  A   
3           SH 500 SPAGNA/PORTOGALLO    IT01                  A   
4                     sh 300 italia/    IT01                  A   
...                              ...     ...                ...   
3088  N H-BOOST B.GEL CRM 250 GE/BEN    IT01                  B   
3095   N H-BOOST B.GEL CREAM 250 CEE    IT01                  B   
3097  N DM B.LOT.250 SENS SK GER/BEN    IT01                  B   
3145   JH BABY CHAM 3IN1 WASH 300 UA    GR02                  A   
3209  N N/F B.LOT.250 V-RENEW GE/BEN    IT01                  B   

     CMPNT_MATL_NUM CMPNT_MATL_NUM_original                 CMPNT_MATL_DESC   
0            770420                  770420          PERF.GOLD 12 T12066771  \
1            770420                  770420          PERF.GOLD 12 T12066771   
2            770420                  770420          PERF.GOLD 12 T12066771   
3            770420                  770420          PERF.GOLD 12 T12066771   
4            770420                  770420          PERF.GOLD 12 T12066771   
...             ...                     ...                             ...   
3088         797190                  797190  POMPA META 250 BIANCO BRILLANT   
3095         797190                  797190  POMPA META 250 BIANCO BRILLANT   
3097         797190                  797190  POMPA META 250 BIANCO BRILLANT   
3145           1582                  001582          ACTIPHYTE CHAMOMILE GL   
3209         797200                  797200           POMPA META 250 PURPLE   

           text_for_matching_erp extracted_rm_erp  perc_alpha_char_erp   
0         perf gold 12 t12066771              NaN             0.473684  \
1         perf gold 12 t12066771              NaN             0.473684   
2         perf gold 12 t12066771              NaN             0.473684   
3         perf gold 12 t12066771              NaN             0.473684   
4         perf gold 12 t12066771              NaN             0.473684   
...                          ...              ...                  ...   
3088  pompa meta bianco brillant              NaN             1.000000   
3095  pompa meta bianco brillant              NaN             1.000000   
3097  pompa meta bianco brillant              NaN             1.000000   
3145      actiphyte chamomile gl              NaN             1.000000   
3209           pompa meta purple              NaN             1.000000   

                                 key_erp    CHILD_NM RGN_CD   
0     000000000009433001_770420_IT01_BPI   RM-018331   EMEA  \
1     000000000009432306_770420_IT01_BPI   RM-018331   EMEA   
2     000000000009434207_770420_IT01_BPI   RM-018331   EMEA   
3     000000000009432004_770420_IT01_BPI   RM-018331   EMEA   
4     000000000009434208_770420_IT01_BPI   RM-018331   EMEA   
...                                  ...         ...    ...   
3088  000000000090587700_797190_IT01_BPI  PC-0014332   EMEA   
3095  000000000090587800_797190_IT01_BPI  PC-0014332   EMEA   
3097  000000000090587100_797190_IT01_BPI  PC-0014332   EMEA   
3145    000000000009419301_1582_GR02_GR1   RM-014581   EMEA   
3209  000000000090585000_797200_IT01_BPI  PC-0015601   EMEA   

                 mat_num MATL_NUM_original_tru_ref      mat_num_padded   
0     000000000009433001                   9433001  000000000009433001  \
1     000000000009432306                   9432306  000000000009432306   
2     000000000009434207                   9434207  000000000009434207   
3     000000000009432004                   9432004  000000000009432004   
4     000000000009434208                   9434208  000000000009434208   
...                  ...                       ...                 ...   
3088  000000000090587700                  90587700  000000000090587700   
3095  000000000090587800                  90587800  000000000090587800   
3097  000000000090587100                  90587100  000000000090587100   
3145  000000000009419301                   9419301  000000000009419301   
3209  000000000090585000                  90585000  000000000090585000   

        mat_num_original       FG_NM   
0     000000000009433001  FG-0010366  \
1     000000000009432306  FG-0056886   
2     000000000009434207  FG-0035105   
3     000000000009432004  FG-0055778   
4     000000000009434208  FG-0035114   
...                  ...         ...   
3088  000000000090587700  FG-0056700   
3095  000000000090587800  FG-0056704   
3097  000000000090587100  FG-0055780   
3145  000000000009419301  FG-0014144   
3209  000000000090585000  FG-0056705   

                                             FG_SPEC_NM       FD_NM   
0       9433001        JOHNSON'S baby shampoo 100 ml UK   PF-013963  \
1        9432306       Johnson's Baby Shampoo    750 mL   PF-013963   
2         9434207         JOHNSON'S baby shampoo 300 ml  FD-0003683   
3                   9432004         JH BABY SHMP 500 ML   PF-013963   
4         9434208         JOHNSON'S baby shampoo 300 ml  FD-0003683   
...                                                 ...         ...   
3088         90587700       NG HB BODY GEL CREAM 250 ml        None   
3095         90587800       NG HB BODY GEL CREAM 250 ml        None   
3097  90587100              Norwegian Formula® Deep ...        None   
3145  9419301 - Johnson’s Chamomile Baby 3in1 Wash 3...   PF-013959   
3209  90585000         Norwegian Formula® Visibly Re...        None   

     CHILD_NM_original                                   CHILD_TITLE_DESC   
0            RM-018331  GOLD 12 T12066771 (Master Specification number...  \
1            RM-018331  GOLD 12 T12066771 (Master Specification number...   
2            RM-018331  GOLD 12 T12066771 (Master Specification number...   
3            RM-018331  GOLD 12 T12066771 (Master Specification number...   
4            RM-018331  GOLD 12 T12066771 (Master Specification number...   
...                ...                                                ...   
3088        PC-0014332  PUMP THREADED - Future  - 24/410 - White brigh...   
3095        PC-0014332  PUMP THREADED - Future  - 24/410 - White brigh...   
3097        PC-0014332  PUMP THREADED - Future  - 24/410 - White brigh...   
3145         RM-014581  Glycerin (and) Water (and) Chamomilla Recutita...   
3209        PC-0015601  PUMP THREADED - Future  - 24/410 - Purple - Fo...   

     spec_type_inferred     TEMPL_TYPE_CD        CHILD_TYPE_CD   
0                    RM              None           INGREDIENT  \
1                    RM              None           INGREDIENT   
2                    RM              None           INGREDIENT   
3                    RM              None           INGREDIENT   
4                    RM              None           INGREDIENT   
...                 ...               ...                  ...   
3088                 PC  Pump / Dispenser  Packaging Component   
3095                 PC  Pump / Dispenser  Packaging Component   
3097                 PC  Pump / Dispenser  Packaging Component   
3145                 RM              None           INGREDIENT   
3209                 PC  Pump / Dispenser  Packaging Component   

                            ERP_DESC   
0     JH BABY SHAMP REG 100       EN  \
1     JH BABY SHMP 750 ML         IT   
2     JH BABY SHMP REG 300 ML    SOE   
3     JH BABY SHMP 500 ML      ES/PT   
4     JH BABY SHMP 300 ML         IT   
...                              ...   
3088  NG HB BODY GEL CREAM 250 DACHB   
3095  NG HB BODY GEL CREAM 250   CEE   
3097  NG DM BDYLOT SENS SK 250 DACHB   
3145   JH BABY CHAM 3IN1 WASH 300 UA   
3209  NG VIS RENEW BDYLOT 250  DACHB   

                                  text_for_matching_tru   
0                                                  gold  \
1                                                  gold   
2                                                  gold   
3                                                  gold   
4                                                  gold   
...                                                 ...   
3088  pump threaded future white bright for meta bottle   
3095  pump threaded future white bright for meta bottle   
3097  pump threaded future white bright for meta bottle   
3145        glycerin chamomilla recutita flower extract   
3209        pump threaded future purple for meta bottle   

     text_for_matching_tru_trade_names extracted_rm_tru  perc_alpha_char_tru   
0                    t12066771 gold 12         rm018331                  1.0  \
1                    t12066771 gold 12         rm018331                  1.0   
2                                              rm018331                  1.0   
3                    t12066771 gold 12         rm018331                  1.0   
4                                              rm018331                  1.0   
...                                ...              ...                  ...   
3088                                                NaN                  1.0   
3095                                                NaN                  1.0   
3097                                                NaN                  1.0   
3145                                           rm014581                  1.0   
3209                                                NaN                  1.0   

                                     key_tru   
0      000000000009433001_RM-018331_IT01_BPI  \
1      000000000009432306_RM-018331_IT01_BPI   
2      000000000009434207_RM-018331_IT01_BPI   
3      000000000009432004_RM-018331_IT01_BPI   
4      000000000009434208_RM-018331_IT01_BPI   
...                                      ...   
3088  000000000090587700_PC-0014332_IT01_BPI   
3095  000000000090587800_PC-0014332_IT01_BPI   
3097  000000000090587100_PC-0014332_IT01_BPI   
3145   000000000009419301_RM-014581_GR02_GR1   
3209  000000000090585000_PC-0015601_IT01_BPI   

                             SPEC_FLOW_CD      TRD_NM_CONCAT   
0      FG-0010366 > PF-013963 > RM-018331  gold 12 t12066771  \
1      FG-0056886 > PF-013963 > RM-018331  gold 12 t12066771   
2     FG-0035105 > FD-0003683 > RM-018331                NaN   
3      FG-0055778 > PF-013963 > RM-018331  gold 12 t12066771   
4     FG-0035114 > FD-0003683 > RM-018331                NaN   
...                                   ...                ...   
3088                FG-0056700>PC-0014332                NaN   
3095                FG-0056704>PC-0014332                NaN   
3097                FG-0055780>PC-0014332                NaN   
3145   FG-0014144 > PF-013959 > RM-014581                NaN   
3209                FG-0056705>PC-0015601                NaN   

            TRD_NM_FULL  matching_score unified_mat_code  is_matched   
0     t12066771 gold 12               1          9433001        True  \
1     t12066771 gold 12               1          9432306        True   
2                   NaN               1          9434207        True   
3     t12066771 gold 12               1          9432004        True   
4                   NaN               1          9434208        True   
...                 ...             ...              ...         ...   
3088                NaN               1         90587700        True   
3095                NaN               1         90587800        True   
3097                NaN               1         90587100        True   
3145                NaN               1          9419301        True   
3209                NaN               1         90585000        True   

                Matching Reason confidence                   match_round  
0     Pomezia suggested X-match       high  9: Pomezia suggested X-match  
1     Pomezia suggested X-match       high  9: Pomezia suggested X-match  
2     Pomezia suggested X-match       high  9: Pomezia suggested X-match  
3     Pomezia suggested X-match       high  9: Pomezia suggested X-match  
4     Pomezia suggested X-match       high  9: Pomezia suggested X-match  
...                         ...        ...                           ...  
3088  Pomezia suggested X-match       high  9: Pomezia suggested X-match  
3095  Pomezia suggested X-match       high  9: Pomezia suggested X-match  
3097  Pomezia suggested X-match       high  9: Pomezia suggested X-match  
3145  Pomezia suggested X-match       high  9: Pomezia suggested X-match  
3209  Pomezia suggested X-match       high  9: Pomezia suggested X-match  

[2114 rows x 42 columns]
------------------------------------------------------------

=== MATCH ROUND 10: VDR_TRU suggested X-match ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in VDR_TRU suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in VDR_TRU suggested X-match
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in VDR_TRU suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
****** Adding 5 more matches based on SPEC_FLOW_CD
10: VDR_TRU suggested X-match round matched: 841 (0.53 seconds)
df_erp_to_match cases:  138359
df_tru_to_match cases:  117421
Amount of current matches:  841
     SRC_SYS_CD            MATL_NUM MATL_NUM_original   
0           VDR  000000000090748200         90748200N  \
1           VDR  000000000090333400         90333400N   
2           VDR  000000000002981203          2981203N   
3           VDR  000000000090333300         90333300N   
4           VDR  000000000090579800         90579800N   
...         ...                 ...               ...   
1497        GR1  000000000090464600          90464600   
1499        GR1  000000000004452008           4452008   
1564        VDR  000000000090515200         90515200N   
1565        VDR  000000000009022801          9022801N   
1567        VDR  000000000004840301          4840301N   

                        MATL_SHRT_DESC PLNT_CD CMPNT_MATL_TYPE_CD   
0              PENATEN CREAM 50ML Tray    0001               40MP  \
1                BEBE GC CREAM 50ML DE    0001               40MP   
2          PENA NAPPY RASH CR 200ML DE    0001               40MP   
3               BEBE GC CREAM 150ML DE    0001               40MP   
4            PENATEN CR 150ML DE FR IT    0001               40MP   
...                                ...     ...                ...   
1497        NG DEEP CL CLNS GEL 200 TR    GR02                  A   
1499        NG DEEP CLEAN GEL WASH 200    GR02                  A   
1564             MICROLAX 5ml X50   BE    0001               30AC   
1565  NG RT BOOST+INT NIGHT SERUM 30ML    0001               30AC   
1567  BEBE LIP CARE CLASSIC 4.9G HU PL    0001               30AC   

     CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
0            400132                  400132  \
1            400132                  400132   
2            400132                  400132   
3            400132                  400132   
4            400132                  400132   
...             ...                     ...   
1497           4308                  004308   
1499           4308                  004308   
1564        315250A                 315250A   
1565        313512C                 313512C   
1567        328983C                 328983C   

                             CMPNT_MATL_DESC     text_for_matching_erp   
0             5000472# MEDILAN-SO-(RB) ADD00       medilan so rb add00  \
1             5000472# MEDILAN-SO-(RB) ADD00       medilan so rb add00   
2             5000472# MEDILAN-SO-(RB) ADD00       medilan so rb add00   
3             5000472# MEDILAN-SO-(RB) ADD00       medilan so rb add00   
4             5000472# MEDILAN-SO-(RB) ADD00       medilan so rb add00   
...                                      ...                       ...   
1497                 ALTOSTRATUS 3 T12069995     altostratus t12069995   
1499                 ALTOSTRATUS 3 T12069995     altostratus t12069995   
1564              ETUI MICROLAX 5ml X50   BE                      etui   
1565  ETUI NG RB INTENSE CARE SERUM CEE 30ML  etui rb intense care cee   
1567      CART/BLIST BBYC STICK CLASSIC 4.9G     cart blist bbyc stick   

     extracted_rm_erp  perc_alpha_char_erp   
0                 NaN                0.875  \
1                 NaN                0.875   
2                 NaN                0.875   
3                 NaN                0.875   
4                 NaN                0.875   
...               ...                  ...   
1497              NaN                0.600   
1499              NaN                0.600   
1564              NaN                1.000   
1565              NaN                1.000   
1567              NaN                1.000   

                                  key_erp       CHILD_NM RGN_CD   
0      000000000090748200_400132_0001_VDR  RM-5000472-AP   EMEA  \
1      000000000090333400_400132_0001_VDR  RM-5000472-AP   EMEA   
2      000000000002981203_400132_0001_VDR  RM-5000472-AP   EMEA   
3      000000000090333300_400132_0001_VDR  RM-5000472-AP   EMEA   
4      000000000090579800_400132_0001_VDR  RM-5000472-AP   EMEA   
...                                   ...            ...    ...   
1497     000000000090464600_4308_GR02_GR1        RMT1681   EMEA   
1499     000000000004452008_4308_GR02_GR1        RMT1681   EMEA   
1564  000000000090515200_315250A_0001_VDR     DC-0097425   EMEA   
1565  000000000009022801_313512C_0001_VDR     DC-0050956   EMEA   
1567  000000000004840301_328983C_0001_VDR     DC-0063851   EMEA   

                 mat_num MATL_NUM_original_tru_ref      mat_num_padded   
0     000000000090748200                 90748200N  000000000090748200  \
1     000000000090333400                 90333400N  000000000090333400   
2     000000000002981203                  2981203N  000000000002981203   
3     000000000090333300                 90333300N  000000000090333300   
4     000000000090579800                 90579800N  000000000090579800   
...                  ...                       ...                 ...   
1497  000000000090464600                  90464600  000000000090464600   
1499  000000000004452008                   4452008  000000000004452008   
1564  000000000090515200                 90515200N  000000000090515200   
1565  000000000009022801                  9022801N  000000000009022801   
1567  000000000004840301                  4840301N  000000000004840301   

        mat_num_original       FG_NM   
0     000000000090748200  FG-0060684  \
1     000000000090333400  FG-0048926   
2     000000000002981203  FG-0054866   
3     000000000090333300  FG-0048444   
4     000000000090579800  FG-0055597   
...                  ...         ...   
1497  000000000090464600  FG-0054822   
1499  000000000004452008  FG-0058975   
1564  000000000090515200  FG-0060750   
1565  000000000009022801  FG-0049035   
1567  000000000004840301  FG-0043216   

                                             FG_SPEC_NM       FD_NM   
0                    PENATEN CREAM 50ML TRAY - 90748200  FD-0004864  \
1            BEBE - GENTLE CARE CREAM - 50ML - 90333400  FD-0004367   
2          PENATEN - NAPPY RASH CREAM - 200ML - 2981203  FD-0002298   
3           BEBE - GENTLE CARE CREAM - 150ML - 90333300  FD-0004367   
4                     PENATEN CR 150ML DE FR - 90579800  FD-0004864   
...                                                 ...         ...   
1497  90464600 - Neutrogena Arindirici Yüz Temizleme...  FD-0004667   
1499  4452008 - Neutrogena Deep Clean Face Wash 200m...  FD-0004667   
1564                 MICROLAX - 5ml X50 - BE - 90515200        None   
1565  Neutrogena - New - Anti-Age - Retinol Boost+ I...        None   
1567           BEBE - LIP CARE CLASSIC - 4.9G - 4840301        None   

     CHILD_NM_original                                   CHILD_TITLE_DESC   
0        RM-5000472-AP  Lanolin (Master specification number is RM‐500...  \
1        RM-5000472-AP  Lanolin (Master specification number is RM‐500...   
2        RM-5000472-AP  Lanolin (Master specification number is RM‐500...   
3        RM-5000472-AP  Lanolin (Master specification number is RM‐500...   
4        RM-5000472-AP  Lanolin (Master specification number is RM‐500...   
...                ...                                                ...   
1497           RMT1681                            ALTOSTRATUS 3 T12069995   
1499           RMT1681                            ALTOSTRATUS 3 T12069995   
1564        DC-0097425  Microlax Adult Rectal Solution/5ml/50ct/Carton...   
1565        DC-0050956  RB Intense Night Serum 30ml CEE carton/Folding...   
1567        DC-0063851       Bebe YC Lipst Classic/4.9g/Cardboard/328983B   

     spec_type_inferred TEMPL_TYPE_CD        CHILD_TYPE_CD   
0                    RM          None           INGREDIENT  \
1                    RM          None           INGREDIENT   
2                    RM          None           INGREDIENT   
3                    RM          None           INGREDIENT   
4                    RM          None           INGREDIENT   
...                 ...           ...                  ...   
1497                 RM          None           INGREDIENT   
1499                 RM          None           INGREDIENT   
1564                 DC          None  Decorated Component   
1565                 DC          None  Decorated Component   
1567                 DC          None  Decorated Component   

                              ERP_DESC              text_for_matching_tru   
0              PENATEN CREAM 50ML Tray                            lanolin  \
1            BEBE GENTLE CARE CR 50 ML                            lanolin   
2       PENA NAPPY RASH CR         200                            lanolin   
3        BEBE GENTLE CARE CR 150 ML DE                            lanolin   
4                  PENA CR 150ML DE/FR                            lanolin   
...                                ...                                ...   
1497        NG DEEP CL CLNS GEL 200 TR                        altostratus   
1499        NG DEEP CLEAN GEL WASH 200                        altostratus   
1564             MICROLAX 5ML X50   BE    adult rectal solution ct carton   
1565  NG RT BOOST+INT NIGHT SERUM 30ML  rb intense cee carton folding box   
1567        BEBE LIP CARE CLASSIC 4.9G                 yc lipst cardboard   

                      text_for_matching_tru_trade_names extracted_rm_tru   
0     eur so rb no ultrapure elp bht anhydrous lanol...     rm5000472-ap  \
1     eur so rb ultrapure elp no bht anhydrous lanol...     rm5000472-ap   
2     eur so rb no ultrapure elp bht anhydrous lanol...     rm5000472-ap   
3     eur so rb no ultrapure elp bht anhydrous lanol...     rm5000472-ap   
4     eur so rb ultrapure elp no bht anhydrous lanol...     rm5000472-ap   
...                                                 ...              ...   
1497                                                              rm1681   
1499                                                              rm1681   
1564                                                                 NaN   
1565                                                                 NaN   
1567                                                                 NaN   

      perc_alpha_char_tru                                    key_tru   
0                     1.0  000000000090748200_RM-5000472-AP_0001_VDR  \
1                     1.0  000000000090333400_RM-5000472-AP_0001_VDR   
2                     1.0  000000000002981203_RM-5000472-AP_0001_VDR   
3                     1.0  000000000090333300_RM-5000472-AP_0001_VDR   
4                     1.0  000000000090579800_RM-5000472-AP_0001_VDR   
...                   ...                                        ...   
1497                  1.0        000000000090464600_RMT1681_GR02_GR1   
1499                  1.0        000000000004452008_RMT1681_GR02_GR1   
1564                  1.0     000000000090515200_DC-0097425_0001_VDR   
1565                  1.0     000000000009022801_DC-0050956_0001_VDR   
1567                  1.0     000000000004840301_DC-0063851_0001_VDR   

                                 SPEC_FLOW_CD   
0     FG-0060684 > FD-0004864 > RM-5000472-AP  \
1     FG-0048926 > FD-0004367 > RM-5000472-AP   
2     FG-0054866 > FD-0002298 > RM-5000472-AP   
3     FG-0048444 > FD-0004367 > RM-5000472-AP   
4     FG-0055597 > FD-0004864 > RM-5000472-AP   
...                                       ...   
1497        FG-0054822 > FD-0004667 > RMT1681   
1499        FG-0058975 > FD-0004667 > RMT1681   
1564     FG-0060750 > DC-0097425 > PC-0018778   
1565     FG-0049035 > DC-0050956 > PC-0011991   
1567     FG-0043216 > DC-0063851 > PC-0003001   

                                          TRD_NM_CONCAT   
0     pharmalan 7-so-(rb)||pharmalan ph eur-so-(rb)|...  \
1     anhydrous lanolin||anhydrous lanolin ultrapure...   
2     anhydrous lanolin ultrapure||pharmalan ph eur-...   
3     anhydrous lanolin ultrapure||medilan (no bht)-...   
4     pharmalan 7-so-(rb)||anhydrous lanolin ultrapu...   
...                                                 ...   
1497                                                NaN   
1499                                                NaN   
1564                                                NaN   
1565                                                NaN   
1567                                                NaN   

                                            TRD_NM_FULL  matching_score   
0     eur-so-(rb) (no ultrapure elp % 7-so-(rb) bht)...               1  \
1     eur-so-(rb) % ultrapure elp (no 7-so-(rb) bht)...               1   
2     eur-so-(rb) (no ultrapure elp % 7-so-(rb) bht)...               1   
3     eur-so-(rb) (no ultrapure elp % 7-so-(rb) bht)...               1   
4     eur-so-(rb) % ultrapure elp (no 7-so-(rb) bht)...               1   
...                                                 ...             ...   
1497                                                NaN               1   
1499                                                NaN               1   
1564                                                NaN               1   
1565                                                NaN               1   
1567                                                NaN               1   

     unified_mat_code  is_matched                      Matching Reason   
0           90748200N        True            VDR_TRU suggested X-match  \
1           90333400N        True            VDR_TRU suggested X-match   
2            2981203N        True            VDR_TRU suggested X-match   
3           90333300N        True            VDR_TRU suggested X-match   
4           90579800N        True            VDR_TRU suggested X-match   
...               ...         ...                                  ...   
1497         90464600        True            VDR_TRU suggested X-match   
1499          4452008        True            VDR_TRU suggested X-match   
1564        90515200N        True  PC and DC mentioned in SPEC_FLOW_CD   
1565         9022801N        True  PC and DC mentioned in SPEC_FLOW_CD   
1567         4840301N        True  PC and DC mentioned in SPEC_FLOW_CD   

     confidence                    match_round  
0          high  10: VDR_TRU suggested X-match  
1          high  10: VDR_TRU suggested X-match  
2          high  10: VDR_TRU suggested X-match  
3          high  10: VDR_TRU suggested X-match  
4          high  10: VDR_TRU suggested X-match  
...         ...                            ...  
1497       high  10: VDR_TRU suggested X-match  
1499       high  10: VDR_TRU suggested X-match  
1564       high  10: VDR_TRU suggested X-match  
1565       high  10: VDR_TRU suggested X-match  
1567       high  10: VDR_TRU suggested X-match  

[841 rows x 42 columns]
------------------------------------------------------------
   source CMPNT_MATL_NUM                          CMPNT_MATL_DESC   
0     NaN         578009       FCO JS SH BLACKINHO PODEROSO 200ML  \
1     NaN         572618              BER INF PR SOLAR MULTI 2022   
2     NaN         200143                    SLIPSHEET 1,28 X 1,28   
3     NaN         573605         PAPEL SILIC GLASSINE 85GSM-425MM   
4     NaN          34915                      ADHESIVE HM 3210-02   
5     NaN         573324  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM   
6     NaN         573321  Transparent IFW 14 g/m² 215mm unprinted   
7     NaN         101338                       ADESIVO NW-1042-ZP   
8     NaN         578048                         ABRACADEIRA T18L   
9     NaN      500002994             SACO PLASTICO PRETO 30X35 CM   
10    NaN      500001956    SACO PLASTICO TRANSPARENTE  80X120 CM   
11    NaN         578047                        BOMBONA 20 LITROS   
12    NaN      500001955      SACO PLASTICO TRANSPARENTE 65X75 CM   
13    NaN         559199              WRP DECO BTM - 92MM  LA -YD   
14    NaN          84127           SACO P/ PROD.A GRANEL DIVERSOS   
15    NaN         579138   Frasco J'S Baby Sab Liq Camomila 200ml   
16    NaN         578012           FCO JS SH GOTAS D BRILHO 200ML   
17    NaN          13807                  CX.PAPELAO OND NUMERO 5   
18    NaN         572619              BER SUP PR SOLAR MULTI 2022   

                   CHILD_NM CHILD_TITLE_DESC  
0   PC-0000603/ PC-0021072               NaN  
1                PC-0005791              NaN  
2                 PC-045951              NaN  
3                RM-0002165              NaN  
4              MP-BR-002209              NaN  
5                RM-0002213              NaN  
6                RM-0002213              NaN  
7              MP-BR-002196              NaN  
8                PC-0017245              NaN  
9                PC-0016081              NaN  
10               PC-0016063              NaN  
11               PC-0017217              NaN  
12               PC-0016062              NaN  
13                PC-050581              NaN  
14            MAE-BR-004745              NaN  
15    PC-0020114/PC-0000603              NaN  
16   PC-0000603/ PC-0020112              NaN  
17            MAE-BR-004836              NaN  
18               PC-0005791              NaN  
xmatches_Xref_Request_for_SJC_with_text 1
   source CMPNT_MATL_NUM                          CMPNT_MATL_DESC   
0     NaN         578009       FCO JS SH BLACKINHO PODEROSO 200ML  \
1     NaN         578009       FCO JS SH BLACKINHO PODEROSO 200ML   
2     NaN         572618              BER INF PR SOLAR MULTI 2022   
3     NaN         200143                    SLIPSHEET 1,28 X 1,28   
4     NaN         573605         PAPEL SILIC GLASSINE 85GSM-425MM   
5     NaN          34915                      ADHESIVE HM 3210-02   
6     NaN         573324  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM   
7     NaN         573321  Transparent IFW 14 g/m² 215mm unprinted   
8     NaN         101338                       ADESIVO NW-1042-ZP   
9     NaN         578048                         ABRACADEIRA T18L   
10    NaN      500002994             SACO PLASTICO PRETO 30X35 CM   
11    NaN      500001956    SACO PLASTICO TRANSPARENTE  80X120 CM   
12    NaN         578047                        BOMBONA 20 LITROS   
13    NaN      500001955      SACO PLASTICO TRANSPARENTE 65X75 CM   
14    NaN         559199              WRP DECO BTM - 92MM  LA -YD   
15    NaN          84127           SACO P/ PROD.A GRANEL DIVERSOS   
16    NaN         579138   Frasco J'S Baby Sab Liq Camomila 200ml   
17    NaN         578012           FCO JS SH GOTAS D BRILHO 200ML   
18    NaN         578012           FCO JS SH GOTAS D BRILHO 200ML   
19    NaN          13807                  CX.PAPELAO OND NUMERO 5   
20    NaN         572619              BER SUP PR SOLAR MULTI 2022   

                   CHILD_NM CHILD_TITLE_DESC            text_for_matching_erp  
0   PC-0000603/ PC-0021072               NaN        fco sh blackinho poderoso  
1   PC-0000603/ PC-0021072               NaN                              fco  
2                PC-0005791              NaN             ber solar multi 2022  
3                 PC-045951              NaN                              NaN  
4                RM-0002165              NaN       papel silic glassine 85gsm  
5              MP-BR-002209              NaN                              NaN  
6                RM-0002213              NaN  transparent ifw 14 m² unprinted  
7                RM-0002213              NaN  transparent ifw 14 m² unprinted  
8              MP-BR-002196              NaN                              NaN  
9                PC-0017245              NaN                              NaN  
10               PC-0016081              NaN                              NaN  
11               PC-0016063              NaN                              NaN  
12               PC-0017217              NaN                bombona 20 litros  
13               PC-0016062              NaN                              NaN  
14                PC-050581              NaN               wrp deco btm la yd  
15            MAE-BR-004745              NaN                              NaN  
16    PC-0020114/PC-0000603              NaN                           frasco  
17   PC-0000603/ PC-0020112              NaN                              fco  
18   PC-0000603/ PC-0020112              NaN                    fco sh brilho  
19            MAE-BR-004836              NaN            cx papelao ond numero  
20               PC-0005791              NaN                              NaN  
xmatches_Xref_Request_for_SJC_with_text 2
   source CMPNT_MATL_NUM                          CMPNT_MATL_DESC   
0     NaN         578009       FCO JS SH BLACKINHO PODEROSO 200ML  \
1     NaN         578009       FCO JS SH BLACKINHO PODEROSO 200ML   
2     NaN         572618              BER INF PR SOLAR MULTI 2022   
3     NaN         200143                    SLIPSHEET 1,28 X 1,28   
4     NaN         573605         PAPEL SILIC GLASSINE 85GSM-425MM   
5     NaN          34915                      ADHESIVE HM 3210-02   
6     NaN         573324  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM   
7     NaN         573321  Transparent IFW 14 g/m² 215mm unprinted   
8     NaN         101338                       ADESIVO NW-1042-ZP   
9     NaN         578048                         ABRACADEIRA T18L   
10    NaN      500002994             SACO PLASTICO PRETO 30X35 CM   
11    NaN      500001956    SACO PLASTICO TRANSPARENTE  80X120 CM   
12    NaN         578047                        BOMBONA 20 LITROS   
13    NaN      500001955      SACO PLASTICO TRANSPARENTE 65X75 CM   
14    NaN         559199              WRP DECO BTM - 92MM  LA -YD   
15    NaN          84127           SACO P/ PROD.A GRANEL DIVERSOS   
16    NaN         579138   Frasco J'S Baby Sab Liq Camomila 200ml   
17    NaN         578012           FCO JS SH GOTAS D BRILHO 200ML   
18    NaN         578012           FCO JS SH GOTAS D BRILHO 200ML   
19    NaN          13807                  CX.PAPELAO OND NUMERO 5   
20    NaN         572619              BER SUP PR SOLAR MULTI 2022   

                   CHILD_NM CHILD_TITLE_DESC            text_for_matching_erp   
0   PC-0000603/ PC-0021072               NaN        fco sh blackinho poderoso  \
1   PC-0000603/ PC-0021072               NaN                              fco   
2                PC-0005791              NaN             ber solar multi 2022   
3                 PC-045951              NaN                              NaN   
4                RM-0002165              NaN       papel silic glassine 85gsm   
5              MP-BR-002209              NaN                              NaN   
6                RM-0002213              NaN  transparent ifw 14 m² unprinted   
7                RM-0002213              NaN  transparent ifw 14 m² unprinted   
8              MP-BR-002196              NaN                              NaN   
9                PC-0017245              NaN                              NaN   
10               PC-0016081              NaN                              NaN   
11               PC-0016063              NaN                              NaN   
12               PC-0017217              NaN                bombona 20 litros   
13               PC-0016062              NaN                              NaN   
14                PC-050581              NaN               wrp deco btm la yd   
15            MAE-BR-004745              NaN                              NaN   
16    PC-0020114/PC-0000603              NaN                           frasco   
17   PC-0000603/ PC-0020112              NaN                              fco   
18   PC-0000603/ PC-0020112              NaN                    fco sh brilho   
19            MAE-BR-004836              NaN            cx papelao ond numero   
20               PC-0005791              NaN                              NaN   

                                text_for_matching_tru  
0                                                 NaN  
1                                                 NaN  
2                                cartucho promocional  
3                                           slipsheet  
4                                                 NaN  
5                                                 NaN  
6                                 pouch gsm unprinted  
7                                 pouch gsm unprinted  
8                                                 NaN  
9                                                 NaN  
10                                                NaN  
11                                                NaN  
12                                                NaN  
13                                                NaN  
14                                                NaN  
15                           saco para produto granel  
16                                                NaN  
17                                                NaN  
18                                                NaN  
19  shipper corrugado caixa de papelao ondulado nº...  
20                               cartucho promocional  
xmatches_Xref_Request_for_SJC_with_text 2
   CMPNT_MATL_NUM                 CHILD_NM            text_for_matching_erp   
0          578009  PC-0000603/ PC-0021072         fco sh blackinho poderoso  \
1          578009  PC-0000603/ PC-0021072                               fco   
2          572618               PC-0005791             ber solar multi 2022   
3          200143                PC-045951                              NaN   
4          573605               RM-0002165       papel silic glassine 85gsm   
5           34915             MP-BR-002209                              NaN   
6          573324               RM-0002213  transparent ifw 14 m² unprinted   
7          573321               RM-0002213  transparent ifw 14 m² unprinted   
8          101338             MP-BR-002196                              NaN   
9          578048               PC-0017245                              NaN   
10      500002994               PC-0016081                              NaN   
11      500001956               PC-0016063                              NaN   
12         578047               PC-0017217                bombona 20 litros   
13      500001955               PC-0016062                              NaN   
14         559199                PC-050581               wrp deco btm la yd   
15          84127            MAE-BR-004745                              NaN   
16         579138    PC-0020114/PC-0000603                           frasco   
17         578012   PC-0000603/ PC-0020112                              fco   
18         578012   PC-0000603/ PC-0020112                    fco sh brilho   
19          13807            MAE-BR-004836            cx papelao ond numero   
20         572619               PC-0005791                              NaN   

                                text_for_matching_tru  
0                                                 NaN  
1                                                 NaN  
2                                cartucho promocional  
3                                           slipsheet  
4                                                 NaN  
5                                                 NaN  
6                                 pouch gsm unprinted  
7                                 pouch gsm unprinted  
8                                                 NaN  
9                                                 NaN  
10                                                NaN  
11                                                NaN  
12                                                NaN  
13                                                NaN  
14                                                NaN  
15                           saco para produto granel  
16                                                NaN  
17                                                NaN  
18                                                NaN  
19  shipper corrugado caixa de papelao ondulado nº...  
20                               cartucho promocional  

=== MATCH ROUND 11: Xref_Request_for_SJC suggested X-match ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in Xref_Request_for_SJC suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in Xref_Request_for_SJC suggested X-match
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in Xref_Request_for_SJC suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
11: Xref_Request_for_SJC suggested X-match round matched: 28 (0.38 seconds)
df_erp_to_match cases:  138331
df_tru_to_match cases:  117407
Amount of current matches:  28
   SRC_SYS_CD            MATL_NUM   MATL_NUM_original   
0         CLA  000000000000558786  000000000000558786  \
1         CLA  000000000000558786  000000000000558786   
2         CLA  000000000000583195  000000000000583195   
3         CLA  000000000000583195  000000000000583195   
4         CLA  000000000000583196  000000000000583196   
5         CLA  000000000000583196  000000000000583196   
6         CLA  000000000000556277  000000000000556277   
7         CLA  000000000000556277  000000000000556277   
8         CLA  000000000000580634  000000000000580634   
9         CLA  000000000000580634  000000000000580634   
10        CLA  000000000000556044  000000000000556044   
11        CLA  000000000000556044  000000000000556044   
12        CLA  000000000000576414  000000000000576414   
13        CLA  000000000000576414  000000000000576414   
14        CLA  000000000000556284  000000000000556284   
15        CLA  000000000000556284  000000000000556284   
16        CLA  000000000000576564  000000000000576564   
17        CLA  000000000000576564  000000000000576564   
18        CLA  000000000000576415  000000000000576415   
19        CLA  000000000000576415  000000000000576415   
20        CLA  000000000000576558  000000000000576558   
21        CLA  000000000000576558  000000000000576558   
22        CLA  000000000000583199  000000000000583199   
23        CLA  000000000000583199  000000000000583199   
24        CLA  000000000000570431  000000000000570431   
25        CLA  000000000000570431  000000000000570431   
26        CLA  000000000000583201  000000000000583201   
27        CLA  000000000000583201  000000000000583201   

                              MATL_SHRT_DESC PLNT_CD CMPNT_MATL_TYPE_CD   
0      ABS SF ADAPT PLUS NYD SUAVE ALAS 24X8    BR12                ROH  \
1      ABS SF ADAPT PLUS NYD SUAVE ALAS 24X8    BR12                ROH   
2    ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN    BR12                ROH   
3    ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN    BR12                ROH   
4      ABS EXT SL CONF NOTURNO SV ABA 24X8UN    BR12                ROH   
5      ABS EXT SL CONF NOTURNO SV ABA 24X8UN    BR12                ROH   
6       ABS EXT SL AP NOT&DIA SV ABA 12X16UN    BR12                ROH   
7       ABS EXT SL AP NOT&DIA SV ABA 12X16UN    BR12                ROH   
8        SL CONF NOTURNO SECA ALAS 12X16 EXP    BR12                ROH   
9        SL CONF NOTURNO SECA ALAS 12X16 EXP    BR12                ROH   
10    ABS EXT SL AP NOT&DIA SS C/ABA 12X32UN    BR12                ROH   
11    ABS EXT SL AP NOT&DIA SS C/ABA 12X32UN    BR12                ROH   
12   ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN    BR12                ROH   
13   ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN    BR12                ROH   
14     ABS EXT SL AP NOT&DIA SS C/ABA 24X8UN    BR12                ROH   
15     ABS EXT SL AP NOT&DIA SS C/ABA 24X8UN    BR12                ROH   
16         SL CONF NOTURNO SUAVE ALAS 24X8UN    BR12                ROH   
17         SL CONF NOTURNO SUAVE ALAS 24X8UN    BR12                ROH   
18     ABS EXT SL CONF NOTURNO SV ABA 24X8UN    BR12                ROH   
19     ABS EXT SL CONF NOTURNO SV ABA 24X8UN    BR12                ROH   
20  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN    BR12                ROH   
21  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN    BR12                ROH   
22  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN    BR12                ROH   
23  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN    BR12                ROH   
24       ABS EXT SL AP NOT&DIA SV ABA 24X8UN    BR12                ROH   
25       ABS EXT SL AP NOT&DIA SV ABA 24X8UN    BR12                ROH   
26         SL CONF NOTURNO SUAVE ALAS 24X8UN    BR12                ROH   
27         SL CONF NOTURNO SUAVE ALAS 24X8UN    BR12                ROH   

   CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
0          573324      000000000000573324  \
1          573321      000000000000573321   
2          573324      000000000000573324   
3          573321      000000000000573321   
4          573324      000000000000573324   
5          573321      000000000000573321   
6          573324      000000000000573324   
7          573321      000000000000573321   
8          573324      000000000000573324   
9          573321      000000000000573321   
10         573324      000000000000573324   
11         573321      000000000000573321   
12         573324      000000000000573324   
13         573321      000000000000573321   
14         573324      000000000000573324   
15         573321      000000000000573321   
16         573324      000000000000573324   
17         573321      000000000000573321   
18         573324      000000000000573324   
19         573321      000000000000573321   
20         573324      000000000000573324   
21         573321      000000000000573321   
22         573324      000000000000573324   
23         573321      000000000000573321   
24         573324      000000000000573324   
25         573321      000000000000573321   
26         573324      000000000000573324   
27         573321      000000000000573321   

                            CMPNT_MATL_DESC            text_for_matching_erp   
0   TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted  \
1   Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
2   TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
3   Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
4   TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
5   Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
6   TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
7   Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
8   TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
9   Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
10  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
11  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
12  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
13  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
14  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
15  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
16  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
17  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
18  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
19  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
20  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
21  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
22  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
23  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
24  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
25  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   
26  TRANSPARENT IFW 14 G/M² UNPRINTED 215MM  transparent ifw 14 m² unprinted   
27  Transparent IFW 14 g/m² 215mm unprinted  transparent ifw 14 m² unprinted   

   extracted_rm_erp  perc_alpha_char_erp                             key_erp   
0               NaN             0.888889  000000000000558786_573324_BR12_CLA  \
1               NaN             0.888889  000000000000558786_573321_BR12_CLA   
2               NaN             0.888889  000000000000583195_573324_BR12_CLA   
3               NaN             0.888889  000000000000583195_573321_BR12_CLA   
4               NaN             0.888889  000000000000583196_573324_BR12_CLA   
5               NaN             0.888889  000000000000583196_573321_BR12_CLA   
6               NaN             0.888889  000000000000556277_573324_BR12_CLA   
7               NaN             0.888889  000000000000556277_573321_BR12_CLA   
8               NaN             0.888889  000000000000580634_573324_BR12_CLA   
9               NaN             0.888889  000000000000580634_573321_BR12_CLA   
10              NaN             0.888889  000000000000556044_573324_BR12_CLA   
11              NaN             0.888889  000000000000556044_573321_BR12_CLA   
12              NaN             0.888889  000000000000576414_573324_BR12_CLA   
13              NaN             0.888889  000000000000576414_573321_BR12_CLA   
14              NaN             0.888889  000000000000556284_573324_BR12_CLA   
15              NaN             0.888889  000000000000556284_573321_BR12_CLA   
16              NaN             0.888889  000000000000576564_573324_BR12_CLA   
17              NaN             0.888889  000000000000576564_573321_BR12_CLA   
18              NaN             0.888889  000000000000576415_573324_BR12_CLA   
19              NaN             0.888889  000000000000576415_573321_BR12_CLA   
20              NaN             0.888889  000000000000576558_573324_BR12_CLA   
21              NaN             0.888889  000000000000576558_573321_BR12_CLA   
22              NaN             0.888889  000000000000583199_573324_BR12_CLA   
23              NaN             0.888889  000000000000583199_573321_BR12_CLA   
24              NaN             0.888889  000000000000570431_573324_BR12_CLA   
25              NaN             0.888889  000000000000570431_573321_BR12_CLA   
26              NaN             0.888889  000000000000583201_573324_BR12_CLA   
27              NaN             0.888889  000000000000583201_573321_BR12_CLA   

      CHILD_NM RGN_CD             mat_num MATL_NUM_original_tru_ref   
0   RM-0002213  LATAM  000000000000558786        000000000000558786  \
1   RM-0002213  LATAM  000000000000558786        000000000000558786   
2   RM-0002213  LATAM  000000000000583195        000000000000583195   
3   RM-0002213  LATAM  000000000000583195        000000000000583195   
4   RM-0002213  LATAM  000000000000583196        000000000000583196   
5   RM-0002213  LATAM  000000000000583196        000000000000583196   
6   RM-0002213  LATAM  000000000000556277        000000000000556277   
7   RM-0002213  LATAM  000000000000556277        000000000000556277   
8   RM-0002213  LATAM  000000000000580634        000000000000580634   
9   RM-0002213  LATAM  000000000000580634        000000000000580634   
10  RM-0002213  LATAM  000000000000556044        000000000000556044   
11  RM-0002213  LATAM  000000000000556044        000000000000556044   
12  RM-0002213  LATAM  000000000000576414        000000000000576414   
13  RM-0002213  LATAM  000000000000576414        000000000000576414   
14  RM-0002213  LATAM  000000000000556284        000000000000556284   
15  RM-0002213  LATAM  000000000000556284        000000000000556284   
16  RM-0002213  LATAM  000000000000576564        000000000000576564   
17  RM-0002213  LATAM  000000000000576564        000000000000576564   
18  RM-0002213  LATAM  000000000000576415        000000000000576415   
19  RM-0002213  LATAM  000000000000576415        000000000000576415   
20  RM-0002213  LATAM  000000000000576558        000000000000576558   
21  RM-0002213  LATAM  000000000000576558        000000000000576558   
22  RM-0002213  LATAM  000000000000583199        000000000000583199   
23  RM-0002213  LATAM  000000000000583199        000000000000583199   
24  RM-0002213  LATAM  000000000000570431        000000000000570431   
25  RM-0002213  LATAM  000000000000570431        000000000000570431   
26  RM-0002213  LATAM  000000000000583201        000000000000583201   
27  RM-0002213  LATAM  000000000000583201        000000000000583201   

        mat_num_padded    mat_num_original       FG_NM   
0   000000000000558786  000000000000558786  FG-0019768  \
1   000000000000558786  000000000000558786  FG-0019768   
2   000000000000583195  000000000000583195  FG-0059738   
3   000000000000583195  000000000000583195  FG-0059738   
4   000000000000583196  000000000000583196  FG-0059749   
5   000000000000583196  000000000000583196  FG-0059749   
6   000000000000556277  000000000000556277  FG-0017777   
7   000000000000556277  000000000000556277  FG-0017777   
8   000000000000580634  000000000000580634  FG-0056262   
9   000000000000580634  000000000000580634  FG-0056262   
10  000000000000556044  000000000000556044  FG-0017779   
11  000000000000556044  000000000000556044  FG-0017779   
12  000000000000576414  000000000000576414  FG-0041754   
13  000000000000576414  000000000000576414  FG-0041754   
14  000000000000556284  000000000000556284  FG-0017776   
15  000000000000556284  000000000000556284  FG-0017776   
16  000000000000576564  000000000000576564  FG-0042176   
17  000000000000576564  000000000000576564  FG-0042176   
18  000000000000576415  000000000000576415  FG-0041758   
19  000000000000576415  000000000000576415  FG-0041758   
20  000000000000576558  000000000000576558  FG-0041757   
21  000000000000576558  000000000000576558  FG-0041757   
22  000000000000583199  000000000000583199  FG-0059701   
23  000000000000583199  000000000000583199  FG-0059701   
24  000000000000570431  000000000000570431  FG-0023546   
25  000000000000570431  000000000000570431  FG-0023546   
26  000000000000583201  000000000000583201  FG-0059621   
27  000000000000583201  000000000000583201  FG-0059621   

                                           FG_SPEC_NM       FD_NM   
0   558786 - Absorvente Higiênico Stayfree Adapt P...  FD-0003101  \
1   558786 - Absorvente Higiênico Stayfree Adapt P...  FD-0003101   
2    583195 - ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN  FD-0003110   
3    583195 - ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN  FD-0003110   
4          583196 - ABS EXT SL AP NOITE SV ABA 24X8UN  FD-0003101   
5          583196 - ABS EXT SL AP NOITE SV ABA 24X8UN  FD-0003101   
6       556277 - ABS EXT SL AP NOT&DIA SV ABA 12X16UN  FD-0003101   
7       556277 - ABS EXT SL AP NOT&DIA SV ABA 12X16UN  FD-0003101   
8        580634 - SL CONF NOTURNO SECA ALAS 12x16 EXP  FD-0003110   
9        580634 - SL CONF NOTURNO SECA ALAS 12x16 EXP  FD-0003110   
10     556044- ABS EXT SL AP NOT&DIA SS C/ABA 12X32UN  FD-0003110   
11     556044- ABS EXT SL AP NOT&DIA SS C/ABA 12X32UN  FD-0003110   
12   576414 - ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN  FD-0003110   
13   576414 - ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN  FD-0003110   
14    556284 -  ABS EXT SL AP NOT&DIA SS C/ABA 24X8UN  FD-0003110   
15    556284 -  ABS EXT SL AP NOT&DIA SS C/ABA 24X8UN  FD-0003110   
16         576564 - SIEMPRE LIBRE NOCHE X8 SUAVE ALAS  FD-0003101   
17         576564 - SIEMPRE LIBRE NOCHE X8 SUAVE ALAS  FD-0003101   
18  576415, Absorbent External Stayfree Adapt Smoo...  FD-0003101   
19  576415, Absorbent External Stayfree Adapt Smoo...  FD-0003101   
20  576558 - ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN  FD-0003110   
21  576558 - ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN  FD-0003110   
22  583199 - ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN  FD-0003110   
23  583199 - ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN  FD-0003110   
24   570431 -  SC ABS EXT SL AP NOT&DIA SV ABA 24X8UN  FD-0003101   
25   570431 -  SC ABS EXT SL AP NOT&DIA SV ABA 24X8UN  FD-0003101   
26         583201 - SIEMPRE LIBRE NOCHE X8 SUAVE ALAS  FD-0003101   
27         583201 - SIEMPRE LIBRE NOCHE X8 SUAVE ALAS  FD-0003101   

   CHILD_NM_original       CHILD_TITLE_DESC spec_type_inferred TEMPL_TYPE_CD   
0         RM-0002213  Pouch 14gsm unprinted                 RM          None  \
1         RM-0002213  Pouch 14gsm unprinted                 RM          None   
2         RM-0002213  Pouch 14gsm unprinted                 RM          None   
3         RM-0002213  Pouch 14gsm unprinted                 RM          None   
4         RM-0002213  Pouch 14gsm unprinted                 RM          None   
5         RM-0002213  Pouch 14gsm unprinted                 RM          None   
6         RM-0002213  Pouch 14gsm unprinted                 RM          None   
7         RM-0002213  Pouch 14gsm unprinted                 RM          None   
8         RM-0002213  Pouch 14gsm unprinted                 RM          None   
9         RM-0002213  Pouch 14gsm unprinted                 RM          None   
10        RM-0002213  Pouch 14gsm unprinted                 RM          None   
11        RM-0002213  Pouch 14gsm unprinted                 RM          None   
12        RM-0002213  Pouch 14gsm unprinted                 RM          None   
13        RM-0002213  Pouch 14gsm unprinted                 RM          None   
14        RM-0002213  Pouch 14gsm unprinted                 RM          None   
15        RM-0002213  Pouch 14gsm unprinted                 RM          None   
16        RM-0002213  Pouch 14gsm unprinted                 RM          None   
17        RM-0002213  Pouch 14gsm unprinted                 RM          None   
18        RM-0002213  Pouch 14gsm unprinted                 RM          None   
19        RM-0002213  Pouch 14gsm unprinted                 RM          None   
20        RM-0002213  Pouch 14gsm unprinted                 RM          None   
21        RM-0002213  Pouch 14gsm unprinted                 RM          None   
22        RM-0002213  Pouch 14gsm unprinted                 RM          None   
23        RM-0002213  Pouch 14gsm unprinted                 RM          None   
24        RM-0002213  Pouch 14gsm unprinted                 RM          None   
25        RM-0002213  Pouch 14gsm unprinted                 RM          None   
26        RM-0002213  Pouch 14gsm unprinted                 RM          None   
27        RM-0002213  Pouch 14gsm unprinted                 RM          None   

   CHILD_TYPE_CD                                  ERP_DESC   
0     INGREDIENT     ABS SF ADAPT PLUS NYD SUAVE ALAS 24X8  \
1     INGREDIENT     ABS SF ADAPT PLUS NYD SUAVE ALAS 24X8   
2     INGREDIENT   ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN   
3     INGREDIENT   ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN   
4     INGREDIENT     ABS EXT SL CONF NOTURNO SV ABA 24X8UN   
5     INGREDIENT     ABS EXT SL CONF NOTURNO SV ABA 24X8UN   
6     INGREDIENT      ABS EXT SL AP NOT&DIA SV ABA 12X16UN   
7     INGREDIENT      ABS EXT SL AP NOT&DIA SV ABA 12X16UN   
8     INGREDIENT       SL CONF NOTURNO SECA ALAS 12X16 EXP   
9     INGREDIENT       SL CONF NOTURNO SECA ALAS 12X16 EXP   
10    INGREDIENT    ABS EXT SL AP NOT&DIA SS C/ABA 12X32UN   
11    INGREDIENT    ABS EXT SL AP NOT&DIA SS C/ABA 12X32UN   
12    INGREDIENT   ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN   
13    INGREDIENT   ABS EXT SL CONF NOTURNO SS C/ABA 24X8UN   
14    INGREDIENT     ABS EXT SL AP NOT&DIA SS C/ABA 24X8UN   
15    INGREDIENT     ABS EXT SL AP NOT&DIA SS C/ABA 24X8UN   
16    INGREDIENT         SL CONF NOTURNO SUAVE ALAS 24X8UN   
17    INGREDIENT         SL CONF NOTURNO SUAVE ALAS 24X8UN   
18    INGREDIENT     ABS EXT SL CONF NOTURNO SV ABA 24X8UN   
19    INGREDIENT     ABS EXT SL CONF NOTURNO SV ABA 24X8UN   
20    INGREDIENT  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN   
21    INGREDIENT  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN   
22    INGREDIENT  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN   
23    INGREDIENT  ABS EXT SL CONF NOTURNO SS C/ABA 12X32UN   
24    INGREDIENT       ABS EXT SL AP NOT&DIA SV ABA 24X8UN   
25    INGREDIENT       ABS EXT SL AP NOT&DIA SV ABA 24X8UN   
26    INGREDIENT         SL CONF NOTURNO SUAVE ALAS 24X8UN   
27    INGREDIENT         SL CONF NOTURNO SUAVE ALAS 24X8UN   

   text_for_matching_tru                  text_for_matching_tru_trade_names   
0    pouch gsm unprinted                                                     \
1    pouch gsm unprinted                                                      
2    pouch gsm unprinted                                                      
3    pouch gsm unprinted                                                      
4    pouch gsm unprinted                                                      
5    pouch gsm unprinted                                                      
6    pouch gsm unprinted                                                      
7    pouch gsm unprinted                                                      
8    pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
9    pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
10   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
11   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
12   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
13   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
14   pouch gsm unprinted                                                      
15   pouch gsm unprinted                                                      
16   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
17   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
18   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
19   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
20   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
21   pouch gsm unprinted  fil 14 14gsm pouch pe downgage gsm transp tran...   
22   pouch gsm unprinted                                                      
23   pouch gsm unprinted                                                      
24   pouch gsm unprinted                                                      
25   pouch gsm unprinted                                                      
26   pouch gsm unprinted                                                      
27   pouch gsm unprinted                                                      

   extracted_rm_tru  perc_alpha_char_tru   
0         rm0002213                  1.0  \
1         rm0002213                  1.0   
2         rm0002213                  1.0   
3         rm0002213                  1.0   
4         rm0002213                  1.0   
5         rm0002213                  1.0   
6         rm0002213                  1.0   
7         rm0002213                  1.0   
8         rm0002213                  1.0   
9         rm0002213                  1.0   
10        rm0002213                  1.0   
11        rm0002213                  1.0   
12        rm0002213                  1.0   
13        rm0002213                  1.0   
14        rm0002213                  1.0   
15        rm0002213                  1.0   
16        rm0002213                  1.0   
17        rm0002213                  1.0   
18        rm0002213                  1.0   
19        rm0002213                  1.0   
20        rm0002213                  1.0   
21        rm0002213                  1.0   
22        rm0002213                  1.0   
23        rm0002213                  1.0   
24        rm0002213                  1.0   
25        rm0002213                  1.0   
26        rm0002213                  1.0   
27        rm0002213                  1.0   

                                   key_tru   
0   000000000000558786_RM-0002213_BR12_CLA  \
1   000000000000558786_RM-0002213_BR12_CLA   
2   000000000000583195_RM-0002213_BR12_CLA   
3   000000000000583195_RM-0002213_BR12_CLA   
4   000000000000583196_RM-0002213_BR12_CLA   
5   000000000000583196_RM-0002213_BR12_CLA   
6   000000000000556277_RM-0002213_BR12_CLA   
7   000000000000556277_RM-0002213_BR12_CLA   
8   000000000000580634_RM-0002213_BR12_CLA   
9   000000000000580634_RM-0002213_BR12_CLA   
10  000000000000556044_RM-0002213_BR12_CLA   
11  000000000000556044_RM-0002213_BR12_CLA   
12  000000000000576414_RM-0002213_BR12_CLA   
13  000000000000576414_RM-0002213_BR12_CLA   
14  000000000000556284_RM-0002213_BR12_CLA   
15  000000000000556284_RM-0002213_BR12_CLA   
16  000000000000576564_RM-0002213_BR12_CLA   
17  000000000000576564_RM-0002213_BR12_CLA   
18  000000000000576415_RM-0002213_BR12_CLA   
19  000000000000576415_RM-0002213_BR12_CLA   
20  000000000000576558_RM-0002213_BR12_CLA   
21  000000000000576558_RM-0002213_BR12_CLA   
22  000000000000583199_RM-0002213_BR12_CLA   
23  000000000000583199_RM-0002213_BR12_CLA   
24  000000000000570431_RM-0002213_BR12_CLA   
25  000000000000570431_RM-0002213_BR12_CLA   
26  000000000000583201_RM-0002213_BR12_CLA   
27  000000000000583201_RM-0002213_BR12_CLA   

                            SPEC_FLOW_CD   
0   FG-0019768 > FD-0003101 > RM-0002213  \
1   FG-0019768 > FD-0003101 > RM-0002213   
2   FG-0059738 > FD-0003110 > RM-0002213   
3   FG-0059738 > FD-0003110 > RM-0002213   
4   FG-0059749 > FD-0003101 > RM-0002213   
5   FG-0059749 > FD-0003101 > RM-0002213   
6   FG-0017777 > FD-0003101 > RM-0002213   
7   FG-0017777 > FD-0003101 > RM-0002213   
8   FG-0056262 > FD-0003110 > RM-0002213   
9   FG-0056262 > FD-0003110 > RM-0002213   
10  FG-0017779 > FD-0003110 > RM-0002213   
11  FG-0017779 > FD-0003110 > RM-0002213   
12  FG-0041754 > FD-0003110 > RM-0002213   
13  FG-0041754 > FD-0003110 > RM-0002213   
14  FG-0017776 > FD-0003110 > RM-0002213   
15  FG-0017776 > FD-0003110 > RM-0002213   
16  FG-0042176 > FD-0003101 > RM-0002213   
17  FG-0042176 > FD-0003101 > RM-0002213   
18  FG-0041758 > FD-0003101 > RM-0002213   
19  FG-0041758 > FD-0003101 > RM-0002213   
20  FG-0041757 > FD-0003110 > RM-0002213   
21  FG-0041757 > FD-0003110 > RM-0002213   
22  FG-0059701 > FD-0003110 > RM-0002213   
23  FG-0059701 > FD-0003110 > RM-0002213   
24  FG-0023546 > FD-0003101 > RM-0002213   
25  FG-0023546 > FD-0003101 > RM-0002213   
26  FG-0059621 > FD-0003101 > RM-0002213   
27  FG-0059621 > FD-0003101 > RM-0002213   

                                        TRD_NM_CONCAT   
0                                                 NaN  \
1                                                 NaN   
2                                                 NaN   
3                                                 NaN   
4                                                 NaN   
5                                                 NaN   
6                                                 NaN   
7                                                 NaN   
8   fil pe transp 14gsm||pouch downgage transparen...   
9   fil pe transp 14gsm||pouch downgage transparen...   
10  fil pe transp 14gsm||pouch downgage transparen...   
11  fil pe transp 14gsm||pouch downgage transparen...   
12  fil pe transp 14gsm||pouch downgage transparen...   
13  fil pe transp 14gsm||pouch downgage transparen...   
14                                                NaN   
15                                                NaN   
16  pouch downgage transparente 14 gsm||fil pe tra...   
17  pouch downgage transparente 14 gsm||fil pe tra...   
18  pouch downgage transparente 14 gsm||fil pe tra...   
19  pouch downgage transparente 14 gsm||fil pe tra...   
20  pouch downgage transparente 14 gsm||fil pe tra...   
21  pouch downgage transparente 14 gsm||fil pe tra...   
22                                                NaN   
23                                                NaN   
24                                                NaN   
25                                                NaN   
26                                                NaN   
27                                                NaN   

                                          TRD_NM_FULL  matching_score   
0                                                 NaN               1  \
1                                                 NaN               1   
2                                                 NaN               1   
3                                                 NaN               1   
4                                                 NaN               1   
5                                                 NaN               1   
6                                                 NaN               1   
7                                                 NaN               1   
8   fil 14 14gsm pouch pe downgage gsm transp tran...               1   
9   fil 14 14gsm pouch pe downgage gsm transp tran...               1   
10  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
11  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
12  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
13  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
14                                                NaN               1   
15                                                NaN               1   
16  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
17  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
18  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
19  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
20  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
21  fil 14 14gsm pouch pe downgage gsm transp tran...               1   
22                                                NaN               1   
23                                                NaN               1   
24                                                NaN               1   
25                                                NaN               1   
26                                                NaN               1   
27                                                NaN               1   

      unified_mat_code  is_matched                         Matching Reason   
0   000000000000558786        True  Xref_Request_for_SJC suggested X-match  \
1   000000000000558786        True  Xref_Request_for_SJC suggested X-match   
2   000000000000583195        True  Xref_Request_for_SJC suggested X-match   
3   000000000000583195        True  Xref_Request_for_SJC suggested X-match   
4   000000000000583196        True  Xref_Request_for_SJC suggested X-match   
5   000000000000583196        True  Xref_Request_for_SJC suggested X-match   
6   000000000000556277        True  Xref_Request_for_SJC suggested X-match   
7   000000000000556277        True  Xref_Request_for_SJC suggested X-match   
8   000000000000580634        True  Xref_Request_for_SJC suggested X-match   
9   000000000000580634        True  Xref_Request_for_SJC suggested X-match   
10  000000000000556044        True  Xref_Request_for_SJC suggested X-match   
11  000000000000556044        True  Xref_Request_for_SJC suggested X-match   
12  000000000000576414        True  Xref_Request_for_SJC suggested X-match   
13  000000000000576414        True  Xref_Request_for_SJC suggested X-match   
14  000000000000556284        True  Xref_Request_for_SJC suggested X-match   
15  000000000000556284        True  Xref_Request_for_SJC suggested X-match   
16  000000000000576564        True  Xref_Request_for_SJC suggested X-match   
17  000000000000576564        True  Xref_Request_for_SJC suggested X-match   
18  000000000000576415        True  Xref_Request_for_SJC suggested X-match   
19  000000000000576415        True  Xref_Request_for_SJC suggested X-match   
20  000000000000576558        True  Xref_Request_for_SJC suggested X-match   
21  000000000000576558        True  Xref_Request_for_SJC suggested X-match   
22  000000000000583199        True  Xref_Request_for_SJC suggested X-match   
23  000000000000583199        True  Xref_Request_for_SJC suggested X-match   
24  000000000000570431        True  Xref_Request_for_SJC suggested X-match   
25  000000000000570431        True  Xref_Request_for_SJC suggested X-match   
26  000000000000583201        True  Xref_Request_for_SJC suggested X-match   
27  000000000000583201        True  Xref_Request_for_SJC suggested X-match   

   confidence                                 match_round  
0        high  11: Xref_Request_for_SJC suggested X-match  
1        high  11: Xref_Request_for_SJC suggested X-match  
2        high  11: Xref_Request_for_SJC suggested X-match  
3        high  11: Xref_Request_for_SJC suggested X-match  
4        high  11: Xref_Request_for_SJC suggested X-match  
5        high  11: Xref_Request_for_SJC suggested X-match  
6        high  11: Xref_Request_for_SJC suggested X-match  
7        high  11: Xref_Request_for_SJC suggested X-match  
8        high  11: Xref_Request_for_SJC suggested X-match  
9        high  11: Xref_Request_for_SJC suggested X-match  
10       high  11: Xref_Request_for_SJC suggested X-match  
11       high  11: Xref_Request_for_SJC suggested X-match  
12       high  11: Xref_Request_for_SJC suggested X-match  
13       high  11: Xref_Request_for_SJC suggested X-match  
14       high  11: Xref_Request_for_SJC suggested X-match  
15       high  11: Xref_Request_for_SJC suggested X-match  
16       high  11: Xref_Request_for_SJC suggested X-match  
17       high  11: Xref_Request_for_SJC suggested X-match  
18       high  11: Xref_Request_for_SJC suggested X-match  
19       high  11: Xref_Request_for_SJC suggested X-match  
20       high  11: Xref_Request_for_SJC suggested X-match  
21       high  11: Xref_Request_for_SJC suggested X-match  
22       high  11: Xref_Request_for_SJC suggested X-match  
23       high  11: Xref_Request_for_SJC suggested X-match  
24       high  11: Xref_Request_for_SJC suggested X-match  
25       high  11: Xref_Request_for_SJC suggested X-match  
26       high  11: Xref_Request_for_SJC suggested X-match  
27       high  11: Xref_Request_for_SJC suggested X-match  
------------------------------------------------------------
reading xmatches_EPR_priority_confidence file from folder 
   source CMPNT_MATL_NUM                           CMPNT_MATL_DESC   
0     NaN       30042436        SHPR LBL SUDAFED SINUS 24HR TAB 10  \
1     NaN       30042433             CTN SUDAFED SINUS 24HR TAB 10   
2     NaN       30040223              SHPR MOTRIN IB LIQ GELS 80CT   
3     NaN       30040224              SHPR MOTRIN IB LIQ GELS 20CT   
4     NaN         555255              Bot Sh Js Baby Clásico 200ml   
5     NaN         555378           Bot Sh Js Baby Manzanilla 200ml   
6     NaN         183149  20.sco sin Impresión Aceite x200 ml(DAK)   
7     NaN            NaN                                       NaN   
8     NaN            NaN                                       NaN   
9     NaN            NaN                                       NaN   
10    NaN            NaN                                       NaN   
11    NaN            NaN                                       NaN   
12    NaN            NaN                                       NaN   
13    NaN            NaN                                       NaN   
14    NaN            NaN                                       NaN   
15    NaN            NaN                                       NaN   
16    NaN            NaN                                       NaN   
17    NaN            NaN                                       NaN   
18    NaN            NaN                                       NaN   

      CHILD_NM                                   CHILD_TITLE_DESC  
0     30042436  Miscellaneous Printed, SUDAFED, TABLET, Shippe...  
1     30042433         Carton, SUDAFED, TABLET, Sudafed 24HR 10ct  
2     30040223                Shipper, MOTRIN IB, CAPSULES, 80 ct  
3     30040224                Shipper, MOTRIN IB, CAPSULES, 20 ct  
4    PC-052719          Frasco PET Shampoo y Acondicionador 200ml  
5    PC-052719          Frasco PET Shampoo y Acondicionador 200ml  
6   PC-0014245       Bottle/Frascos Aceite Johnsons Baby x 200 ml  
7          NaN                                                NaN  
8          NaN                                                NaN  
9          NaN                                                NaN  
10         NaN                                                NaN  
11         NaN                                                NaN  
12         NaN                                                NaN  
13         NaN                                                NaN  
14         NaN                                                NaN  
15         NaN                                                NaN  
16         NaN                                                NaN  
17         NaN                                                NaN  
18         NaN                                                NaN  
mapping using ERP PART ID
   source CMPNT_MATL_NUM                           CMPNT_MATL_DESC   
0     NaN       30042436        SHPR LBL SUDAFED SINUS 24HR TAB 10  \
1     NaN       30042433             CTN SUDAFED SINUS 24HR TAB 10   
2     NaN       30040223              SHPR MOTRIN IB LIQ GELS 80CT   
3     NaN       30040223              SHPR MOTRIN IB LIQ GELS 80CT   
4     NaN       30040224              SHPR MOTRIN IB LIQ GELS 20CT   
5     NaN       30040224              SHPR MOTRIN IB LIQ GELS 20CT   
6     NaN         555255              Bot Sh Js Baby Clásico 200ml   
7     NaN         555378           Bot Sh Js Baby Manzanilla 200ml   
8     NaN         183149  20.sco sin Impresión Aceite x200 ml(DAK)   
9     NaN         183149  20.sco sin Impresión Aceite x200 ml(DAK)   
10    NaN            NaN                                       NaN   
11    NaN            NaN                                       NaN   
12    NaN            NaN                                       NaN   
13    NaN            NaN                                       NaN   
14    NaN            NaN                                       NaN   
15    NaN            NaN                                       NaN   
16    NaN            NaN                                       NaN   
17    NaN            NaN                                       NaN   
18    NaN            NaN                                       NaN   
19    NaN            NaN                                       NaN   
20    NaN            NaN                                       NaN   
21    NaN            NaN                                       NaN   

      CHILD_NM                                   CHILD_TITLE_DESC   
0     30042436  Miscellaneous Printed, SUDAFED, TABLET, Shippe...  \
1     30042433         Carton, SUDAFED, TABLET, Sudafed 24HR 10ct   
2     30040223                Shipper, MOTRIN IB, CAPSULES, 80 ct   
3     30040223                Shipper, MOTRIN IB, CAPSULES, 80 ct   
4     30040224                Shipper, MOTRIN IB, CAPSULES, 20 ct   
5     30040224                Shipper, MOTRIN IB, CAPSULES, 20 ct   
6    PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
7    PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
8   PC-0014245       Bottle/Frascos Aceite Johnsons Baby x 200 ml   
9   PC-0014245       Bottle/Frascos Aceite Johnsons Baby x 200 ml   
10         NaN                                                NaN   
11         NaN                                                NaN   
12         NaN                                                NaN   
13         NaN                                                NaN   
14         NaN                                                NaN   
15         NaN                                                NaN   
16         NaN                                                NaN   
17         NaN                                                NaN   
18         NaN                                                NaN   
19         NaN                                                NaN   
20         NaN                                                NaN   
21         NaN                                                NaN   

           text_for_matching_erp  
0                            NaN  
1                            NaN  
2                  shpr liq 80ct  
3            motrin 80ct shipper  
4                  shpr liq 20ct  
5            motrin 20ct shipper  
6            bot sh baby clásico  
7                    bot sh baby  
8          sco sin impresión dak  
9   sco sin impresión aceite dak  
10                           NaN  
11                           NaN  
12                           NaN  
13                           NaN  
14                           NaN  
15                           NaN  
16                           NaN  
17                           NaN  
18                           NaN  
19                           NaN  
20                           NaN  
21                           NaN  
mapping using TRU_SPEC_ID
   source CMPNT_MATL_NUM                           CMPNT_MATL_DESC   
0     NaN       30042436        SHPR LBL SUDAFED SINUS 24HR TAB 10  \
1     NaN       30042433             CTN SUDAFED SINUS 24HR TAB 10   
2     NaN       30040223              SHPR MOTRIN IB LIQ GELS 80CT   
3     NaN       30040223              SHPR MOTRIN IB LIQ GELS 80CT   
4     NaN       30040224              SHPR MOTRIN IB LIQ GELS 20CT   
5     NaN       30040224              SHPR MOTRIN IB LIQ GELS 20CT   
6     NaN         555255              Bot Sh Js Baby Clásico 200ml   
7     NaN         555255              Bot Sh Js Baby Clásico 200ml   
8     NaN         555255              Bot Sh Js Baby Clásico 200ml   
9     NaN         555378           Bot Sh Js Baby Manzanilla 200ml   
10    NaN         555378           Bot Sh Js Baby Manzanilla 200ml   
11    NaN         555378           Bot Sh Js Baby Manzanilla 200ml   
12    NaN         183149  20.sco sin Impresión Aceite x200 ml(DAK)   
13    NaN         183149  20.sco sin Impresión Aceite x200 ml(DAK)   
14    NaN         183149  20.sco sin Impresión Aceite x200 ml(DAK)   
15    NaN         183149  20.sco sin Impresión Aceite x200 ml(DAK)   
16    NaN            NaN                                       NaN   
17    NaN            NaN                                       NaN   
18    NaN            NaN                                       NaN   
19    NaN            NaN                                       NaN   
20    NaN            NaN                                       NaN   
21    NaN            NaN                                       NaN   
22    NaN            NaN                                       NaN   
23    NaN            NaN                                       NaN   
24    NaN            NaN                                       NaN   
25    NaN            NaN                                       NaN   
26    NaN            NaN                                       NaN   
27    NaN            NaN                                       NaN   

      CHILD_NM                                   CHILD_TITLE_DESC   
0     30042436  Miscellaneous Printed, SUDAFED, TABLET, Shippe...  \
1     30042433         Carton, SUDAFED, TABLET, Sudafed 24HR 10ct   
2     30040223                Shipper, MOTRIN IB, CAPSULES, 80 ct   
3     30040223                Shipper, MOTRIN IB, CAPSULES, 80 ct   
4     30040224                Shipper, MOTRIN IB, CAPSULES, 20 ct   
5     30040224                Shipper, MOTRIN IB, CAPSULES, 20 ct   
6    PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
7    PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
8    PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
9    PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
10   PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
11   PC-052719          Frasco PET Shampoo y Acondicionador 200ml   
12  PC-0014245       Bottle/Frascos Aceite Johnsons Baby x 200 ml   
13  PC-0014245       Bottle/Frascos Aceite Johnsons Baby x 200 ml   
14  PC-0014245       Bottle/Frascos Aceite Johnsons Baby x 200 ml   
15  PC-0014245       Bottle/Frascos Aceite Johnsons Baby x 200 ml   
16         NaN                                                NaN   
17         NaN                                                NaN   
18         NaN                                                NaN   
19         NaN                                                NaN   
20         NaN                                                NaN   
21         NaN                                                NaN   
22         NaN                                                NaN   
23         NaN                                                NaN   
24         NaN                                                NaN   
25         NaN                                                NaN   
26         NaN                                                NaN   
27         NaN                                                NaN   

           text_for_matching_erp                     text_for_matching_tru  
0                            NaN                                       NaN  
1                            NaN                                       NaN  
2                  shpr liq 80ct                       shipper capsules ct  
3            motrin 80ct shipper                       shipper capsules ct  
4                  shpr liq 20ct                       shipper capsules ct  
5            motrin 20ct shipper                       shipper capsules ct  
6            bot sh baby clásico          bottle frasco pet acondicionador  
7            bot sh baby clásico  bottle frasco pet shampoo acondicionador  
8            bot sh baby clásico                 bottle frasco pet shampoo  
9                    bot sh baby          bottle frasco pet acondicionador  
10                   bot sh baby  bottle frasco pet shampoo acondicionador  
11                   bot sh baby                 bottle frasco pet shampoo  
12         sco sin impresión dak              bottle frascos johnsons baby  
13         sco sin impresión dak                            bottle frascos  
14  sco sin impresión aceite dak              bottle frascos johnsons baby  
15  sco sin impresión aceite dak                            bottle frascos  
16                           NaN                                       NaN  
17                           NaN                                       NaN  
18                           NaN                                       NaN  
19                           NaN                                       NaN  
20                           NaN                                       NaN  
21                           NaN                                       NaN  
22                           NaN                                       NaN  
23                           NaN                                       NaN  
24                           NaN                                       NaN  
25                           NaN                                       NaN  
26                           NaN                                       NaN  
27                           NaN                                       NaN  
xmatches_EPR_priority_confidence_with_text s1    CMPNT_MATL_NUM    CHILD_NM         text_for_matching_erp   
0        30042436    30042436                           NaN  \
1        30042433    30042433                           NaN   
2        30040223    30040223                 shpr liq 80ct   
3        30040223    30040223           motrin 80ct shipper   
4        30040224    30040224                 shpr liq 20ct   
5        30040224    30040224           motrin 20ct shipper   
6          555255   PC-052719           bot sh baby clásico   
7          555255   PC-052719           bot sh baby clásico   
8          555255   PC-052719           bot sh baby clásico   
9          555378   PC-052719                   bot sh baby   
10         555378   PC-052719                   bot sh baby   
11         555378   PC-052719                   bot sh baby   
12         183149  PC-0014245         sco sin impresión dak   
13         183149  PC-0014245         sco sin impresión dak   
14         183149  PC-0014245  sco sin impresión aceite dak   
15         183149  PC-0014245  sco sin impresión aceite dak   
16            NaN         NaN                           NaN   
17            NaN         NaN                           NaN   
18            NaN         NaN                           NaN   
19            NaN         NaN                           NaN   
20            NaN         NaN                           NaN   
21            NaN         NaN                           NaN   
22            NaN         NaN                           NaN   
23            NaN         NaN                           NaN   
24            NaN         NaN                           NaN   
25            NaN         NaN                           NaN   
26            NaN         NaN                           NaN   
27            NaN         NaN                           NaN   

                       text_for_matching_tru  
0                                        NaN  
1                                        NaN  
2                        shipper capsules ct  
3                        shipper capsules ct  
4                        shipper capsules ct  
5                        shipper capsules ct  
6           bottle frasco pet acondicionador  
7   bottle frasco pet shampoo acondicionador  
8                  bottle frasco pet shampoo  
9           bottle frasco pet acondicionador  
10  bottle frasco pet shampoo acondicionador  
11                 bottle frasco pet shampoo  
12              bottle frascos johnsons baby  
13                            bottle frascos  
14              bottle frascos johnsons baby  
15                            bottle frascos  
16                                       NaN  
17                                       NaN  
18                                       NaN  
19                                       NaN  
20                                       NaN  
21                                       NaN  
22                                       NaN  
23                                       NaN  
24                                       NaN  
25                                       NaN  
26                                       NaN  
27                                       NaN  
xmatches_EPR_priority_confidence_with_text s2    CMPNT_MATL_NUM    CHILD_NM         text_for_matching_erp   
0        30042436    30042436                           NaN  \
1        30042433    30042433                           NaN   
2        30040223    30040223                 shpr liq 80ct   
3        30040223    30040223           motrin 80ct shipper   
4        30040224    30040224                 shpr liq 20ct   
5        30040224    30040224           motrin 20ct shipper   
6          555255   PC-052719           bot sh baby clásico   
7          555255   PC-052719           bot sh baby clásico   
8          555255   PC-052719           bot sh baby clásico   
9          555378   PC-052719                   bot sh baby   
10         555378   PC-052719                   bot sh baby   
11         555378   PC-052719                   bot sh baby   
12         183149  PC-0014245         sco sin impresión dak   
13         183149  PC-0014245         sco sin impresión dak   
14         183149  PC-0014245  sco sin impresión aceite dak   
15         183149  PC-0014245  sco sin impresión aceite dak   
16            NaN         NaN                           NaN   

                       text_for_matching_tru  
0                                        NaN  
1                                        NaN  
2                        shipper capsules ct  
3                        shipper capsules ct  
4                        shipper capsules ct  
5                        shipper capsules ct  
6           bottle frasco pet acondicionador  
7   bottle frasco pet shampoo acondicionador  
8                  bottle frasco pet shampoo  
9           bottle frasco pet acondicionador  
10  bottle frasco pet shampoo acondicionador  
11                 bottle frasco pet shampoo  
12              bottle frascos johnsons baby  
13                            bottle frascos  
14              bottle frascos johnsons baby  
15                            bottle frascos  
16                                       NaN  

=== MATCH ROUND 12: matches_EPR_priority_confidence suggested X-match ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in matches_EPR_priority_confidence suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in matches_EPR_priority_confidence suggested X-match
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in matches_EPR_priority_confidence suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
12: matches_EPR_priority_confidence suggested X-match round matched: 14 (0.38 seconds)
df_erp_to_match cases:  138317
df_tru_to_match cases:  117393
Amount of current matches:  14
   SRC_SYS_CD            MATL_NUM   MATL_NUM_original   
0         CLA  000000000000576971  000000000000576971  \
1         CLA  000000000000571883  000000000000571883   
2         US1  000000000304098000  000000000304098000   
3        PCIC  000000000304098000           304098000   
4         US1  000000000304092000  000000000304092000   
5        PCIC  000000000304092000           304092000   
6         CLA  000000000000576974  000000000000576974   
7         CLA  000000000000571886  000000000000571886   
8         CLA  000000000000554013  000000000000554013   
9         CLA  000000000000558858  000000000000558858   
10        CLA  000000000000572492  000000000000572492   
13        CLA  000000000000574442  000000000000574442   
14        CLA  000000000000554031  000000000000554031   
15        CLA  000000000000571927  000000000000571927   

                            MATL_SHRT_DESC        PLNT_CD CMPNT_MATL_TYPE_CD   
0        JB SHAMPOO MANZANILLA 200ML X 12U           AR01               PACK  \
1             JB SHAMPOO MANZANILLA 12X200           AR01               PACK   
2                 MOTRIN IB LIQUID GELS 80           US34                ROH   
3                                  unknown  External_PCIC               None   
4                 MOTRIN IB LIQUID GELS 20           US34                ROH   
5                                  unknown  External_PCIC               None   
6          JB SHAMPOO ORIGINAL 200ML X 12U           AR01               PACK   
7               JB SHAMPOO ORIGINAL 12X200           AR01               PACK   
8               JB SHAMPOO ORIGINAL 12X200           AR01               PACK   
9   JS ACEITE PURO JOHNSONS BABY 12U X 200           AR01               PACK   
10                      ACEITE PURO X200ML           AR01               PACK   
13                 JB SHAMPOO RULOS 12X200           AR01               PACK   
14                 JB SHAMPOO RULOS 12X200           AR01               PACK   
15                 JB SHAMPOO RULOS 12X200           AR01               PACK   

   CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
0          555378      000000000000555378  \
1          555378      000000000000555378   
2        30040223      000000000030040223   
3        30040223                30040223   
4        30040224      000000000030040224   
5        30040224                30040224   
6          555255      000000000000555255   
7          555255      000000000000555255   
8          555255      000000000000555255   
9          183149      000000000000183149   
10         183149      000000000000183149   
13         555399      000000000000555399   
14         555399      000000000000555399   
15         555399      000000000000555399   

                             CMPNT_MATL_DESC  text_for_matching_erp   
0            Bot Sh Js Baby Manzanilla 200ml            bot sh baby  \
1            Bot Sh Js Baby Manzanilla 200ml            bot sh baby   
2               SHPR MOTRIN IB LIQ GELS 80CT          shpr liq 80ct   
3                        Motrin 80ct Shipper    motrin 80ct shipper   
4               SHPR MOTRIN IB LIQ GELS 20CT          shpr liq 20ct   
5                        Motrin 20ct Shipper    motrin 20ct shipper   
6               Bot Sh Js Baby Clásico 200ml    bot sh baby clásico   
7               Bot Sh Js Baby Clásico 200ml    bot sh baby clásico   
8               Bot Sh Js Baby Clásico 200ml    bot sh baby clásico   
9   20.sco sin Impresión Aceite x200 ml(DAK)  sco sin impresión dak   
10  20.sco sin Impresión Aceite x200 ml(DAK)  sco sin impresión dak   
13                Bot Sh Js Baby Rulos 200ml            bot sh baby   
14                Bot Sh Js Baby Rulos 200ml            bot sh baby   
15                Bot Sh Js Baby Rulos 200ml            bot sh baby   

   extracted_rm_erp  perc_alpha_char_erp   
0               NaN             1.000000  \
1               NaN             1.000000   
2               NaN             0.818182   
3               NaN             0.882353   
4               NaN             0.818182   
5               NaN             0.882353   
6               NaN             0.937500   
7               NaN             0.937500   
8               NaN             0.937500   
9               NaN             0.944444   
10              NaN             0.944444   
13              NaN             1.000000   
14              NaN             1.000000   
15              NaN             1.000000   

                                           key_erp    CHILD_NM RGN_CD   
0               000000000000576971_555378_AR01_CLA   PC-052719  LATAM  \
1               000000000000571883_555378_AR01_CLA   PC-052719  LATAM   
2             000000000304098000_30040223_US34_US1    30040223    NaN   
3   000000000304098000_30040223_External_PCIC_PCIC    30040223    NaN   
4             000000000304092000_30040224_US34_US1    30040224    NaN   
5   000000000304092000_30040224_External_PCIC_PCIC    30040224    NaN   
6               000000000000576974_555255_AR01_CLA   PC-052719  LATAM   
7               000000000000571886_555255_AR01_CLA   PC-052719  LATAM   
8               000000000000554013_555255_AR01_CLA   PC-052719  LATAM   
9               000000000000558858_183149_AR01_CLA  PC-0014245  LATAM   
10              000000000000572492_183149_AR01_CLA  PC-0014245  LATAM   
13              000000000000574442_555399_AR01_CLA   PC-052719  LATAM   
14              000000000000554031_555399_AR01_CLA   PC-052719  LATAM   
15              000000000000571927_555399_AR01_CLA   PC-052719  LATAM   

               mat_num MATL_NUM_original_tru_ref      mat_num_padded   
0   000000000000576971        000000000000576971  000000000000576971  \
1   000000000000571883        000000000000571883  000000000000571883   
2   000000000304098000        000000000304098000  000000000304098000   
3   000000000304098000                 304098000  000000000304098000   
4   000000000304092000        000000000304092000  000000000304092000   
5   000000000304092000                 304092000  000000000304092000   
6   000000000000576974        000000000000576974  000000000000576974   
7   000000000000571886        000000000000571886  000000000000571886   
8   000000000000554013        000000000000554013  000000000000554013   
9   000000000000558858        000000000000558858  000000000000558858   
10  000000000000572492        000000000000572492  000000000000572492   
13  000000000000574442        000000000000574442  000000000000574442   
14  000000000000554031        000000000000554031  000000000000554031   
15  000000000000571927        000000000000571927  000000000000571927   

      mat_num_original       FG_NM   
0   000000000000576971  FG-0041385  \
1   000000000000571883  FG-0026632   
2   000000000304098000  FG-0020980   
3   000000000304098000  FG-0020980   
4   000000000304092000  FG-0021050   
5   000000000304092000  FG-0021050   
6   000000000000576974  FG-0041389   
7   000000000000571886  FG-0026636   
8   000000000000554013  FG-0016364   
9   000000000000558858  FG-0021089   
10  000000000000572492  FG-0028816   
13  000000000000574442  FG-0039344   
14  000000000000554031  FG-0016382   
15  000000000000571927  FG-0030325   

                                           FG_SPEC_NM FD_NM CHILD_NM_original   
0          576971 - JB SHAMPOO MANZANILLA 200ML X 12U  None         PC-052719  \
1            571883 - JB SHAMPOO MANZANILLA 12X200 ml  None         PC-052719   
2      304098000, Alt 2, Motrin IB Liquid Gels, 80 Ct  None          30040223   
3      304098000, Alt 2, Motrin IB Liquid Gels, 80 Ct  None          30040223   
4   304092000, Alt 2, Motrin IB Liquid Gels, 20 Ct...  None          30040224   
5   304092000, Alt 2, Motrin IB Liquid Gels, 20 Ct...  None          30040224   
6            576974 - JB SHAMPOO ORIGINAL 200ML X 12U  None         PC-052719   
7              571886 - JB SHAMPOO ORIGINAL 12X200 ml  None         PC-052719   
8               554013 - JB SHAMPOO ORIGINAL 12X200ml  None         PC-052719   
9          558858 Aceite Puro Johnsons Baby 12x200 ml  None        PC-0014245   
10        572492 - Aceite Puro Johnsons Baby 12 x 200  None        PC-0014245   
13                   574442 - JB SHAMPOO RULOS 12X200  None         PC-052719   
14                 554031 - JB SHAMPOO RULOS 12X200ml  None         PC-052719   
15                 571927 - JB SHAMPOO RULOS 12X200ml  None         PC-052719   

                                     CHILD_TITLE_DESC spec_type_inferred   
0   Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC  \
1   Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC   
2                 Shipper, MOTRIN IB, CAPSULES, 80 ct            Unknown   
3                 Shipper, MOTRIN IB, CAPSULES, 80 ct            Unknown   
4                 Shipper, MOTRIN IB, CAPSULES, 20 ct            Unknown   
5                 Shipper, MOTRIN IB, CAPSULES, 20 ct            Unknown   
6   Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC   
7   Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC   
8   Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC   
9        Bottle/Frascos Aceite Johnsons Baby x 200 ml                 PC   
10       Bottle/Frascos Aceite Johnsons Baby x 200 ml                 PC   
13  Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC   
14  Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC   
15  Bottle/ Frasco PET Shampoo y Acondicionador 200ml                 PC   

           TEMPL_TYPE_CD        CHILD_TYPE_CD   
0          Bottles/ Jars  Packaging Component  \
1          Bottles/ Jars  Packaging Component   
2   Corrugated / Shipper  Packaging Component   
3   Corrugated / Shipper  Packaging Component   
4   Corrugated / Shipper  Packaging Component   
5   Corrugated / Shipper  Packaging Component   
6          Bottles/ Jars  Packaging Component   
7          Bottles/ Jars  Packaging Component   
8          Bottles/ Jars  Packaging Component   
9          Bottles/ Jars  Packaging Component   
10         Bottles/ Jars  Packaging Component   
13         Bottles/ Jars  Packaging Component   
14         Bottles/ Jars  Packaging Component   
15         Bottles/ Jars  Packaging Component   

                                  ERP_DESC             text_for_matching_tru   
0        JB SHAMPOO MANZANILLA 200ML X 12U  bottle frasco pet acondicionador  \
1             JB SHAMPOO MANZANILLA 12X200  bottle frasco pet acondicionador   
2                 MOTRIN IB LIQUID GELS 80               shipper capsules ct   
3                 MOTRIN IB LIQUID GELS 80               shipper capsules ct   
4                 MOTRIN IB LIQUID GELS 20               shipper capsules ct   
5                 MOTRIN IB LIQUID GELS 20               shipper capsules ct   
6          JB SHAMPOO ORIGINAL 200ML X 12U  bottle frasco pet acondicionador   
7               JB SHAMPOO ORIGINAL 12X200  bottle frasco pet acondicionador   
8               JB SHAMPOO ORIGINAL 12X200  bottle frasco pet acondicionador   
9   JS ACEITE PURO JOHNSONS BABY 12U X 200                    bottle frascos   
10                      ACEITE PURO X200ML      bottle frascos johnsons baby   
13                 JB SHAMPOO RULOS 12X200  bottle frasco pet acondicionador   
14                 JB SHAMPOO RULOS 12X200  bottle frasco pet acondicionador   
15                 JB SHAMPOO RULOS 12X200  bottle frasco pet acondicionador   

   text_for_matching_tru_trade_names extracted_rm_tru  perc_alpha_char_tru   
0                                                 NaN                  1.0  \
1                                                 NaN                  1.0   
2                                                 NaN                  1.0   
3                                                 NaN                  1.0   
4                                                 NaN                  1.0   
5                                                 NaN                  1.0   
6                                                 NaN                  1.0   
7                                                 NaN                  1.0   
8                                                 NaN                  1.0   
9                                                 NaN                  1.0   
10                                                NaN                  1.0   
13                                                NaN                  1.0   
14                                                NaN                  1.0   
15                                                NaN                  1.0   

                                           key_tru           SPEC_FLOW_CD   
0            000000000000576971_PC-052719_AR01_CLA   FG-0041385>PC-052719  \
1            000000000000571883_PC-052719_AR01_CLA   FG-0026632>PC-052719   
2             000000000304098000_30040223_US34_US1    FG-0020980>30040223   
3   000000000304098000_30040223_External_PCIC_PCIC    FG-0020980>30040223   
4             000000000304092000_30040224_US34_US1    FG-0021050>30040224   
5   000000000304092000_30040224_External_PCIC_PCIC    FG-0021050>30040224   
6            000000000000576974_PC-052719_AR01_CLA   FG-0041389>PC-052719   
7            000000000000571886_PC-052719_AR01_CLA   FG-0026636>PC-052719   
8            000000000000554013_PC-052719_AR01_CLA   FG-0016364>PC-052719   
9           000000000000558858_PC-0014245_AR01_CLA  FG-0021089>PC-0014245   
10          000000000000572492_PC-0014245_AR01_CLA  FG-0028816>PC-0014245   
13           000000000000574442_PC-052719_AR01_CLA   FG-0039344>PC-052719   
14           000000000000554031_PC-052719_AR01_CLA   FG-0016382>PC-052719   
15           000000000000571927_PC-052719_AR01_CLA   FG-0030325>PC-052719   

   TRD_NM_CONCAT TRD_NM_FULL  matching_score    unified_mat_code  is_matched   
0            NaN         NaN               1  000000000000576971        True  \
1            NaN         NaN               1  000000000000571883        True   
2            NaN         NaN               1  000000000304098000        True   
3            NaN         NaN               1           304098000        True   
4            NaN         NaN               1  000000000304092000        True   
5            NaN         NaN               1           304092000        True   
6            NaN         NaN               1  000000000000576974        True   
7            NaN         NaN               1  000000000000571886        True   
8            NaN         NaN               1  000000000000554013        True   
9            NaN         NaN               1  000000000000558858        True   
10           NaN         NaN               1  000000000000572492        True   
13           NaN         NaN               1  000000000000574442        True   
14           NaN         NaN               1  000000000000554031        True   
15           NaN         NaN               1  000000000000571927        True   

                                      Matching Reason confidence   
0   matches_EPR_priority_confidence suggested X-match       high  \
1   matches_EPR_priority_confidence suggested X-match       high   
2   matches_EPR_priority_confidence suggested X-match       high   
3   matches_EPR_priority_confidence suggested X-match       high   
4   matches_EPR_priority_confidence suggested X-match       high   
5   matches_EPR_priority_confidence suggested X-match       high   
6   matches_EPR_priority_confidence suggested X-match       high   
7   matches_EPR_priority_confidence suggested X-match       high   
8   matches_EPR_priority_confidence suggested X-match       high   
9   matches_EPR_priority_confidence suggested X-match       high   
10  matches_EPR_priority_confidence suggested X-match       high   
13  matches_EPR_priority_confidence suggested X-match       high   
14  matches_EPR_priority_confidence suggested X-match       high   
15  matches_EPR_priority_confidence suggested X-match       high   

                                          match_round  
0   12: matches_EPR_priority_confidence suggested ...  
1   12: matches_EPR_priority_confidence suggested ...  
2   12: matches_EPR_priority_confidence suggested ...  
3   12: matches_EPR_priority_confidence suggested ...  
4   12: matches_EPR_priority_confidence suggested ...  
5   12: matches_EPR_priority_confidence suggested ...  
6   12: matches_EPR_priority_confidence suggested ...  
7   12: matches_EPR_priority_confidence suggested ...  
8   12: matches_EPR_priority_confidence suggested ...  
9   12: matches_EPR_priority_confidence suggested ...  
10  12: matches_EPR_priority_confidence suggested ...  
13  12: matches_EPR_priority_confidence suggested ...  
14  12: matches_EPR_priority_confidence suggested ...  
15  12: matches_EPR_priority_confidence suggested ...  
------------------------------------------------------------
reading xmatches_EPR_priority_confidence file from folder 
    source CMPNT_MATL_NUM                         CMPNT_MATL_DESC    CHILD_NM   
0      CAP        6143649  Film-Size W330xT0.012mm_POF_Roll_Blank  PC-0018983  \
1      CAP        6120187      PET SS for Listerine Product-500ml  PC-0012534   
2      CAP        6141404  PET SS for Listerine Product-1000ml GD  DC-0078779   
3      CAP        6106730     PET SS for Listerine Product-1000ml  PC-0012470   
4      CAP        6141403   PET SS for Listerine Product-500ml GD  DC-0078778   
..     ...            ...                                     ...         ...   
592    CAP        6144537           Plate-AVN Baby SR lotion 227g  PC-0019024   
593    CAP        6144986                                20mm cap  PC-0009838   
594    CAP        6135069                                CRC 20mm  PC-0009838   
595    CAP        6112209                          CRC Plug 125ml   PC-037264   
596    CAP        6126715            LDPE FILM 160mm (55MC) Plain   PC-042444   

                                      CHILD_TITLE_DESC  
0    DaBao POF shrink film (Roll: W330*T0.012mm)/??...  
1    PET safety seal for Listerine non-alcohol prod...  
2    FGAll Skus Seal Listerine All Variants 750ml 1...  
3    PET safety seal for Listerine alcohol product ...  
4    FGAll Skus Seal Listerine All Variants 500ml C...  
..                                                 ...  
592         Shipper with partition of Aveeno Baby 227g  
593                               CRC 20mm (Copy mold)  
594                               CRC 20mm (Copy mold)  
595  Child Resistance Cap for Johnsons Baby Oil (T...  
596  LDPE SHRINK FILM FOR BUNDLE PACK- roll width -...  

[597 rows x 5 columns]
mapping using ERP PART ID
    source CMPNT_MATL_NUM                         CMPNT_MATL_DESC    CHILD_NM   
0      CAP        6143649  Film-Size W330xT0.012mm_POF_Roll_Blank  PC-0018983  \
1      CAP        6120187      PET SS for Listerine Product-500ml  PC-0012534   
2      CAP        6141404  PET SS for Listerine Product-1000ml GD  DC-0078779   
3      CAP        6141404  PET SS for Listerine Product-1000ml GD  DC-0078779   
4      CAP        6106730     PET SS for Listerine Product-1000ml  PC-0012470   
..     ...            ...                                     ...         ...   
623    CAP        6144537           Plate-AVN Baby SR lotion 227g  PC-0019024   
624    CAP        6144986                                20mm cap  PC-0009838   
625    CAP        6135069                                CRC 20mm  PC-0009838   
626    CAP        6112209                          CRC Plug 125ml   PC-037264   
627    CAP        6126715            LDPE FILM 160mm (55MC) Plain   PC-042444   

                                      CHILD_TITLE_DESC  text_for_matching_erp  
0    DaBao POF shrink film (Roll: W330*T0.012mm)/??...                    NaN  
1    PET safety seal for Listerine non-alcohol prod...                    NaN  
2    FGAll Skus Seal Listerine All Variants 750ml 1...  pet ss for product gd  
3    FGAll Skus Seal Listerine All Variants 750ml 1...      pet ss product gd  
4    PET safety seal for Listerine alcohol product ...                    NaN  
..                                                 ...                    ...  
623         Shipper with partition of Aveeno Baby 227g                    NaN  
624                               CRC 20mm (Copy mold)                 mm cap  
625                               CRC 20mm (Copy mold)                    crc  
626  Child Resistance Cap for Johnsons Baby Oil (T...               crc plug  
627  LDPE SHRINK FILM FOR BUNDLE PACK- roll width -...   ldpe film 55mc plain  

[628 rows x 6 columns]
mapping using TRU_SPEC_ID
    source CMPNT_MATL_NUM                         CMPNT_MATL_DESC    CHILD_NM   
0      CAP        6143649  Film-Size W330xT0.012mm_POF_Roll_Blank  PC-0018983  \
1      CAP        6120187      PET SS for Listerine Product-500ml  PC-0012534   
2      CAP        6141404  PET SS for Listerine Product-1000ml GD  DC-0078779   
3      CAP        6141404  PET SS for Listerine Product-1000ml GD  DC-0078779   
4      CAP        6106730     PET SS for Listerine Product-1000ml  PC-0012470   
..     ...            ...                                     ...         ...   
776    CAP        6144986                                20mm cap  PC-0009838   
777    CAP        6135069                                CRC 20mm  PC-0009838   
778    CAP        6112209                          CRC Plug 125ml   PC-037264   
779    CAP        6112209                          CRC Plug 125ml   PC-037264   
780    CAP        6126715            LDPE FILM 160mm (55MC) Plain   PC-042444   

                                      CHILD_TITLE_DESC  text_for_matching_erp   
0    DaBao POF shrink film (Roll: W330*T0.012mm)/??...                    NaN  \
1    PET safety seal for Listerine non-alcohol prod...                    NaN   
2    FGAll Skus Seal Listerine All Variants 750ml 1...  pet ss for product gd   
3    FGAll Skus Seal Listerine All Variants 750ml 1...      pet ss product gd   
4    PET safety seal for Listerine alcohol product ...                    NaN   
..                                                 ...                    ...   
776                               CRC 20mm (Copy mold)                 mm cap   
777                               CRC 20mm (Copy mold)                    crc   
778  Child Resistance Cap for Johnsons Baby Oil (T...               crc plug   
779  Child Resistance Cap for Johnsons Baby Oil (T...               crc plug   
780  LDPE SHRINK FILM FOR BUNDLE PACK- roll width -...   ldpe film 55mc plain   

                           text_for_matching_tru  
0               da bao pof shrink film 大宝pof热收缩膜  
1                                            NaN  
2                                            NaN  
3                                            NaN  
4                                            NaN  
..                                           ...  
776                                          crc  
777                                          crc  
778    child resistance cap for johnson baby oil  
779        child resistance cap for johnson baby  
780  ldpe shrink film for bundle pack roll width  

[781 rows x 7 columns]
xmatches_Potential_PC_DC_Spec_with_text s1     CMPNT_MATL_NUM    CHILD_NM  text_for_matching_erp   
0          6143649  PC-0018983                    NaN  \
1          6120187  PC-0012534                    NaN   
2          6141404  DC-0078779  pet ss for product gd   
3          6141404  DC-0078779      pet ss product gd   
4          6106730  PC-0012470                    NaN   
..             ...         ...                    ...   
776        6144986  PC-0009838                 mm cap   
777        6135069  PC-0009838                    crc   
778        6112209   PC-037264               crc plug   
779        6112209   PC-037264               crc plug   
780        6126715   PC-042444   ldpe film 55mc plain   

                           text_for_matching_tru  
0               da bao pof shrink film 大宝pof热收缩膜  
1                                            NaN  
2                                            NaN  
3                                            NaN  
4                                            NaN  
..                                           ...  
776                                          crc  
777                                          crc  
778    child resistance cap for johnson baby oil  
779        child resistance cap for johnson baby  
780  ldpe shrink film for bundle pack roll width  

[781 rows x 4 columns]
xmatches_Potential_PC_DC_Spec_with_text s2     CMPNT_MATL_NUM    CHILD_NM  text_for_matching_erp   
0          6143649  PC-0018983                    NaN  \
1          6120187  PC-0012534                    NaN   
2          6141404  DC-0078779  pet ss for product gd   
3          6141404  DC-0078779      pet ss product gd   
4          6106730  PC-0012470                    NaN   
..             ...         ...                    ...   
776        6144986  PC-0009838                 mm cap   
777        6135069  PC-0009838                    crc   
778        6112209   PC-037264               crc plug   
779        6112209   PC-037264               crc plug   
780        6126715   PC-042444   ldpe film 55mc plain   

                           text_for_matching_tru  
0               da bao pof shrink film 大宝pof热收缩膜  
1                                            NaN  
2                                            NaN  
3                                            NaN  
4                                            NaN  
..                                           ...  
776                                          crc  
777                                          crc  
778    child resistance cap for johnson baby oil  
779        child resistance cap for johnson baby  
780  ldpe shrink film for bundle pack roll width  

[779 rows x 4 columns]

=== MATCH ROUND 13: matches_Potential_PC_DC_Spec suggested X-match ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in matches_Potential_PC_DC_Spec suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in matches_Potential_PC_DC_Spec suggested X-match
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in matches_Potential_PC_DC_Spec suggested X-match
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
13: matches_Potential_PC_DC_Spec suggested X-match round matched: 31 (0.38 seconds)
df_erp_to_match cases:  138286
df_tru_to_match cases:  117362
Amount of current matches:  31
   SRC_SYS_CD            MATL_NUM MATL_NUM_original   
0         BPA  000000000009392201           9392201  \
1         BPA  000000000008579603           8579603   
2         BPA  000000000003258504           3258504   
3         BPA  000000000002069805           2069805   
4         BPA  000000000009384000           9384000   
5         BPA  000000000004951303           4951303   
6         BPA  000000000004951303           4951303   
7         BPA  000000000003255003           3255003   
8         BPA  000000000004951303           4951303   
9         BPA  000000000003254803           3254803   
10        BPA  000000000003256204           3256204   
11        BPA  000000000003256304           3256304   
12        BPA  000000000003249405           3249405   
13        BPA  000000000008737803           8737803   
14        BPA  000000000008737903           8737903   
15        BPA  000000000008737803           8737803   
16        BPA  000000000002069906           2069906   
17        BPA  000000000008737903           8737903   
18        BPA  000000000002070306           2070306   
19        BPA  000000000003255203           3255203   
20        BPA  000000000003248106           3248106   
21        BPA  000000000003255103           3255103   
22        BPA  000000000009384102           9384102   
23        BPA  000000000009384102           9384102   
24        BPA  000000000009142401           9142401   
25        BPA  000000000009392300           9392300   
26        BPA  000000000009392201           9392201   
29        BPA  000000000009384100           9384100   
30        BPA  000000000009392200           9392200   
35        BPA  000000000007064305           7064305   
43        BPA  000000000007142404           7142404   

                    MATL_SHRT_DESC PLNT_CD CMPNT_MATL_TYPE_CD CMPNT_MATL_NUM   
0   SAVLON A-SEPT LIQUID 750 ZA-EN    ZA01                  P        2900210  \
1   STAYF MAX THICK REG WGS UNSC 8    ZA01                  P        2900221   
2   JH PH5 AQUEOUS BDYCR VIT E 350    ZA01                  P        2900083   
3    JH LIGHT FRAG JELLY 100 ML ZA    ZA01                  P        2900152   
4   SAVLON A-SEPT LIQUID 2000   ZA    ZA01                  P        2900179   
5         JH BEDTIME OIL 200 ML ZA    ZA01                  P        2112841   
6         JH BEDTIME OIL 200 ML ZA    ZA01                  P        2112862   
7            JH BABY OIL 200 ML ZA    ZA01                  P        2112862   
8         JH BEDTIME OIL 200 ML ZA    ZA01                  P        2900144   
9            JH BABY OIL 125 ML ZA    ZA01                  P        2112861   
10  JH FRAG FREE JELLY 100 ML MENA    ZA01                  P        2900166   
11    JH LIGHT FRAG JELLY 250 MENA    ZA01                  P        2900167   
12     JH F/F AQUEOUS CR 350 ML ZA    ZA01                  P        2900116   
13      STAYF MAXI THICK SUP SC 16    ZA01                  P        2112781   
14    STAYF MAXI THICK SUP UNSC 16    ZA01                  P        2112781   
15      STAYF MAXI THICK SUP SC 16    ZA01                  P        2900217   
16   JH LIGHT FRAG JELLY 250 ML ZA    ZA01                  P        2900153   
17    STAYF MAXI THICK SUP UNSC 16    ZA01                  P        2900218   
18    JH FRAG FREE JELLY 250 ML ZA    ZA01                  P        2900155   
19           JH BABY OIL 500 ML ZA    ZA01                  P        2112864   
20    JH BEDTIME AQUEOUS CR 250 ZA    ZA01                  P        2900115   
21           JH BABY OIL 300 ML ZA    ZA01                  P        2112863   
22  SAVLON A-SEPT LIQUID 500 ZA-EN    ZA01                  P        2113037   
23  SAVLON A-SEPT LIQUID 500 ZA-EN    ZA01                  P        2900208   
24  JH BABY AQUEOUS CR F/FREE  500    ZA01                  P        2900118   
25  SAVLON A-SEPT LIQUID 75  ZA-EN    ZA01                  P        2113026   
26  SAVLON A-SEPT LIQUID 750 ZA-EN    ZA01                  P        2113041   
29  SAVLON A-SEPT LIQUID 500 ZA-EN    ZA01                  P        2900174   
30  SAVLON A-SEPT LIQUID 750 ZA-EN    ZA01                  P        2900175   
35   JH LIGHT FRAG JELLY 500 ML ZA    ZA01                  P        2900157   
43    JH FRAG FREE JELLY 500 ML ZA    ZA01                  P        2900158   

   CMPNT_MATL_NUM_original               CMPNT_MATL_DESC   
0                 02900210         CASE SAVLON 750ML ASL  \
1                 02900221         CASE SF MAXI THIK REG   
2                 02900083      CASE AQUEOUS VIT E 350ML   
3                 02900152        CASE JB JELLY LF 100ML   
4                 02900179        CASE SAVLON LIQ 2LT ML   
5                 02112841  CAP OIL 200ML - PURPLE 24MM6   
6                 02112862        BOTTLE JBABY OIL 200ML   
7                 02112862        BOTTLE JBABY OIL 200ML   
8                 02900144          CASE BEDTIME OIL 200   
9                 02112861        BOTTLE JBABY OIL 125ML   
10                02900166     CASE JB JELLY UNSC 100 ME   
11                02900167     CASE JB JELLY SC 250ML ME   
12                02900116      CASE JB AQUEOUS FF 350ML   
13                02112781       INT PBAG SFREE SUPER 16   
14                02112781       INT PBAG SFREE SUPER 16   
15                02900217        CASE SF MAXI SUP SC 16   
16                02900153        CASE JB JELLY LF 250ML   
17                02900218         CASE SF MAXI SUP UNSC   
18                02900155        CASE JB JELLY FF 250ML   
19                02112864        BOTTLE JBABY OIL 500ML   
20                02900115    CASE AQUEOUS BEDTIME 250ML   
21                02112863        BOTTLE JBABY OIL 300ML   
22                02113037    BOTTLE SAVLON LIQUID 500ML   
23                02900208         CASE SAVLON 500ML ASL   
24                02900118      CASE JB AQUEOUS FF 500ML   
25                02113026        BOTTLE SAVLON LIQ 75ML   
26                02113041    BOTTLE SAVLON LIQUID 750ML   
29                02900174         CASE SAVLON 500ML ASL   
30                02900175         CASE SAVLON 750ML ASL   
35                02900157        CASE JB JELLY LF 500ML   
43                02900158        CASE JB JELLY FF 500ML   

   text_for_matching_erp extracted_rm_erp  perc_alpha_char_erp   
0               case asl              NaN             1.000000  \
1      case sf maxi thik              NaN             1.000000   
2                   case              NaN             1.000000   
3             case jb lf              NaN             1.000000   
4        case liq 2lt ml              NaN             0.916667   
5             cap purple              NaN             1.000000   
6           bottle jbaby              NaN             1.000000   
7           bottle jbaby              NaN             1.000000   
8                   case              NaN             1.000000   
9           bottle jbaby              NaN             1.000000   
10       case jb unsc me              NaN             1.000000   
11         case jb sc me              NaN             1.000000   
12            case jb ff              NaN             1.000000   
13  int pbag sfree super              NaN             1.000000   
14  int pbag sfree super              NaN             1.000000   
15               case sf              NaN             1.000000   
16            case jb lf              NaN             1.000000   
17               case sf              NaN             1.000000   
18            case jb ff              NaN             1.000000   
19          bottle jbaby              NaN             1.000000   
20                  case              NaN             1.000000   
21          bottle jbaby              NaN             1.000000   
22                bottle              NaN             1.000000   
23              case asl              NaN             1.000000   
24            case jb ff              NaN             1.000000   
25            bottle liq              NaN             1.000000   
26                bottle              NaN             1.000000   
29              case asl              NaN             1.000000   
30              case asl              NaN             1.000000   
35            case jb lf              NaN             1.000000   
43            case jb ff              NaN             1.000000   

                                key_erp    CHILD_NM RGN_CD   
0   000000000009392201_2900210_ZA01_BPA   PC-050412   EMEA  \
1   000000000008579603_2900221_ZA01_BPA  PC-0017684   EMEA   
2   000000000003258504_2900083_ZA01_BPA   PC-055536   EMEA   
3   000000000002069805_2900152_ZA01_BPA   PC-053661   EMEA   
4   000000000009384000_2900179_ZA01_BPA   PC-053994   EMEA   
5   000000000004951303_2112841_ZA01_BPA   PC-054837   EMEA   
6   000000000004951303_2112862_ZA01_BPA   PC-056188   EMEA   
7   000000000003255003_2112862_ZA01_BPA   PC-056188   EMEA   
8   000000000004951303_2900144_ZA01_BPA   PC-059312   EMEA   
9   000000000003254803_2112861_ZA01_BPA   PC-056187   EMEA   
10  000000000003256204_2900166_ZA01_BPA   PC-053661   EMEA   
11  000000000003256304_2900167_ZA01_BPA   PC-054621   EMEA   
12  000000000003249405_2900116_ZA01_BPA   PC-055536   EMEA   
13  000000000008737803_2112781_ZA01_BPA   PC-048858   EMEA   
14  000000000008737903_2112781_ZA01_BPA   PC-048858   EMEA   
15  000000000008737803_2900217_ZA01_BPA  PC-0008672   EMEA   
16  000000000002069906_2900153_ZA01_BPA   PC-054621   EMEA   
17  000000000008737903_2900218_ZA01_BPA  PC-0008672   EMEA   
18  000000000002070306_2900155_ZA01_BPA   PC-054621   EMEA   
19  000000000003255203_2112864_ZA01_BPA   PC-056190   EMEA   
20  000000000003248106_2900115_ZA01_BPA   PC-054629   EMEA   
21  000000000003255103_2112863_ZA01_BPA   PC-056189   EMEA   
22  000000000009384102_2113037_ZA01_BPA  PC-0014401   EMEA   
23  000000000009384102_2900208_ZA01_BPA   PC-050410   EMEA   
24  000000000009142401_2900118_ZA01_BPA   PC-055535   EMEA   
25  000000000009392300_2113026_ZA01_BPA   PC-050299   EMEA   
26  000000000009392201_2113041_ZA01_BPA  PC-0014402   EMEA   
29  000000000009384100_2900174_ZA01_BPA   PC-050410   EMEA   
30  000000000009392200_2900175_ZA01_BPA   PC-050412   EMEA   
35  000000000007064305_2900157_ZA01_BPA   PC-055535   EMEA   
43  000000000007142404_2900158_ZA01_BPA   PC-055535   EMEA   

               mat_num MATL_NUM_original_tru_ref      mat_num_padded   
0   000000000009392201                   9392201  000000000009392201  \
1   000000000008579603                   8579603  000000000008579603   
2   000000000003258504                   3258504  000000000003258504   
3   000000000002069805                   2069805  000000000002069805   
4   000000000009384000                   9384000  000000000009384000   
5   000000000004951303                   4951303  000000000004951303   
6   000000000004951303                   4951303  000000000004951303   
7   000000000003255003                   3255003  000000000003255003   
8   000000000004951303                   4951303  000000000004951303   
9   000000000003254803                   3254803  000000000003254803   
10  000000000003256204                   3256204  000000000003256204   
11  000000000003256304                   3256304  000000000003256304   
12  000000000003249405                   3249405  000000000003249405   
13  000000000008737803                   8737803  000000000008737803   
14  000000000008737903                   8737903  000000000008737903   
15  000000000008737803                   8737803  000000000008737803   
16  000000000002069906                   2069906  000000000002069906   
17  000000000008737903                   8737903  000000000008737903   
18  000000000002070306                   2070306  000000000002070306   
19  000000000003255203                   3255203  000000000003255203   
20  000000000003248106                   3248106  000000000003248106   
21  000000000003255103                   3255103  000000000003255103   
22  000000000009384102                   9384102  000000000009384102   
23  000000000009384102                   9384102  000000000009384102   
24  000000000009142401                   9142401  000000000009142401   
25  000000000009392300                   9392300  000000000009392300   
26  000000000009392201                   9392201  000000000009392201   
29  000000000009384100                   9384100  000000000009384100   
30  000000000009392200                   9392200  000000000009392200   
35  000000000007064305                   7064305  000000000007064305   
43  000000000007142404                   7142404  000000000007142404   

      mat_num_original       FG_NM   
0   000000000009392201  FG-0051763  \
1   000000000008579603  FG-0041293   
2   000000000003258504   FP-071445   
3   000000000002069805  FG-0038506   
4   000000000009384000  FG-0010995   
5   000000000004951303  FG-0007800   
6   000000000004951303  FG-0007800   
7   000000000003255003  FG-0007804   
8   000000000004951303  FG-0007800   
9   000000000003254803  FG-0007803   
10  000000000003256204  FG-0038568   
11  000000000003256304  FG-0038572   
12  000000000003249405  FG-0008871   
13  000000000008737803  FG-0041294   
14  000000000008737903  FG-0041295   
15  000000000008737803  FG-0041294   
16  000000000002069906  FG-0038549   
17  000000000008737903  FG-0041295   
18  000000000002070306  FG-0038557   
19  000000000003255203  FG-0007806   
20  000000000003248106  FG-0008683   
21  000000000003255103  FG-0007805   
22  000000000009384102  FG-0051762   
23  000000000009384102  FG-0051762   
24  000000000009142401  FG-0008876   
25  000000000009392300  FG-0010920   
26  000000000009392201  FG-0051763   
29  000000000009384100  FG-0010993   
30  000000000009392200  FG-0010994   
35  000000000007064305  FG-0038565   
43  000000000007142404  FG-0038566   

                                           FG_SPEC_NM FD_NM CHILD_NM_original   
0            Savlon Antiseptic Liquid 750ml - 9392201  None         PC-050412  \
1    8579603 Stayfree Maxi Regular Wings 8s Unscented  None        PC-0017684   
2         3258504 JOHNSON’S AQUEOUS CREAM VIT E 350ml  None         PC-055536   
3   2069805 JOHNSON BABY JELLY L/F BMR 100 MILLILITRE  None         PC-053661   
4      Savlon Antiseptic Liquid 2LT - Dishman 9384000  None         PC-053994   
5        4951303 Johnson's Baby Oil BEDTIME 200ml BMR  None         PC-054837   
6        4951303 Johnson's Baby Oil BEDTIME 200ml BMR  None         PC-056188   
7                3255003 Johnson's Baby Oil 200ml BMR  None         PC-056188   
8        4951303 Johnson's Baby Oil BEDTIME 200ml BMR  None         PC-059312   
9        3254803 Johnson's Baby Oil REGULAR 125ml BMR  None         PC-056187   
10           3256204 JH BABY JELLY F.FREE M/E 100 BMR  None         PC-053661   
11          3256304 JH BABY JELLY L.FRA 250 ML ME BMR  None         PC-054621   
12            3249405  JH BABY AQUEOUS CR F/F 350 BMR  None         PC-055536   
13     8737803 Stayfree Maxi Super Wings 16's SCENTED  None         PC-048858   
14   8737903 Stayfree Maxi Super Wings 16's UNSCENTED  None         PC-048858   
15     8737803 Stayfree Maxi Super Wings 16's SCENTED  None        PC-0008672   
16                  2069906 JH BABY JELLY L/F 250 BMR  None         PC-054621   
17   8737903 Stayfree Maxi Super Wings 16's UNSCENTED  None        PC-0008672   
18               2070306 JH BABY JELLY F.FREE 250 BMR  None         PC-054621   
19               3255203 Johnson's Baby Oil 500ml BMR  None         PC-056190   
20  3248106-JOHNSONS BABY BEDTIME AQUEOUS CREAM – ...  None         PC-054629   
21               3255103 Johnson's Baby Oil 300ml BMR  None         PC-056189   
22           Savlon Antiseptic Liquid 500ml - 9384102  None        PC-0014401   
23           Savlon Antiseptic Liquid 500ml - 9384102  None         PC-050410   
24               9142401 JHB AQUEOUS CR FFree 500 BMR  None         PC-055535   
25    9392300 Savlon Antiseptic Liquid 75ml - Dishman  None         PC-050299   
26           Savlon Antiseptic Liquid 750ml - 9392201  None        PC-0014402   
29   Savlon Antiseptic Liquid 500ml - Dishman 9384100  None         PC-050410   
30   Savlon Antiseptic Liquid 750ml - Dishman 9392200  None         PC-050412   
35                  7064305 JH BABY JELLY L/F 500 BMR  None         PC-055535   
43               7142404 JH BABY JELLY F.FREE 500 BMR  None         PC-055535   

                                     CHILD_TITLE_DESC spec_type_inferred   
0                       2109951 CASE Savlon ASL 750ml                 PC  \
1   Shipper - 494 x 241 x 231 mm - RSC- Stayfree -...                 PC   
2   Shipper / 280 x 186 x 183ml / Jelly 325ml / Aq...                 PC   
3   Shipper / 193 x 256 x 127mm / Jelly / Aqueous ...                 PC   
4      Shipper / 310 x 222 x 287mm / Savlon Liquid 2L                 PC   
5   Child Resistant Closure - 24 mm - Inner PP/ Ou...                 PC   
6   BOTTLE THREADED - Baby Oil CRC  - 24mm mediloc...                 PC   
7   BOTTLE THREADED - Baby Oil CRC  - 24mm mediloc...                 PC   
8   SHIPPER / 283 x 212 x 158 / 200 ml CRC JBO bot...                 PC   
9   BOTTLE THREADED - Baby Oil CRC - 18 mm Mediloc...                 PC   
10  Shipper / 193 x 256 x 127mm / Jelly / Aqueous ...                 PC   
11  Shipper / 344 x 259 x 155mm / Jelly / 1st used...                 PC   
12  Shipper / 280 x 186 x 183ml / Jelly 325ml / Aq...                 PC   
13  Intermediate Polybag 415  x 310 x 50/100mm + 3...                 PC   
14  Intermediate Polybag 415  x 310 x 50/100mm + 3...                 PC   
15  Shipper / 540 x 395 x 282mm/ RSC Stayfree SUPE...                 PC   
16  Shipper / 344 x 259 x 155mm / Jelly / 1st used...                 PC   
17  Shipper / 540 x 395 x 282mm/ RSC Stayfree SUPE...                 PC   
18  Shipper / 344 x 259 x 155mm / Jelly / 1st used...                 PC   
19  BOTTLE THREADED - Baby Oil CRC - 28mm Mediloc ...                 PC   
20  Shipper / 264 x 174 x 155mm / Aqueous / 1st us...                 PC   
21  BOTTLE THREADED - Baby Oil CRC - 24mm Mediloc ...                 PC   
22  Bottle Screw - Savlon- 24mm - 500ml - PET - Cl...                 PC   
23  CASE Savlon ASL 500ml and VAP 2 x 500ml // 380...                 PC   
24  Shipper / 280 x 186 x 237ml / Jelly / 1st used...                 PC   
25  BOTTLE THREADED - SAVLON - 24mm - 75 ml - PET ...                 PC   
26  BOTTLE SCREW- Savlon - 33 mm -750ml - PET - Cl...                 PC   
29  CASE Savlon ASL 500ml and VAP 2 x 500ml // 380...                 PC   
30                      2109951 CASE Savlon ASL 750ml                 PC   
35  Shipper / 280 x 186 x 237ml / Jelly / 1st used...                 PC   
43  Shipper / 280 x 186 x 237ml / Jelly / 1st used...                 PC   

                       TEMPL_TYPE_CD        CHILD_TYPE_CD   
0               Corrugated / Shipper  Packaging Component  \
1               Corrugated / Shipper  Packaging Component   
2               Corrugated / Shipper  Packaging Component   
3               Corrugated / Shipper  Packaging Component   
4               Corrugated / Shipper  Packaging Component   
5                            Closure  Packaging Component   
6                      Bottles/ Jars  Packaging Component   
7                      Bottles/ Jars  Packaging Component   
8               Corrugated / Shipper  Packaging Component   
9                      Bottles/ Jars  Packaging Component   
10              Corrugated / Shipper  Packaging Component   
11              Corrugated / Shipper  Packaging Component   
12              Corrugated / Shipper  Packaging Component   
13  Film / Laminates / Pouch and Bag  Packaging Component   
14  Film / Laminates / Pouch and Bag  Packaging Component   
15              Corrugated / Shipper  Packaging Component   
16              Corrugated / Shipper  Packaging Component   
17              Corrugated / Shipper  Packaging Component   
18              Corrugated / Shipper  Packaging Component   
19                     Bottles/ Jars  Packaging Component   
20              Corrugated / Shipper  Packaging Component   
21                     Bottles/ Jars  Packaging Component   
22                     Bottles/ Jars  Packaging Component   
23              Corrugated / Shipper  Packaging Component   
24              Corrugated / Shipper  Packaging Component   
25                     Bottles/ Jars  Packaging Component   
26                     Bottles/ Jars  Packaging Component   
29              Corrugated / Shipper  Packaging Component   
30              Corrugated / Shipper  Packaging Component   
35              Corrugated / Shipper  Packaging Component   
43              Corrugated / Shipper  Packaging Component   

                          ERP_DESC   
0   SAVLON A-SEPT LIQUID 750 ZA-EN  \
1   STAYF MAX THICK REG WGS UNSC 8   
2   JH PH5 AQUEOUS BDYCR VIT E 350   
3    JH LIGHT FRAG JELLY 100 ML ZA   
4   SAVLON A-SEPT LIQUID 2000   ZA   
5         JH BEDTIME OIL 200 ML ZA   
6         JH BEDTIME OIL 200 ML ZA   
7            JH BABY OIL 200 ML ZA   
8         JH BEDTIME OIL 200 ML ZA   
9            JH BABY OIL 125 ML ZA   
10  JH FRAG FREE JELLY 100 ML MENA   
11    JH LIGHT FRAG JELLY 250 MENA   
12     JH F/F AQUEOUS CR 350 ML ZA   
13      STAYF MAXI THICK SUP SC 16   
14    STAYF MAXI THICK SUP UNSC 16   
15      STAYF MAXI THICK SUP SC 16   
16   JH LIGHT FRAG JELLY 250 ML ZA   
17    STAYF MAXI THICK SUP UNSC 16   
18    JH FRAG FREE JELLY 250 ML ZA   
19           JH BABY OIL 500 ML ZA   
20    JH BEDTIME AQUEOUS CR 250 ZA   
21           JH BABY OIL 300 ML ZA   
22  SAVLON A-SEPT LIQUID 500 ZA-EN   
23  SAVLON A-SEPT LIQUID 500 ZA-EN   
24  JH BABY AQUEOUS CR F/FREE  500   
25  SAVLON A-SEPT LIQUID 75  ZA-EN   
26  SAVLON A-SEPT LIQUID 750 ZA-EN   
29  SAVLON A-SEPT LIQUID 500 ZA-EN   
30  SAVLON A-SEPT LIQUID 750 ZA-EN   
35   JH LIGHT FRAG JELLY 500 ML ZA   
43    JH FRAG FREE JELLY 500 ML ZA   

                                text_for_matching_tru   
0                                            case asl  \
1       shipper rsc stayfree st used for maxi regular   
2                         shipper jelly aquoues cream   
3                      shipper aqueous st used for jb   
4                                             shipper   
5   child resistant closure inner pp outer pe colo...   
6          bottle threaded baby crc mediloc pet clear   
7               bottle threaded crc mediloc pet clear   
8            shipper crc jbo bottle st use for grease   
9               bottle threaded crc mediloc pet clear   
10                     shipper aqueous st used for jb   
11                             shipper st used for jb   
12                        shipper jelly aquoues cream   
13                           intermediate polybag lip   
14                           intermediate polybag lip   
15                         shipper rsc stayfree super   
16                             shipper st used for jb   
17                         shipper rsc stayfree super   
18                             shipper st used for jb   
19              bottle threaded crc mediloc pet clear   
20                             shipper st used for jb   
21              bottle threaded crc mediloc pet clear   
22                    bottle screw pet clear astrapak   
23                                       case asl vap   
24                       shipper jelly st used for jb   
25                  bottle threaded pet clear brimful   
26                    bottle screw pet clear astrapak   
29                                       case asl vap   
30                                           case asl   
35                             shipper st used for jb   
43                             shipper st used for jb   

   text_for_matching_tru_trade_names extracted_rm_tru  perc_alpha_char_tru   
0                                                 NaN                  1.0  \
1                                                 NaN                  1.0   
2                                                 NaN                  1.0   
3                                                 NaN                  1.0   
4                                                 NaN                  1.0   
5                                                 NaN                  1.0   
6                                                 NaN                  1.0   
7                                                 NaN                  1.0   
8                                                 NaN                  1.0   
9                                                 NaN                  1.0   
10                                                NaN                  1.0   
11                                                NaN                  1.0   
12                                                NaN                  1.0   
13                                                NaN                  1.0   
14                                                NaN                  1.0   
15                                                NaN                  1.0   
16                                                NaN                  1.0   
17                                                NaN                  1.0   
18                                                NaN                  1.0   
19                                                NaN                  1.0   
20                                                NaN                  1.0   
21                                                NaN                  1.0   
22                                                NaN                  1.0   
23                                                NaN                  1.0   
24                                                NaN                  1.0   
25                                                NaN                  1.0   
26                                                NaN                  1.0   
29                                                NaN                  1.0   
30                                                NaN                  1.0   
35                                                NaN                  1.0   
43                                                NaN                  1.0   

                                   key_tru           SPEC_FLOW_CD   
0    000000000009392201_PC-050412_ZA01_BPA   FG-0051763>PC-050412  \
1   000000000008579603_PC-0017684_ZA01_BPA  FG-0041293>PC-0017684   
2    000000000003258504_PC-055536_ZA01_BPA    FP-071445>PC-055536   
3    000000000002069805_PC-053661_ZA01_BPA   FG-0038506>PC-053661   
4    000000000009384000_PC-053994_ZA01_BPA   FG-0010995>PC-053994   
5    000000000004951303_PC-054837_ZA01_BPA   FG-0007800>PC-054837   
6    000000000004951303_PC-056188_ZA01_BPA   FG-0007800>PC-056188   
7    000000000003255003_PC-056188_ZA01_BPA   FG-0007804>PC-056188   
8    000000000004951303_PC-059312_ZA01_BPA   FG-0007800>PC-059312   
9    000000000003254803_PC-056187_ZA01_BPA   FG-0007803>PC-056187   
10   000000000003256204_PC-053661_ZA01_BPA   FG-0038568>PC-053661   
11   000000000003256304_PC-054621_ZA01_BPA   FG-0038572>PC-054621   
12   000000000003249405_PC-055536_ZA01_BPA   FG-0008871>PC-055536   
13   000000000008737803_PC-048858_ZA01_BPA   FG-0041294>PC-048858   
14   000000000008737903_PC-048858_ZA01_BPA   FG-0041295>PC-048858   
15  000000000008737803_PC-0008672_ZA01_BPA  FG-0041294>PC-0008672   
16   000000000002069906_PC-054621_ZA01_BPA   FG-0038549>PC-054621   
17  000000000008737903_PC-0008672_ZA01_BPA  FG-0041295>PC-0008672   
18   000000000002070306_PC-054621_ZA01_BPA   FG-0038557>PC-054621   
19   000000000003255203_PC-056190_ZA01_BPA   FG-0007806>PC-056190   
20   000000000003248106_PC-054629_ZA01_BPA   FG-0008683>PC-054629   
21   000000000003255103_PC-056189_ZA01_BPA   FG-0007805>PC-056189   
22  000000000009384102_PC-0014401_ZA01_BPA  FG-0051762>PC-0014401   
23   000000000009384102_PC-050410_ZA01_BPA   FG-0051762>PC-050410   
24   000000000009142401_PC-055535_ZA01_BPA   FG-0008876>PC-055535   
25   000000000009392300_PC-050299_ZA01_BPA   FG-0010920>PC-050299   
26  000000000009392201_PC-0014402_ZA01_BPA  FG-0051763>PC-0014402   
29   000000000009384100_PC-050410_ZA01_BPA   FG-0010993>PC-050410   
30   000000000009392200_PC-050412_ZA01_BPA   FG-0010994>PC-050412   
35   000000000007064305_PC-055535_ZA01_BPA   FG-0038565>PC-055535   
43   000000000007142404_PC-055535_ZA01_BPA   FG-0038566>PC-055535   

   TRD_NM_CONCAT TRD_NM_FULL  matching_score unified_mat_code  is_matched   
0            NaN         NaN               1          9392201        True  \
1            NaN         NaN               1          8579603        True   
2            NaN         NaN               1          3258504        True   
3            NaN         NaN               1          2069805        True   
4            NaN         NaN               1          9384000        True   
5            NaN         NaN               1          4951303        True   
6            NaN         NaN               1          4951303        True   
7            NaN         NaN               1          3255003        True   
8            NaN         NaN               1          4951303        True   
9            NaN         NaN               1          3254803        True   
10           NaN         NaN               1          3256204        True   
11           NaN         NaN               1          3256304        True   
12           NaN         NaN               1          3249405        True   
13           NaN         NaN               1          8737803        True   
14           NaN         NaN               1          8737903        True   
15           NaN         NaN               1          8737803        True   
16           NaN         NaN               1          2069906        True   
17           NaN         NaN               1          8737903        True   
18           NaN         NaN               1          2070306        True   
19           NaN         NaN               1          3255203        True   
20           NaN         NaN               1          3248106        True   
21           NaN         NaN               1          3255103        True   
22           NaN         NaN               1          9384102        True   
23           NaN         NaN               1          9384102        True   
24           NaN         NaN               1          9142401        True   
25           NaN         NaN               1          9392300        True   
26           NaN         NaN               1          9392201        True   
29           NaN         NaN               1          9384100        True   
30           NaN         NaN               1          9392200        True   
35           NaN         NaN               1          7064305        True   
43           NaN         NaN               1          7142404        True   

                                   Matching Reason confidence   
0   matches_Potential_PC_DC_Spec suggested X-match       high  \
1   matches_Potential_PC_DC_Spec suggested X-match       high   
2   matches_Potential_PC_DC_Spec suggested X-match       high   
3   matches_Potential_PC_DC_Spec suggested X-match       high   
4   matches_Potential_PC_DC_Spec suggested X-match       high   
5   matches_Potential_PC_DC_Spec suggested X-match       high   
6   matches_Potential_PC_DC_Spec suggested X-match       high   
7   matches_Potential_PC_DC_Spec suggested X-match       high   
8   matches_Potential_PC_DC_Spec suggested X-match       high   
9   matches_Potential_PC_DC_Spec suggested X-match       high   
10  matches_Potential_PC_DC_Spec suggested X-match       high   
11  matches_Potential_PC_DC_Spec suggested X-match       high   
12  matches_Potential_PC_DC_Spec suggested X-match       high   
13  matches_Potential_PC_DC_Spec suggested X-match       high   
14  matches_Potential_PC_DC_Spec suggested X-match       high   
15  matches_Potential_PC_DC_Spec suggested X-match       high   
16  matches_Potential_PC_DC_Spec suggested X-match       high   
17  matches_Potential_PC_DC_Spec suggested X-match       high   
18  matches_Potential_PC_DC_Spec suggested X-match       high   
19  matches_Potential_PC_DC_Spec suggested X-match       high   
20  matches_Potential_PC_DC_Spec suggested X-match       high   
21  matches_Potential_PC_DC_Spec suggested X-match       high   
22  matches_Potential_PC_DC_Spec suggested X-match       high   
23  matches_Potential_PC_DC_Spec suggested X-match       high   
24  matches_Potential_PC_DC_Spec suggested X-match       high   
25  matches_Potential_PC_DC_Spec suggested X-match       high   
26  matches_Potential_PC_DC_Spec suggested X-match       high   
29  matches_Potential_PC_DC_Spec suggested X-match       high   
30  matches_Potential_PC_DC_Spec suggested X-match       high   
35  matches_Potential_PC_DC_Spec suggested X-match       high   
43  matches_Potential_PC_DC_Spec suggested X-match       high   

                                          match_round  
0   13: matches_Potential_PC_DC_Spec suggested X-m...  
1   13: matches_Potential_PC_DC_Spec suggested X-m...  
2   13: matches_Potential_PC_DC_Spec suggested X-m...  
3   13: matches_Potential_PC_DC_Spec suggested X-m...  
4   13: matches_Potential_PC_DC_Spec suggested X-m...  
5   13: matches_Potential_PC_DC_Spec suggested X-m...  
6   13: matches_Potential_PC_DC_Spec suggested X-m...  
7   13: matches_Potential_PC_DC_Spec suggested X-m...  
8   13: matches_Potential_PC_DC_Spec suggested X-m...  
9   13: matches_Potential_PC_DC_Spec suggested X-m...  
10  13: matches_Potential_PC_DC_Spec suggested X-m...  
11  13: matches_Potential_PC_DC_Spec suggested X-m...  
12  13: matches_Potential_PC_DC_Spec suggested X-m...  
13  13: matches_Potential_PC_DC_Spec suggested X-m...  
14  13: matches_Potential_PC_DC_Spec suggested X-m...  
15  13: matches_Potential_PC_DC_Spec suggested X-m...  
16  13: matches_Potential_PC_DC_Spec suggested X-m...  
17  13: matches_Potential_PC_DC_Spec suggested X-m...  
18  13: matches_Potential_PC_DC_Spec suggested X-m...  
19  13: matches_Potential_PC_DC_Spec suggested X-m...  
20  13: matches_Potential_PC_DC_Spec suggested X-m...  
21  13: matches_Potential_PC_DC_Spec suggested X-m...  
22  13: matches_Potential_PC_DC_Spec suggested X-m...  
23  13: matches_Potential_PC_DC_Spec suggested X-m...  
24  13: matches_Potential_PC_DC_Spec suggested X-m...  
25  13: matches_Potential_PC_DC_Spec suggested X-m...  
26  13: matches_Potential_PC_DC_Spec suggested X-m...  
29  13: matches_Potential_PC_DC_Spec suggested X-m...  
30  13: matches_Potential_PC_DC_Spec suggested X-m...  
35  13: matches_Potential_PC_DC_Spec suggested X-m...  
43  13: matches_Potential_PC_DC_Spec suggested X-m...  
------------------------------------------------------------
Amount of current matches:  248885
       SRC_SYS_CD            MATL_NUM   MATL_NUM_original   
0             US1  000000000512521800  000000000512521800  \
1             US1  000000000510007126  000000000510007126   
2             US1  000000000510030130  000000000510030130   
3             US1  000000000510030130  000000000510030130   
4             US1  000000000510030130  000000000510030130   
...           ...                 ...                 ...   
248880        BPC  000000000005985402             5985402   
248881        BPC  000000000005985402             5985402   
248882        CAP  000000000079632185  000000000079632185   
248883        CAP  000000000079632254  000000000079632254   
248884       VPAK  000000000681127505           681127505   

                                  MATL_SHRT_DESC        PLNT_CD   
0          POLYSPORIN PLUS CREAM 30G-CA100025218           US11  \
1                    DESITIN MAXIMUM STRENGTH 4Z           US11   
2       DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z           US11   
3       DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z           US11   
4       DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z           US11   
...                                          ...            ...   
248880                  JH 24HM SOFT BODY CR 300           EG04   
248881                  JH 24HM SOFT BODY CR 300           EG04   
248882    Listerine CoolMint 750ml (MK) TH 23GD+           240A   
248883         Listerine CoolMint 750ml VN 23GD+           240A   
248884                                   unknown  External_VPAK   

       CMPNT_MATL_TYPE_CD CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
0                     ROH        RM04380                 RM04380  \
1                     ROH       RM000236                RM000236   
2                     ROH       RM000465                RM000465   
3                     ROH        RM04380                 RM04380   
4                     ROH       RM000236                RM000236   
...                   ...            ...                     ...   
248880                  P     PMC0901298              PMC0901298   
248881                  P     PMC0901316              PMC0901316   
248882               PACK        6142503      000000000006142503   
248883               PACK        6142503      000000000006142503   
248884               None         696127                  696127   

                              CMPNT_MATL_DESC         text_for_matching_erp   
0                       WHITE MINERAL OIL USP             white mineral oil  \
1        SORBITAN SESQUIOLEATE VEG  RM-000236     sorbitan sesquioleate veg   
2                PEG-30 DIPOLYHYDROXYSTEARATE  peg 30 dipolyhydroxystearate   
3                       WHITE MINERAL OIL USP             white mineral oil   
4        SORBITAN SESQUIOLEATE VEG  RM-000236     sorbitan sesquioleate veg   
...                                       ...                           ...   
248880         Label side F. soft cream 300 m              label side cream   
248881         Label side B. soft cream 300 m              label side cream   
248882  6132355 SHD Listerine CM 750ml TH GD+                     shd cm gd   
248883  6132355 SHD Listerine CM 750ml TH GD+                  shd cm th gd   
248884        SHPR NEUT ULTRA GEL CLNSR 5.8oz     shpr neut ultra gel clnsr   

       extracted_rm_erp  perc_alpha_char_erp   
0               rm04380             1.000000  \
1              rm000236             1.000000   
2              rm000465             0.923077   
3               rm04380             1.000000   
4              rm000236             1.000000   
...                 ...                  ...   
248880              NaN             1.000000   
248881              NaN             1.000000   
248882              NaN             1.000000   
248883              NaN             1.000000   
248884              NaN             1.000000   

                                             key_erp RGN_CD   
0                000000000512521800_RM04380_US11_US1    NaN  \
1               000000000510007126_RM000236_US11_US1    NaN   
2               000000000510030130_RM000465_US11_US1    NaN   
3                000000000510030130_RM04380_US11_US1    NaN   
4               000000000510030130_RM000236_US11_US1    NaN   
...                                              ...    ...   
248880        000000000005985402_PMC0901298_EG04_BPC   EMEA   
248881        000000000005985402_PMC0901316_EG04_BPC   EMEA   
248882           000000000079632185_6142503_240A_CAP   APAC   
248883           000000000079632254_6142503_240A_CAP   APAC   
248884  000000000681127505_696127_External_VPAK_VPAK    NaN   

                   mat_num MATL_NUM_original_tru_ref      mat_num_padded   
0       000000000512521800        000000000512521800  000000000512521800  \
1       000000000510007126        000000000510007126  000000000510007126   
2       000000000510030130        000000000510030130  000000000510030130   
3       000000000510030130        000000000510030130  000000000510030130   
4       000000000510030130        000000000510030130  000000000510030130   
...                    ...                       ...                 ...   
248880  000000000005985402                   5985402  000000000005985402   
248881  000000000005985402                   5985402  000000000005985402   
248882  000000000079632185        000000000079632185  000000000079632185   
248883  000000000079632254        000000000079632254  000000000079632254   
248884  000000000681127505                 681127505  000000000681127505   

          mat_num_original       FG_NM   
0       000000000512521800  FG-0012075  \
1       000000000510007126   FP-064291   
2       000000000510030130  FG-0002132   
3       000000000510030130  FG-0002132   
4       000000000510030130  FG-0002132   
...                    ...         ...   
248880  000000000005985402  FG-0019126   
248881  000000000005985402  FG-0019126   
248882  000000000079632185  FG-0042313   
248883  000000000079632254  FG-0041952   
248884  000000000681127505  FG-0031673   

                                               FG_SPEC_NM       FD_NM   
0       100025218 Polysporin Antibiotic Cream - Plus P...  FD-0000207  \
1       Desitin Maximum Strength Zinc Oxide Diaper Ras...   PF-010959   
2       Desitin® Daily Defense – Zinc Oxide Diaper Ras...   PF-011268   
3       Desitin® Daily Defense – Zinc Oxide Diaper Ras...   PF-011268   
4       Desitin® Daily Defense – Zinc Oxide Diaper Ras...   PF-011268   
...                                                   ...         ...   
248880  5985402 Johnsons 24hour Moisture soft cream 30...        None   
248881  5985402 Johnsons 24hour Moisture soft cream 30...        None   
248882  Listerine/Listerine Cool Mint/750ml/EN/TH/7963...        None   
248883  Listerine/Listerine Cool Mint/750ml/EN/VN/7963...        None   
248884  681127505-Neutrogena Ultra Gentle Daily Cleans...        None   

          CHILD_NM CHILD_NM_original   
0          RM04380           RM04380  \
1        RM-000236         RM-000236   
2        RM-000465         RM-000465   
3          RM04380           RM04380   
4        RM-000236         RM-000236   
...            ...               ...   
248880  DC-0074081        DC-0074081   
248881  DC-0074081        DC-0074081   
248882  PC-0010002        PC-0010002   
248883  PC-0010002        PC-0010002   
248884  DC-0022654        DC-0022654   

                                         CHILD_TITLE_DESC spec_type_inferred   
0       MINERAL OIL, USP/NF (Master specification numb...                 RM  \
1       Sorbitan Sesquioleate (Master specification nu...                 RM   
2       PEG‐30 Dipolyhydroxystearate (Master Specifica...                 RM   
3       MINERAL OIL, USP/NF (Master specification numb...                 RM   
4       Sorbitan Sesquioleate (Master specification nu...                 RM   
...                                                   ...                ...   
248880  Johnsons 24hour Moisture soft cream 300 gm_Lab...                 DC   
248881  Johnsons 24hour Moisture soft cream 300 gm_Lab...                 DC   
248882  SHOULDER LABEL - Listerine - 750mL - 84 x 28 m...                 PC   
248883  SHOULDER LABEL - Listerine - 750mL - 84 x 28 m...                 PC   
248884  "30045932 Generic Shipper Neutrogena 9"" x 6-1...                 DC   

                       TEMPL_TYPE_CD        CHILD_TYPE_CD   
0                               None           INGREDIENT  \
1                               None           INGREDIENT   
2                               None           INGREDIENT   
3                               None           INGREDIENT   
4                               None           INGREDIENT   
...                              ...                  ...   
248880                          None  Decorated Component   
248881                          None  Decorated Component   
248882  Labels / Leaflets / Booklets  Packaging Component   
248883  Labels / Leaflets / Booklets  Packaging Component   
248884                          None  Decorated Component   

                                        ERP_DESC   
0          POLYSPORIN PLUS CREAM 30G-CA100025218  \
1                    DESITIN MAXIMUM STRENGTH 4Z   
2       DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z   
3       DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z   
4       DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z   
...                                          ...   
248880            JH 24HM SOFT BODY CR 300 AR/EN   
248881            JH 24HM SOFT BODY CR 300 AR/EN   
248882    Listerine CoolMint 750ml (MK) TH 23GD+   
248883         Listerine CoolMint 750ml VN 23GD+   
248884  NTG ULTRA GENTLE DAILY CLNSR FF 5.8 FLOZ   

                               text_for_matching_tru   
0                                        mineral oil  \
1                              sorbitan sesquioleate   
2                          peg dipolyhydroxystearate   
3                                        mineral oil   
4                              sorbitan sesquioleate   
...                                              ...   
248880  johnsons hour moisture cream gm label bundle   
248881  johnsons hour moisture cream gm label bundle   
248882                   shoulder label pp white mcc   
248883                   shoulder label pp white mcc   
248884         generic shipper neutrogena usa canada   

                  text_for_matching_tru_trade_names extracted_rm_tru   
0                                                            rm04380  \
1                                                           rm000236   
2       cithrol ap pis pharma so br sabowax dphs mv         rm000465   
3              oil drakeol min kaydol white mineral          rm04380   
4       mbal lq sg sp 83lq mv ap montane 83 span vg         rm000236   
...                                             ...              ...   
248880                                                           NaN   
248881                                                           NaN   
248882                                                           NaN   
248883                                                           NaN   
248884                                                           NaN   

        perc_alpha_char_tru                                           key_tru   
0                       1.0               000000000512521800_RM04380_US11_US1  \
1                       1.0             000000000510007126_RM-000236_US11_US1   
2                       1.0             000000000510030130_RM-000465_US11_US1   
3                       1.0               000000000510030130_RM04380_US11_US1   
4                       1.0             000000000510030130_RM-000236_US11_US1   
...                     ...                                               ...   
248880                  1.0            000000000005985402_DC-0074081_EG04_BPC   
248881                  1.0            000000000005985402_DC-0074081_EG04_BPC   
248882                  1.0            000000000079632185_PC-0010002_240A_CAP   
248883                  1.0            000000000079632254_PC-0010002_240A_CAP   
248884                  1.0  000000000681127505_DC-0022654_External_VPAK_VPAK   

                                SPEC_FLOW_CD   
0          FG-0012075 > FD-0000207 > RM04380  \
1          FP-064291 > PF-010959 > RM-000236   
2         FG-0002132 > PF-011268 > RM-000465   
3           FG-0002132 > PF-011268 > RM04380   
4         FG-0002132 > PF-011268 > RM-000236   
...                                      ...   
248880   FG-0019126 > DC-0074081 > PC-043036   
248881   FG-0019126 > DC-0074081 > PC-043036   
248882  FG-0042313 > DC-0063578 > PC-0010002   
248883                 FG-0041952>PC-0010002   
248884  FG-0031673 > DC-0022654 > PC-0005393   

                                            TRD_NM_CONCAT   
0                                                     NaN  \
1                                                     NaN   
2       cithrol dphs pharma-so-(br)||cithrol dphs so a...   
3        kaydol white mineral oil||drakeol 35 min oil usp   
4       montane 83 vg||sp span 83 mbal-lq-(ap)||sp spa...   
...                                                   ...   
248880                                                NaN   
248881                                                NaN   
248882                                                NaN   
248883                                                NaN   
248884                                                NaN   

                                              TRD_NM_FULL  matching_score   
0                                                     NaN               1  \
1                                                     NaN               1   
2       cithrol ap pis pharma-so-(br) sabowax so dphs ...               1   
3             35 oil drakeol min kaydol white mineral usp               1   
4       mbal-lq-(sg) sp 83-lq-(mv) mbal-lq-(ap) montan...               1   
...                                                   ...             ...   
248880                                                NaN               1   
248881                                                NaN               1   
248882                                                NaN               1   
248883                                                NaN               1   
248884                                                NaN               1   

          unified_mat_code  is_matched                      Matching Reason   
0       000000000512521800        True       ERP Part ID and Tru Spec match  \
1       000000000510007126        True       ERP Part ID and Tru Spec match   
2       000000000510030130        True       ERP Part ID and Tru Spec match   
3       000000000510030130        True       ERP Part ID and Tru Spec match   
4       000000000510030130        True       ERP Part ID and Tru Spec match   
...                    ...         ...                                  ...   
248880             5985402        True  PC and DC mentioned in SPEC_FLOW_CD   
248881             5985402        True  PC and DC mentioned in SPEC_FLOW_CD   
248882  000000000079632185        True  PC and DC mentioned in SPEC_FLOW_CD   
248883  000000000079632254        True  PC and DC mentioned in SPEC_FLOW_CD   
248884           681127505        True  PC and DC mentioned in SPEC_FLOW_CD   

       confidence                                match_round  
0            high                     1: ERP Part vs RM Spec  
1            high                     1: ERP Part vs RM Spec  
2            high                     1: ERP Part vs RM Spec  
3            high                     1: ERP Part vs RM Spec  
4            high                     1: ERP Part vs RM Spec  
...           ...                                        ...  
248880       high  5: matches_NLP_list_ERP suggested X-match  
248881       high  5: matches_NLP_list_ERP suggested X-match  
248882       high  5: matches_NLP_list_ERP suggested X-match  
248883       high  5: matches_NLP_list_ERP suggested X-match  
248884       high  5: matches_NLP_list_ERP suggested X-match  

[248885 rows x 42 columns]

=== MATCH ROUND 14: Self Learnt through other products with similar BOM ===

✅ DEBUG 7a: Before ERP + REF merge
Checking TRU for PC-008694 before ERP+TRU merge in Self Learnt through other products with similar BOM
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num]
Index: []

=== END DEBUG ===


✅ DEBUG 7b: Before ERP+TRU merge
Checking ERP for CMPNT_MATL_NUM = 30055433 in Self Learnt through other products with similar BOM
Empty DataFrame
Columns: [CMPNT_MATL_NUM, MATL_NUM, SRC_SYS_CD, PLNT_CD]
Index: []
Checking TRU for PC-008694 before ERP+TRU merge in Self Learnt through other products with similar BOM
Empty DataFrame
Columns: [CHILD_NM, CHILD_NM, mat_num, SRC_SYS_CD, PLNT_CD]
Index: []

✅ DEBUG 7c: After ERP+TRU merge
Empty DataFrame
Columns: [CMPNT_MATL_NUM, CHILD_NM, CMPNT_MATL_NUM, CHILD_NM, SRC_SYS_CD, PLNT_CD]
Index: []
❌ ALERT: PC-008694 did not match in this merge
****** Adding 597 more matches based on SPEC_FLOW_CD
14: Self Learnt through other products with similar BOM round matched: 2499 (1.2 seconds)
df_erp_to_match cases:  136383
df_tru_to_match cases:  114972
Amount of current matches:  251384
     SRC_SYS_CD            MATL_NUM   MATL_NUM_original   
0           US1  000000000512521800  000000000512521800  \
1           US1  000000000510007126  000000000510007126   
2           US1  000000000510030130  000000000510030130   
3           US1  000000000510030130  000000000510030130   
4           US1  000000000510030130  000000000510030130   
...         ...                 ...                 ...   
2922       LEKU  000000000111819177           111819177   
2923       KDLE  000000000111947002           111947002   
2924       KDLE  000000000110239009           110239009   
2927       GPLT  000000000005493708             5493708   
2928       GPLT  000000000005493708             5493708   

                                MATL_SHRT_DESC        PLNT_CD   
0        POLYSPORIN PLUS CREAM 30G-CA100025218           US11  \
1                  DESITIN MAXIMUM STRENGTH 4Z           US11   
2     DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z           US11   
3     DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z           US11   
4     DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z           US11   
...                                        ...            ...   
2922                                   unknown  External_LEKU   
2923                                   unknown  External_KDLE   
2924                                   unknown  External_KDLE   
2927                                   unknown  External_GPLT   
2928                                   unknown  External_GPLT   

     CMPNT_MATL_TYPE_CD CMPNT_MATL_NUM CMPNT_MATL_NUM_original   
0                   ROH        RM04380                 RM04380  \
1                   ROH       RM000236                RM000236   
2                   ROH       RM000465                RM000465   
3                   ROH        RM04380                 RM04380   
4                   ROH       RM000236                RM000236   
...                 ...            ...                     ...   
2922               None       30050498                30050498   
2923               None       30045708                30045708   
2924               None       30045708                30045708   
2927               None         211635                  211635   
2928               None         211634                  211634   

                                        CMPNT_MATL_DESC   
0                                 WHITE MINERAL OIL USP  \
1                  SORBITAN SESQUIOLEATE VEG  RM-000236   
2                          PEG-30 DIPOLYHYDROXYSTEARATE   
3                                 WHITE MINERAL OIL USP   
4                  SORBITAN SESQUIOLEATE VEG  RM-000236   
...                                                 ...   
2922                      AV.POS.SKIN BR/SCRUB 7OZ SHPR   
2923                           BK LBL AVNBY DW&S 18FLOZ   
2924                           BK LBL AVNBY DW&S 18FLOZ   
2927         BACK LABEL JOHNSON BABY REGULAR OIL 200 ML   
2928  FRONT LABEL JOHNSON BABY REGULAR OIL 200 ML - CRC   

                         text_for_matching_erp extracted_rm_erp   
0                            white mineral oil          rm04380  \
1                    sorbitan sesquioleate veg         rm000236   
2                 peg 30 dipolyhydroxystearate         rm000465   
3                            white mineral oil          rm04380   
4                    sorbitan sesquioleate veg         rm000236   
...                                        ...              ...   
2922                 av pos skin br scrub shpr              NaN   
2923                           bk lbl avnby dw              NaN   
2924                           bk lbl avnby dw              NaN   
2927       back label johnson baby regular oil              NaN   
2928  front label johnson baby regular oil crc              NaN   

      perc_alpha_char_erp                                         key_erp   
0                1.000000             000000000512521800_RM04380_US11_US1  \
1                1.000000            000000000510007126_RM000236_US11_US1   
2                0.923077            000000000510030130_RM000465_US11_US1   
3                1.000000             000000000510030130_RM04380_US11_US1   
4                1.000000            000000000510030130_RM000236_US11_US1   
...                   ...                                             ...   
2922             1.000000  000000000111819177_30050498_External_LEKU_LEKU   
2923             1.000000  000000000111947002_30045708_External_KDLE_KDLE   
2924             1.000000  000000000110239009_30045708_External_KDLE_KDLE   
2927             1.000000    000000000005493708_211635_External_GPLT_GPLT   
2928             1.000000    000000000005493708_211634_External_GPLT_GPLT   

     RGN_CD             mat_num MATL_NUM_original_tru_ref      mat_num_padded   
0       NaN  000000000512521800        000000000512521800  000000000512521800  \
1       NaN  000000000510007126        000000000510007126  000000000510007126   
2       NaN  000000000510030130        000000000510030130  000000000510030130   
3       NaN  000000000510030130        000000000510030130  000000000510030130   
4       NaN  000000000510030130        000000000510030130  000000000510030130   
...     ...                 ...                       ...                 ...   
2922    NaN  000000000111819177                 111819177  000000000111819177   
2923    NaN  000000000111947002                 111947002  000000000111947002   
2924    NaN  000000000110239009                 110239009  000000000110239009   
2927   EMEA  000000000005493708                   5493708  000000000005493708   
2928   EMEA  000000000005493708                   5493708  000000000005493708   

        mat_num_original       FG_NM   
0     000000000512521800  FG-0012075  \
1     000000000510007126   FP-064291   
2     000000000510030130  FG-0002132   
3     000000000510030130  FG-0002132   
4     000000000510030130  FG-0002132   
...                  ...         ...   
2922  000000000111819177  FG-0025043   
2923  000000000111947002  FG-0019885   
2924  000000000110239009  FG-0017061   
2927  000000000005493708   FP-026872   
2928  000000000005493708   FP-026872   

                                             FG_SPEC_NM       FD_NM   
0     100025218 Polysporin Antibiotic Cream - Plus P...  FD-0000207  \
1     Desitin Maximum Strength Zinc Oxide Diaper Ras...   PF-010959   
2     Desitin® Daily Defense – Zinc Oxide Diaper Ras...   PF-011268   
3     Desitin® Daily Defense – Zinc Oxide Diaper Ras...   PF-011268   
4     Desitin® Daily Defense – Zinc Oxide Diaper Ras...   PF-011268   
...                                                 ...         ...   
2922  111819177 - Aveeno Positively Radiant Brighten...        None   
2923  111947002  Aveeno Baby Daily Moisture Wash & S...        None   
2924  Aveeno Baby Daily Moisture Wash and Shampoo 18...        None   
2927  5493708, Johnson’s Baby Oil, Regular 200 ml, EMEA        None   
2928  5493708, Johnson’s Baby Oil, Regular 200 ml, EMEA        None   

        CHILD_NM CHILD_NM_original   
0        RM04380           RM04380  \
1      RM-000236         RM-000236   
2      RM-000465         RM-000465   
3        RM04380           RM04380   
4      RM-000236         RM-000236   
...          ...               ...   
2922  DC-0094573        DC-0094573   
2923  DC-0096039        DC-0096039   
2924  DC-0094022        DC-0094022   
2927   PC-029914         PC-029914   
2928   PC-029914         PC-029914   

                                       CHILD_TITLE_DESC spec_type_inferred   
0     MINERAL OIL, USP/NF (Master specification numb...                 RM  \
1     Sorbitan Sesquioleate (Master specification nu...                 RM   
2     PEG‐30 Dipolyhydroxystearate (Master Specifica...                 RM   
3     MINERAL OIL, USP/NF (Master specification numb...                 RM   
4     Sorbitan Sesquioleate (Master specification nu...                 RM   
...                                                 ...                ...   
2922  30060352 Shipper Aveeno Positively Radiant Bri...                 DC   
2923  30060773 – Back Label - Aveeno Baby Daily Mois...                 DC   
2924  30059993, BK LBL, Aveeno Baby Daily Moisture W...                 DC   
2927  LABEL Front and Back - 46.13 mm x 95.00 mm - J...                 PC   
2928  LABEL Front and Back - 46.13 mm x 95.00 mm - J...                 PC   

                     TEMPL_TYPE_CD        CHILD_TYPE_CD   
0                             None           INGREDIENT  \
1                             None           INGREDIENT   
2                             None           INGREDIENT   
3                             None           INGREDIENT   
4                             None           INGREDIENT   
...                            ...                  ...   
2922                          None  Decorated Component   
2923                          None  Decorated Component   
2924                          None  Decorated Component   
2927  Labels / Leaflets / Booklets  Packaging Component   
2928  Labels / Leaflets / Booklets  Packaging Component   

                                      ERP_DESC   
0        POLYSPORIN PLUS CREAM 30G-CA100025218  \
1                  DESITIN MAXIMUM STRENGTH 4Z   
2     DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z   
3     DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z   
4     DESITIN DAILY DEFENSE DIAPER RSH CREAM4Z   
...                                        ...   
2922  AVEENO PR SKIN BRIGHT DAILYSCRUB TUBE 7Z   
2923    AVEENO BABY WASH&SHAMPOO 3-18FZ ECMSPK   
2924     AVEENO BABY DAILY WASH & SHAMPOO 18FZ   
2927                   JH BABY OIL 200 ML MENA   
2928                   JH BABY OIL 200 ML MENA   

                                  text_for_matching_tru   
0                                           mineral oil  \
1                                 sorbitan sesquioleate   
2                             peg dipolyhydroxystearate   
3                                           mineral oil   
4                                 sorbitan sesquioleate   
...                                                 ...   
2922  shipper positively radiant brightening scrub n...   
2923                back label daily moisture fl oz usa   
2924                       bk lbl moisture fl oz canada   
2927                                   label front back   
2928                                   label front back   

                text_for_matching_tru_trade_names extracted_rm_tru   
0                                                          rm04380  \
1                                                         rm000236   
2     cithrol ap pis pharma so br sabowax dphs mv         rm000465   
3            oil drakeol min kaydol white mineral          rm04380   
4     mbal lq sg sp 83lq mv ap montane 83 span vg         rm000236   
...                                           ...              ...   
2922                                                           NaN   
2923                                                           NaN   
2924                                                           NaN   
2927                                                           NaN   
2928                                                           NaN   

      perc_alpha_char_tru                                           key_tru   
0                     1.0               000000000512521800_RM04380_US11_US1  \
1                     1.0             000000000510007126_RM-000236_US11_US1   
2                     1.0             000000000510030130_RM-000465_US11_US1   
3                     1.0               000000000510030130_RM04380_US11_US1   
4                     1.0             000000000510030130_RM-000236_US11_US1   
...                   ...                                               ...   
2922                  1.0  000000000111819177_DC-0094573_External_LEKU_LEKU   
2923                  1.0  000000000111947002_DC-0096039_External_KDLE_KDLE   
2924                  1.0  000000000110239009_DC-0094022_External_KDLE_KDLE   
2927                  1.0   000000000005493708_PC-029914_External_GPLT_GPLT   
2928                  1.0   000000000005493708_PC-029914_External_GPLT_GPLT   

                              SPEC_FLOW_CD   
0        FG-0012075 > FD-0000207 > RM04380  \
1        FP-064291 > PF-010959 > RM-000236   
2       FG-0002132 > PF-011268 > RM-000465   
3         FG-0002132 > PF-011268 > RM04380   
4       FG-0002132 > PF-011268 > RM-000236   
...                                    ...   
2922  FG-0025043 > DC-0094573 > PC-0001407   
2923  FG-0019885 > DC-0096039 > PC-0005960   
2924  FG-0017061 > DC-0094022 > PC-0005960   
2927    FP-026872 > DC-0071828 > PC-029914   
2928    FP-026872 > DC-0071828 > PC-029914   

                                          TRD_NM_CONCAT   
0                                                   NaN  \
1                                                   NaN   
2     cithrol dphs pharma-so-(br)||cithrol dphs so a...   
3      kaydol white mineral oil||drakeol 35 min oil usp   
4     montane 83 vg||sp span 83 mbal-lq-(ap)||sp spa...   
...                                                 ...   
2922                                                NaN   
2923                                                NaN   
2924                                                NaN   
2927                                                NaN   
2928                                                NaN   

                                            TRD_NM_FULL  matching_score   
0                                                   NaN               1  \
1                                                   NaN               1   
2     cithrol ap pis pharma-so-(br) sabowax so dphs ...               1   
3           35 oil drakeol min kaydol white mineral usp               1   
4     mbal-lq-(sg) sp 83-lq-(mv) mbal-lq-(ap) montan...               1   
...                                                 ...             ...   
2922                                                NaN               1   
2923                                                NaN               1   
2924                                                NaN               1   
2927                                                NaN               1   
2928                                                NaN               1   

        unified_mat_code  is_matched                      Matching Reason   
0     000000000512521800        True       ERP Part ID and Tru Spec match  \
1     000000000510007126        True       ERP Part ID and Tru Spec match   
2     000000000510030130        True       ERP Part ID and Tru Spec match   
3     000000000510030130        True       ERP Part ID and Tru Spec match   
4     000000000510030130        True       ERP Part ID and Tru Spec match   
...                  ...         ...                                  ...   
2922           111819177        True  PC and DC mentioned in SPEC_FLOW_CD   
2923           111947002        True  PC and DC mentioned in SPEC_FLOW_CD   
2924           110239009        True  PC and DC mentioned in SPEC_FLOW_CD   
2927             5493708        True  PC and DC mentioned in SPEC_FLOW_CD   
2928             5493708        True  PC and DC mentioned in SPEC_FLOW_CD   

     confidence                                        match_round  
0          high                             1: ERP Part vs RM Spec  
1          high                             1: ERP Part vs RM Spec  
2          high                             1: ERP Part vs RM Spec  
3          high                             1: ERP Part vs RM Spec  
4          high                             1: ERP Part vs RM Spec  
...         ...                                                ...  
2922       high  14: Self Learnt through other products with si...  
2923       high  14: Self Learnt through other products with si...  
2924       high  14: Self Learnt through other products with si...  
2927       high  14: Self Learnt through other products with si...  
2928       high  14: Self Learnt through other products with si...  

[251384 rows x 42 columns]
------------------------------------------------------------
MATCH ROUND 15: Jaccard Similarity
Unique combinations to process:  17108
Doing 4277 out of 17108 tasks (25)
Current UTC Time: 2025-07-04 17:23:56 UTC
Doing 8554 out of 17108 tasks (50)
Current UTC Time: 2025-07-04 17:27:38 UTC
Doing 12831 out of 17108 tasks (75)
Current UTC Time: 2025-07-04 17:40:21 UTC
Doing 17108 out of 17108 tasks (100)
Current UTC Time: 2025-07-04 17:52:52 UTC
Matches broken by being know rejections:  81
Matches broken by being wrong type  (PACK/FERT vs RM):  0
****** Adding 1405 more matches based on SPEC_FLOW_CD
15: Jaccard Similarity round matched: 35426 (2073.03 seconds)
Amount of current matches:  286810
df_erp_to_match cases:  102351
df_tru_to_match cases:  79674
------------------------------------------------------------
MATCH ROUND 16: Leven Similarity
Unique combinations to process:  15909
