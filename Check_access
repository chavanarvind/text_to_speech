WITH input_pairs AS (
    SELECT * FROM (
        VALUES
            ("000000000006112041","PC-0021087"),("000000000006008676","PC-0001164"),("000000000006059750","SOP-PTC-14"),("000000000006143326","PC-0010229"),("000000000006008360","PC-0001169"),("000000000006097858","SOP-PTC-13"),("000000000006060323","PC-0001170"),("000000000006097612","PC-0007734"),("000000000006139654","PC-0000457"),("000000000006132572","PC-0012208"),("000000000006143311","PC-0010229"),("000000000006107462","PC-0018084"),("000000000006007409","PC-0021095"),("000000000006021586","PM6021577-CN"),("000000000006084475","PC-046533"),("000000000006078828","PC-0000593"),("000000000006008383","PC-0000385"),("000000000006134642","PC-0014894"),("000000000006089058","SOP-PTC-12"),("000000000006132730","PC-0011929"),("000000000006134683","PC-0014367"),("000000000006112209","PC-037264"),("000000000006144469","PC-0009593"),("000000000006139655","PC-0000457"),("000000000006143649","PC-0018983"),("000000000006139668","PC-0000457"),("000000000006106729","PC-0012530"),("000000000006139653","PC-0000457"),("000000000006140979","PC-0016720"),("000000000006129064","SOP-PTC-01"),("000000000006132660","PC-0009197"),("000000000006132748","PC-0013798"),("000000000006144396","PC-0013786"),("000000000006128928","PC-0011705"),("000000000006128598","PC-0012061"),("000000000000578047","PC-0017217"),("000000000000572619","PC-0005791"),("000000000000579139","PC-0021141"),("000000000000180631","PC-031265"),("000000000000571819","PC-0003479"),("000000000030053246","PC-058732"),("000000000030052828","PC-0019164"),("000000000030034707","PC-053638"),("02112152","PC-0005598"),("02110018","PC-0010360"),("02300167","PC-0010548"),("02501149","PC-055572"),("02112144","PC-0005617"),("02500938","PC-055572"),("02500940","PC-055572"),("02500939","PC-055572"),("02300188","PC-0013217"),("02500937","PC-055572"),("02501140","PC-055572"),("02501143","PC-055572"),("02900219","PC-0017549"),("02501148","PC-055572"),("02501150","PC-055572"),("02501144","PC-055572"),("02501141","PC-055572"),("02501151","PC-055572"),("02501142","PC-055572"),("02300193","PC-0008417"),("02500923","PC-055572"),("02500921","PC-055572"),("02900145","PC-0013440"),("02500924","PC-055572"),("02500920","PC-055572"),("02500863","PC-055572"),("02500878","PC-055572"),("02501152","PC-055572"),("758610","PC-029215"),("351220","PC-000901"),("138400","IPWR0005"),("164550","IPWR0006"),("180780","PC-0004278"),("134780","IPWR0004"),("668080","PC-0000253"),("668220","PC-0000253"),("677280","PC-030713"),("666320","PC-0000250"),("666480","PC-0000254"),("677560","PC-030716"),("666040","PC-0000253"),("705560","PC-0000250"),("677520","PC-030716"),("665880","PC-0000249"),("109540","IPWR0003"),("666080","PC-0000254"),("665780","PC-0000250"),("677900","PC-030716"),("115003","PC-0011611"),("375600B","PC-046045"),("374535D","PC-018031"),("375800A","PC-058882"),("379418B","PC-0003665"),("379810C","PC-036558"),("376000A","PC-054615"),("379565B","PC-0004158"),("000000000006144912","PC-0004294"),("000000000006143040","PC-0019024"),("000000000006030608","PM6030369-CN"),("000000000006077957","PC-0018085"),("000000000006148599","DC-0094663"),("000000000006132809","PC-060234"),("000000000006133378","PC-0003596"),("000000000006144943","PC-0011819"),("000000000006106727","PC-0012527"),("000000000006123629","PC-0012169"),("000000000006145071","PC-036639"),("000000000006087108","PC-043175"),("000000000006145316","PC-042244"),("000000000006144894","PC-042244"),("000000000006134735","PC-036639"),("000000000006148598","DC-0094657"),("000000000006143711","PC-0001651"),("000000000006130411","PC-0011368"),("000000000006129048","PC-0002314"),("000000000006125181","SOP-PTC-01-SH"),("000000000006065772","PC-0016011"),("000000000006134993","PC-0001646"),("000000000006144476","PC-0022145"),("000000000006145313","PC-0009193"),("000000000006144538","PC-0019024"),("000000000006134736","PC-036639"),("000000000006132664","PC-0011370"),("000000000006107360","PC-058974"),("000000000006144917","PC-0004293"),("000000000006144961","PC-0000752"),("000000000006144944","PC-0022787"),("000000000006106774","PC-0012208"),("000000000006144892","PC-0011370"),("000000000006145312","PC-0011370"),("000000000006144965","PC-0000752"),("000000000006145076","PC-036639"),("000000000006125183","SOP-PTC-01-SH"),("000000000006125164","SOP-PTC-01-SH"),("000000000006124989","PM6013174-CN"),("000000000006144893","PC-0009193"),("000000000006127182","SOP-PTC-04-SH"),("000000000006135552","PC-0011628"),("000000000006123638","PC-0012170"),("000000000006144945","PC-0011817"),("000000000006125188","SOP-PTC-01-SH"),("000000000006132795","PC-0012391"),("000000000006124048","PC-0012167"),("000000000006143710","PC-0001650"),("000000000006143713","PC-0001653"),("000000000006144958","PC-0000751"),("000000000006144955","PC-0000751"),("000000000006145075","PC-036639"),("000000000006145077","PC-036639"),("000000000006145314","PC-0011368"),("000000000006126478","PC-0009593"),("000000000006134991","PC-0001649"),("000000000006133435","PK-020-MY"),("000000000006144940","PC-0011655"),("000000000006145295","PC-0009193"),("000000000006106741","PC-0012187"),("000000000006125180","SOP-PTC-01-SH"),("000000000006144951","PC-0000758"),("000000000006128474","PC-0011179"),("000000000006130409","PC-042244"),("000000000006132682","PC-042966"),("000000000006145069","PC-036639"),("000000000006120221","PC-0012169"),("000000000006135194","PC-0015598"),("000000000006126188","PC-060021"),("000000000006132792","PC-0012388"),("000000000006120943","PC-0002954"),("000000000006130410","PC-0011369"),("000000000006077910","PC-0018082"),("000000000006134992","PC-0001644"),("000000000006133375","PC-0003584"),("000000000006144919","PC-0004294"),("000000000006113699","PC-0001410"),("000000000006144959","PC-0000751"),("000000000006145081","PC-0016475"),("000000000006100211","PC-0020818"),("000000000006133377","PC-0003505"),("000000000006125177","SOP-PTC-01-SH"),("000000000006127261","SOP-PTC-03-SH"),("000000000006102524","PC-037300"),("000000000006145080","PC-040097"),("000000000006145083","PC-0016474"),("000000000006144916","PC-0004293"),("000000000006106728","PC-0012528"),("000000000006144896","PC-0011368"),("000000000006145070","PC-036639"),("000000000006059747","SOP-PTC-13-SH"),("000000000006143257","PC-0010639"),("000000000006132700","PC-041325"),("000000000006144946","PC-0011656"),("000000000006126940","SOP-PTC-01-SH"),("000000000006144939","PC-0022870"),("000000000006143709","PC-0001652"),("000000000006130398","PC-0009193"),("000000000006130394","PC-0011370"),("000000000006021580","PM6021577-CN"),("000000000006074489","PC-0020665"),("000000000000200143","PC-045951"),("000000000000529224","PC-058280"),("000000000000528995","PC-058268"),("000000000000577374","PC-0016747"),("000000000000212806","PC-046185"),("000000000000553712","PC-0013407"),("000000000000528952","PC-058268"),("000000000000528918","PC-058270"),("000000000000559199","PC-050581"),("000000000000554449","PC-0005295"),("000000000000528978","PC-058268"),("000000000000576780","PC-0016292"),("000000000000528963","PC-0014305"),("000000000000529087","PC-058280"),("000000000000529103","PC-058280"),("000000000000559203","PC-050581"),("000000000000528949","PC-0013914"),("000000000000529116","PC-058280"),("000000000000578009","PC-0021072"),("000000000000529083","PC-058280"),("000000000000529081","PC-058280"),("000000000000529002","PC-058268"),("000000000000553792","PC-0005295"),("000000000100023631","PC-0015946"),("000000000000529097","PC-058280"),("000000000000529099","PC-058280"),("000000000000171889","PC-0020653"),("000000000000552774","PC-0006477"),("000000000000213518","PC-046185"),("000000000000576725","PC-0016290"),("000000000000529136","PC-058280"),("000000000000576779","PC-0016291"),("000000000000529134","PC-058280"),("000000000000528999","PC-0013911"),("000000000000528948","PC-058268"),("000000000000205849","PC-0020111"),("000000000000528976","PC-0013914"),("000000000000577378","PC-0016743"),("000000000000529123","PC-058280"),("000000000000553815","PC-051881"),("000000000000529121","PC-058280"),("000000000000572618","PC-0005791"),("000000000000195840","PC-029660"),("000000000000209296","PC-050581"),("000000000000185951","PC-034186"),("000000000000577381","PC-0016747"),("000000000000528993","PC-0014305"),("000000000000528965","PC-058268"),("000000000000528416","PC-041114"),("000000000000529114","PC-058280"),("000000000000529226","PC-058280"),("000000000000528983","PC-0014319"),("000000000000545068","PC-044720"),("000000000000577373","PC-0016743"),("000000000000528926","PC-0014319"),("000000000000529101","PC-058280"),("000000000000576726","PC-0016291"),("000000000000553713","PC-0004228"),("000000000000163332","PC-024711"),("000000000000528985","PC-058268"),("000000000000576778","PC-0016290"),("000000000000528989","PC-0013911"),("000000000000528992","PC-058268"),("000000000000576777","PC-0016292"),("000000000000527975","PC-059886"),("000000000000529089","PC-058280"),("000000000000528998","PC-058268"),("000000000000171891","PC-0019242"),("000000000030040991","PC-058229"),("000000000030040996","PC-058926"),("000000000030036960","PC-049631"),("000000000030036961","PC-030815"),("000000000030048227","PC-0012378"),("000000000030038609","PC-055524"),("000000000030033463","30033463"),("000000000030041007","PC-058926"),("000000000030044360","PC-058926"),("000000000000540322","0540322"),("000000000030047380","PC-0006452"),("000000000030039895","PC-048031"),("000000000030041109","PC-058229"),("000000000030040854","PC-058229"),("000000000030038558","PC-054790"),("000000000030042237","PC-030813"),("000000000030040351","30040351"),("000000000030054251","PC-0014742"),("000000000030030352","PC-050429"),("000000000030055126","PC-0014699"),("000000000030030353","PC-050430"),("000000000030049997","PC-0008699"),("000000000030052120","PC-0011495"),("000000000030045764","PC-053949"),("000000000030034481","PC-040570"),("000000000030038607","PC-057733"),("000000000030055683","PC-030817"),("000000000030042984","PC-058229"),("000000000030055686","PC-032485"),("000000000030048224","PC-0012384"),("000000000030039891","PC-041426"),("000000000030038612","PC-040552"),("000000000030040975","PC-058229"),("000000000030053229","PC-058730"),("000000000030036953","PC-030817"),("000000000030047375","PC-0006473"),("000000000030060187","PC-0015816"),("000000000030040993","PC-058926"),("000000000030042245","PC-030814"),("000000000030038574","30038574"),("000000000030031255","PC-050431"),("000000000030052127","PC-0010288"),("000000000030049675","PC-0008752"),("000000000030054252","PC-0014743"),("000000000030048221","PC-0012384"),("000000000030060186","PC-0024606"),("000000000030053538","PC-0007258"),("000000000030036420","PC-032739"),("000000000030041039","PC-058926"),("000000000030049677","PC-0006450"),("000000000030053235","PC-0019844"),("000000000030040969","PC-058229"),("000000000030055660","PC-030815"),("000000000030036962","PC-049632"),("000000000030060188","PC-0015816"),("000000000030038950","30038950"),("000000000030047379","PC-0006447"),("000000000030040971","PC-058229"),("000000000030047385","PC-0006454"),("000000000030041009","PC-058926"),("000000000030051920","PC-0011495"),("000000000030045977","PC-053951"),("000000000030034706","PC-039803"),("000000000030034479","PC-042074"),("000000000030055081","PC-055257"),("000000000030055080","PC-0006099"),("000000000030050203","PC-0010288"),("000000000030050406","PC-058927"),("000000000030052116","PC-0010288"),("PMC0901311","PC-042970"),("787690","PC-0006452"),("78893E","PC-0008405"),("75747E","PC-056797"),("747940","IPFC0009"),("786990","IPFC0015"),("113093","PC-052414"),("115359","PC-0012885"),("115345","PC-0012885"),("951188","PC-0010595"),("945055","PC-0002523"),("331076A","PC-0017751"),("352026B","PC-053565"),("330886A","PC-016591"),("330845D","PC-0006086"),("000000000030049997","PC-0011507"),("000000000006143257","PC-0024120"),("000000000006129048","PC-0024110"),("000000000006129048","PC-0024112"),("000000000006145244","PC-0008349"),("000000000006148599","PC-0004540"),("000000000006148598","PC-0003463")
    ) AS t(CMPNT_MATL_NUM, CHILD_NM)
)
SELECT
    ip.CMPNT_MATL_NUM,
    ip.CHILD_NM,
    CASE 
        WHEN COUNT(p360.ERP_PART_NUM) > 0 THEN 'YES'
        ELSE 'NO'
    END AS MATCH_EXISTS
FROM
    input_pairs ip
LEFT JOIN
    hive_metastore.bom_rstr.nlp_input_bom_hier_dtls bhd
    ON ip.CMPNT_MATL_NUM = bhd.CMPNT_MATL_NUM
LEFT JOIN
    hive_metastore.bom_rstr.nlp_input_p360_bom p360
    ON bhd.NEW_MATCH_MATL_NUM = p360.ERP_PART_NUM
    AND ip.CHILD_NM = p360.CHILD_NM
GROUP BY
    ip.CMPNT_MATL_NUM,
    ip.CHILD_NM;
