import os
import requests
import zipfile

# Create a temp folder
os.makedirs("dll_temp", exist_ok=True)

# DLL download URLs (64-bit working version from Hugging Face)
dlls = {
    "libzbar-64.dll": "https://huggingface.co/datasets/arvindchavan-public/qr-dlls/resolve/main/libzbar-64.dll",
    "libiconv.dll": "https://huggingface.co/datasets/arvindchavan-public/qr-dlls/resolve/main/libiconv.dll"
}

# Download DLLs into folder
for name, url in dlls.items():
    print(f"⬇️ Downloading {name}")
    response = requests.get(url)
    if response.status_code == 200:
        with open(f"dll_temp/{name}", "wb") as f:
            f.write(response.content)
        print(f"✅ {name} downloaded")
    else:
        print(f"❌ Failed to download {name}")

# Create ZIP of DLLs
zip_path = "pyzbar_dlls_64bit.zip"
with zipfile.ZipFile(zip_path, "w") as zipf:
    for name in dlls:
        zipf.write(f"dll_temp/{name}", arcname=name)

print(f"\n✅ DLLs zipped as: {zip_path}")
