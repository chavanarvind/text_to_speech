import os
import azure.cognitiveservices.speech as speechsdk

# Use your custom endpoint here
custom_endpoint = "https://<your-custom-subdomain>.cognitiveservices.azure.com/"
speech_key = os.environ.get("SPEECH__SERVICE__KEY")

from_language = "en-US"
to_language = "fr"

def translate_speech_to_french():
    if not speech_key or not custom_endpoint:
        print("‚ùå Missing key or endpoint.")
        return

    # ‚úÖ Use endpoint-based config
    translation_config = speechsdk.translation.SpeechTranslationConfig(
        endpoint=custom_endpoint, subscription=speech_key
    )
    translation_config.speech_recognition_language = from_language
    translation_config.add_target_language(to_language)

    audio_config = speechsdk.audio.AudioConfig(filename="input.wav")
    recognizer = speechsdk.translation.TranslationRecognizer(
        translation_config=translation_config,
        audio_config=audio_config
    )

    print("üéôÔ∏è Translating speech from English to French...")
    result = recognizer.recognize_once()

    if result.reason == speechsdk.ResultReason.TranslatedSpeech:
        print(f"‚úÖ English: {result.text}")
        print(f"‚úÖ French: {result.translations[to_language]}")
    elif result.reason == speechsdk.ResultReason.Canceled:
        cancellation = result.cancellation_details
        print("‚ùå Canceled.")
        print(f"  Reason: {cancellation.reason}")
        print(f"  Details: {cancellation.error_details}")

translate_speech_to_french()
