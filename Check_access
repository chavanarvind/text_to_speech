def translate_audio_with_azure(audio_path, from_lang, to_lang):
    translation_config = speechsdk.translation.SpeechTranslationConfig(
        subscription=AZURE_SPEECH_KEY,
        region=AZURE_REGION,
        speech_recognition_language=from_lang
    )
    translation_config.add_target_language(to_lang)

    audio_config = speechsdk.audio.AudioConfig(filename=audio_path)
    recognizer = speechsdk.translation.TranslationRecognizer(
        translation_config=translation_config,
        audio_config=audio_config
    )

    result = recognizer.recognize_once()

    if result.reason == speechsdk.ResultReason.TranslatedSpeech:
        return result.translations[to_lang]

    elif result.reason == speechsdk.ResultReason.RecognizedSpeech:
        return "Speech recognized but not translated."

    elif result.reason == speechsdk.ResultReason.Canceled:
        try:
            details = result.cancellation_details
            return f"‚ùå Canceled: {details.reason}\nüîç Error Details: {details.error_details}"
        except Exception:
            return "‚ùå Canceled for unknown reason."

    else:
        return f"‚ùå Unexpected result reason: {result.reason}"
