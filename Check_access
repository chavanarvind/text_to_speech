def translate_audio_with_azure(audio_path, from_lang, to_lang):
    translation_config = speechsdk.translation.SpeechTranslationConfig(
        subscription=AZURE_SPEECH_KEY,
        region=AZURE_REGION,
        speech_recognition_language=from_lang
    )
    translation_config.add_target_language(to_lang)

    audio_config = speechsdk.audio.AudioConfig(filename=audio_path)
    recognizer = speechsdk.translation.TranslationRecognizer(
        translation_config=translation_config,
        audio_config=audio_config
    )

    result = recognizer.recognize_once()

    if result.reason == speechsdk.ResultReason.TranslatedSpeech:
        return result.translations[to_lang]

    elif result.reason == speechsdk.ResultReason.RecognizedSpeech:
        return "Speech recognized but not translated."

    elif result.reason == speechsdk.ResultReason.Canceled:
        cancellation_details = speechsdk.CancellationDetails.from_result(result)
        error_msg = f"‚ùå Canceled: {cancellation_details.reason}"
        if cancellation_details.reason == speechsdk.CancellationReason.Error:
            error_msg += f"\nüîç Error Details: {cancellation_details.error_details}"
        return error_msg

    else:
        return f"‚ùå Unexpected error: {result.reason}"
