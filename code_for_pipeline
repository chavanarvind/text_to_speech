df = pd.read_parquet(file, columns=required_cols)

# ✅ Remove duplicates on selected columns early
df.drop_duplicates(subset=required_cols, inplace=True)

# ✅ Filter non-null essential fields
df = df[df['Final Category'].notna() & df['CMPNT_MATL_DESC'].notna()].copy()

# ✅ Standardize ambiguous labels
df['Final Category'] = df['Final Category'].replace({'FNW or CHM': 'FNW_CHM'})
